"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[941],{47064:(e,t,i)=>{i.d(t,{G:()=>u});var n=i(58691),o=i(24852),r=i(75557),l=i(99721),s=i(78627),c=i(4871),a=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};class u{constructor(e,t,i,n,o){this.router=e,this.organizationService=t,this.platformUtilsService=i,this.i18nService=n,this.syncService=o}canActivate(e,t){var i;return a(this,void 0,void 0,(function*(){null==(yield this.syncService.getLastSync())&&(yield this.syncService.fullSync(!1));const o=this.organizationService.get(e.params.organizationId);if(null==o)return this.router.createUrlTree(["/"]);if(!o.isOwner&&!o.enabled)return this.platformUtilsService.showToast("error",null,this.i18nService.t("organizationIsDisabled")),this.router.createUrlTree(["/"]);const r=null===(i=e.data)||void 0===i?void 0:i.organizationPermissions;if(!(null==r||r(o))){const e=t.root.queryParamMap.get("itemId")||t.root.queryParamMap.get("cipherId");return e?this.router.createUrlTree(["/vault"],{queryParams:{itemId:e}}):(this.platformUtilsService.showToast("error",null,this.i18nService.t("accessDenied")),(0,n.gW)(o)?this.router.createUrlTree(["/organizations",o.id]):this.router.createUrlTree(["/"]))}return!0}))}}u.ɵfac=function(e){return new(e||u)(o.LFG(r.F0),o.LFG(n.Mn),o.LFG(l.P),o.LFG(s.D),o.LFG(c._))},u.ɵprov=o.Yz7({token:u,factory:u.ɵfac,providedIn:"root"})},56992:(e,t,i)=>{i.d(t,{S:()=>s});var n=i(58691),o=i(24852),r=i(75557),l=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};class s{constructor(e,t){this.router=e,this.organizationService=t}canActivate(e,t){var i;return l(this,void 0,void 0,(function*(){const o=this.organizationService.get(e.params.organizationId),r=null===(i=e.data)||void 0===i?void 0:i.autoRedirectCallback;if(r){let e=r(o);return"string"==typeof e&&(e=[e]),this.router.createUrlTree([t.url,...e])}return(0,n.gW)(o)?this.router.createUrlTree(["/organizations",o.id]):this.router.createUrlTree(["/"])}))}}s.ɵfac=function(e){return new(e||s)(o.LFG(r.F0),o.LFG(n.Mn))},s.ɵprov=o.Yz7({token:s,factory:s.ɵfac,providedIn:"root"})},33287:(e,t,i)=>{i.d(t,{Z:()=>G});var n=i(65017),o=i(19576),r=i(53883),l=i(2138),s=i(92333),c=i(71146),a=i(24852),u=i(55602),d=i(78627),p=i(99721),h=i(66459),g=i(47244),f=i(98645),m=i(14494),v=i(19419),b=i(33245),U=i(98205),Z=i(46246),_=i(36338),w=i(81974),A=i(29465),x=i(18362),y=i(11512),C=i(54735),T=i(50941),S=i(26361),I=i(82933),q=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function z(e,t){if(1&e&&(a.TgZ(0,"small",18),a._uU(1),a.qZA()),2&e){const e=a.oxw();a.xp6(1),a.Oqu(e.name)}}function L(e,t){1&e&&(a.TgZ(0,"div"),a._uU(1),a.ALo(2,"i18n"),a.qZA()),2&e&&(a.xp6(1),a.hij("\n      ",a.lcZ(2,1,"noEventsInList"),"\n    "))}function M(e,t){1&e&&(a.TgZ(0,"th",21),a._uU(1),a.ALo(2,"i18n"),a.qZA()),2&e&&(a.xp6(1),a.Oqu(a.lcZ(2,1,"member")))}function k(e,t){if(1&e&&(a.TgZ(0,"td",21),a._uU(1,"\n            "),a.TgZ(2,"span",29),a._uU(3),a.qZA(),a._uU(4,"\n          "),a.qZA()),2&e){const e=a.oxw().$implicit;a.xp6(2),a.s9C("appA11yTitle",e.userEmail),a.xp6(1),a.Oqu(e.userName)}}function O(e,t){if(1&e&&(a.TgZ(0,"tr",26),a._uU(1,"\n          "),a.TgZ(2,"td",21),a._uU(3),a.ALo(4,"date"),a.qZA(),a._uU(5,"\n          "),a.TgZ(6,"td",21),a._uU(7,"\n            "),a._UZ(8,"i",27),a._uU(9,"\n            "),a.TgZ(10,"span",22),a._uU(11),a.qZA(),a._uU(12,"\n          "),a.qZA(),a._uU(13,"\n          "),a.YNc(14,k,5,2,"td",23),a._uU(15,"\n          "),a._UZ(16,"td",28),a._uU(17,"\n        "),a.qZA()),2&e){const e=t.$implicit,i=a.oxw(3);a.xp6(3),a.Oqu(a.xi3(4,10,e.date,"medium")),a.xp6(5),a.Gre("tw-text-muted bwi bwi-lg ",e.appIcon,""),a.hYB("title","",e.appName,", ",e.ip,""),a.xp6(3),a.AsE("",e.appName,", ",e.ip,""),a.xp6(3),a.Q6J("ngIf",i.showUser),a.xp6(2),a.Q6J("innerHTML",e.message,a.oJD)}}function F(e,t){if(1&e&&(a._uU(0,"\n        "),a.YNc(1,O,18,13,"tr",25),a.ALo(2,"async"),a._uU(3,"\n      ")),2&e){const e=t.$implicit;a.xp6(1),a.Q6J("ngForOf",a.lcZ(2,1,e))}}function J(e,t){if(1&e&&(a.TgZ(0,"bit-table",19),a._uU(1,"\n      "),a.ynx(2,20),a._uU(3,"\n        "),a.TgZ(4,"tr"),a._uU(5,"\n          "),a.TgZ(6,"th",21),a._uU(7),a.ALo(8,"i18n"),a.qZA(),a._uU(9,"\n          "),a.TgZ(10,"th",21),a._uU(11,"\n            "),a.TgZ(12,"span",22),a._uU(13),a.ALo(14,"i18n"),a.qZA(),a._uU(15,"\n          "),a.qZA(),a._uU(16,"\n          "),a.YNc(17,M,3,3,"th",23),a._uU(18,"\n          "),a.TgZ(19,"th",21),a._uU(20),a.ALo(21,"i18n"),a.qZA(),a._uU(22,"\n        "),a.qZA(),a._uU(23,"\n      "),a.BQk(),a._uU(24,"\n      "),a.YNc(25,F,4,3,"ng-template",24),a._uU(26,"\n    "),a.qZA()),2&e){const e=a.oxw();a.Q6J("dataSource",e.dataSource),a.xp6(7),a.Oqu(a.lcZ(8,5,"timestamp")),a.xp6(6),a.Oqu(a.lcZ(14,7,"client")),a.xp6(4),a.Q6J("ngIf",e.showUser),a.xp6(3),a.Oqu(a.lcZ(21,9,"event"))}}function Y(e,t){if(1&e&&(a.TgZ(0,"button",30),a._uU(1),a.ALo(2,"i18n"),a.qZA()),2&e){const e=a.oxw();a.Q6J("bitAction",e.loadMoreEvents),a.xp6(1),a.hij("\n      ",a.lcZ(2,2,"loadMore"),"\n    ")}}class N{get name(){return this.params.name}get showUser(){var e;return null!==(e=this.params.showUser)&&void 0!==e&&e}constructor(e,t,i,n,o,r,s,c,a,u){this.params=e,this.apiService=t,this.i18nService=i,this.eventService=n,this.platformUtilsService=o,this.userNamePipe=r,this.logService=s,this.organizationUserService=c,this.formBuilder=a,this.validationService=u,this.loading=!0,this.dataSource=new l.G,this.filterFormGroup=this.formBuilder.group({start:[""],end:[""]}),this.orgUsersUserIdMap=new Map,this.orgUsersIdMap=new Map,this.loadMoreEvents=()=>q(this,void 0,void 0,(function*(){yield this.loadEvents(!1)})),this.refreshEvents=()=>q(this,void 0,void 0,(function*(){yield this.loadEvents(!0)}))}ngOnInit(){return q(this,void 0,void 0,(function*(){const e=this.eventService.getDefaultDateFilters();this.filterFormGroup.setValue({start:e[0],end:e[1]}),yield this.load()}))}load(){return q(this,void 0,void 0,(function*(){try{if(this.showUser){(yield this.organizationUserService.getAllUsers(this.params.organizationId)).data.forEach((e=>{const t=this.userNamePipe.transform(e);this.orgUsersIdMap.set(e.id,{name:t,email:e.email}),this.orgUsersUserIdMap.set(e.userId,{name:t,email:e.email})}))}yield this.loadEvents(!0)}catch(e){this.logService.error(e),this.validationService.showError(e)}this.loading=!1}))}loadEvents(e){return q(this,void 0,void 0,(function*(){let t,i=null;try{i=this.eventService.formatDateFilters(this.filterFormGroup.value.start,this.filterFormGroup.value.end)}catch(o){return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("invalidDateRange"))}t="user"===this.params.entity&&this.params.providerId?yield this.apiService.getEventsProviderUser(this.params.providerId,this.params.entityId,i[0],i[1],e?null:this.continuationToken):"user"===this.params.entity?yield this.apiService.getEventsOrganizationUser(this.params.organizationId,this.params.entityId,i[0],i[1],e?null:this.continuationToken):yield this.apiService.getEventsCipher(this.params.entityId,i[0],i[1],e?null:this.continuationToken),this.continuationToken=t.continuationToken;const n=yield Promise.all(t.data.map((e=>q(this,void 0,void 0,(function*(){const t=null==e.actingUserId?e.userId:e.actingUserId,i=yield this.eventService.getEventInfo(e),n=this.showUser&&null!=t&&this.orgUsersUserIdMap.has(t)?this.orgUsersUserIdMap.get(t):null;return new r.Y({message:i.message,humanReadableMessage:i.humanReadableMessage,appIcon:i.appIcon,appName:i.appName,userId:t,userName:null!=n?n.name:this.showUser?this.i18nService.t("unknown"):null,userEmail:null!=n?n.email:this.showUser?"":null,date:e.date,ip:e.ipAddress,type:e.type,installationId:e.installationId,systemUser:e.systemUser,serviceAccountId:e.serviceAccountId})})))));!e&&null!=this.dataSource.data&&this.dataSource.data.length>0?this.dataSource.data=this.dataSource.data.concat(n):this.dataSource.data=n}))}}N.ɵfac=function(e){return new(e||N)(a.Y36(n.Kt),a.Y36(u.s),a.Y36(d.D),a.Y36(s.PO),a.Y36(p.P),a.Y36(o.z),a.Y36(h.$),a.Y36(g.t),a.Y36(f.qu),a.Y36(m.R))},N.ɵcmp=a.Xpm({type:N,selectors:[["ng-component"]],standalone:!0,features:[a.jDz],decls:68,vars:28,consts:[["dialogSize","large",3,"loading"],["bitDialogTitle",""],["class","tw-text-muted",4,"ngIf"],["bitDialogContent",""],[3,"formGroup","bitSubmit"],[1,"tw-flex","tw-items-center","tw-space-x-2"],["for","start",1,"tw-sr-only"],["bitInput","","type","datetime-local","id","start","formControlName","start",3,"placeholder"],[1,"tw-mx-2"],["for","end",1,"tw-sr-only"],["bitInput","","type","datetime-local","id","end","formControlName","end",3,"placeholder"],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],["aria-hidden","true",1,"bwi","bwi-refresh","bwi-fw"],[4,"ngIf"],[3,"dataSource",4,"ngIf"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","secondary","type","button","bitDialogClose",""],[1,"tw-text-muted"],[3,"dataSource"],["header",""],["bitCell",""],[1,"tw-sr-only"],["bitCell","",4,"ngIf"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["aria-hidden","true",3,"title"],["bitCell","",3,"innerHTML"],[3,"appA11yTitle"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction"]],template:function(e,t){1&e&&(a.TgZ(0,"bit-dialog",0),a._uU(1,"\n  "),a.TgZ(2,"span",1),a._uU(3),a.ALo(4,"i18n"),a.YNc(5,z,2,1,"small",2),a._uU(6,"\n  "),a.qZA(),a._uU(7,"\n  "),a.TgZ(8,"div",3),a._uU(9,"\n    "),a.TgZ(10,"form",4),a._uU(11,"\n      "),a.TgZ(12,"div",5),a._uU(13,"\n        "),a.TgZ(14,"div"),a._uU(15,"\n          "),a.TgZ(16,"label",6),a._uU(17),a.ALo(18,"i18n"),a.qZA(),a._uU(19,"\n          "),a.TgZ(20,"span"),a._uU(21,"\n            "),a._UZ(22,"input",7),a.ALo(23,"i18n"),a._uU(24,"\n          "),a.qZA(),a._uU(25,"\n        "),a.qZA(),a._uU(26,"\n        "),a.TgZ(27,"span",8),a._uU(28,"-"),a.qZA(),a._uU(29,"\n        "),a.TgZ(30,"div"),a._uU(31,"\n          "),a.TgZ(32,"label",9),a._uU(33),a.ALo(34,"i18n"),a.qZA(),a._uU(35,"\n          "),a.TgZ(36,"span"),a._uU(37,"\n            "),a._UZ(38,"input",10),a.ALo(39,"i18n"),a._uU(40,"\n          "),a.qZA(),a._uU(41,"\n        "),a.qZA(),a._uU(42,"\n        "),a.TgZ(43,"button",11),a._uU(44,"\n          "),a._UZ(45,"i",12),a._uU(46),a.ALo(47,"i18n"),a.qZA(),a._uU(48,"\n      "),a.qZA(),a._uU(49,"\n    "),a.qZA(),a._uU(50,"\n    "),a._UZ(51,"hr"),a._uU(52,"\n    "),a.YNc(53,L,3,3,"div",13),a._uU(54,"\n    "),a.YNc(55,J,27,11,"bit-table",14),a._uU(56,"\n    "),a.YNc(57,Y,3,4,"button",15),a._uU(58,"\n  "),a.qZA(),a._uU(59,"\n  "),a.ynx(60,16),a._uU(61,"\n    "),a.TgZ(62,"button",17),a._uU(63),a.ALo(64,"i18n"),a.qZA(),a._uU(65,"\n  "),a.BQk(),a._uU(66,"\n"),a.qZA(),a._uU(67,"\n")),2&e&&(a.Q6J("loading",t.loading),a.xp6(3),a.hij("\n    ",a.lcZ(4,14,"eventLogs"),"\n    "),a.xp6(2),a.Q6J("ngIf",t.name),a.xp6(5),a.Q6J("formGroup",t.filterFormGroup)("bitSubmit",t.refreshEvents),a.xp6(7),a.Oqu(a.lcZ(18,16,"startDate")),a.xp6(5),a.s9C("placeholder",a.lcZ(23,18,"startDate")),a.xp6(11),a.Oqu(a.lcZ(34,20,"endDate")),a.xp6(5),a.s9C("placeholder",a.lcZ(39,22,"endDate")),a.xp6(8),a.hij("\n          ",a.lcZ(47,24,"refresh"),"\n        "),a.xp6(7),a.Q6J("ngIf",!t.dataSource.data||!t.dataSource.data.length),a.xp6(2),a.Q6J("ngIf",null==t.dataSource||null==t.dataSource.data?null:t.dataSource.data.length),a.xp6(2),a.Q6J("ngIf",t.continuationToken),a.xp6(6),a.hij("\n      ",a.lcZ(64,26,"close"),"\n    "))},dependencies:[c.m,v.sg,v.O5,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,b.B,U.Q,Z.b,_.u,w.r,A.a,x.f,y.G,C.a,T.Y,S.v,C.f,v.Ov,v.uU,I.C],encapsulation:2});const G=(e,t)=>e.open(N,t)},12941:(e,t,i)=>{i.r(t),i.d(t,{OrganizationModule:()=>Hn});var n=i(63078),o=i(75557),r=i(66463),l=i(58691),s=i(47064),c=i(56992),a=i(54019),u=i(68362),d=i(92786),p=i(86742),h=i(59281),g=i(24852),f=i(23915),m=i(19419),v=i(6370),b=i(97327);const U=["rla"];class Z{onKeyDown(e){"Space"===e.code&&this.tabItem.click()}get active(){var e,t;return null!==(t=null===(e=this.routerLinkActive)||void 0===e?void 0:e.isActive)&&void 0!==t&&t}constructor(e){this._tabNavBar=e,this.destroy$=new a.x,this.routerLinkMatchOptions={queryParams:"ignored",matrixParams:"ignored",paths:"subset",fragment:"ignored"},this.disabled=!1}focus(){this.tabItem.focus()}ngAfterViewInit(){this.routerLinkActive.isActiveChange.pipe((0,u.R)(this.destroy$)).subscribe((e=>this._tabNavBar.updateActiveLink()))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}Z.ɵfac=function(e){return new(e||Z)(g.Y36(A))},Z.ɵcmp=g.Xpm({type:Z,selectors:[["bit-tab-link"]],viewQuery:function(e,t){if(1&e&&(g.Gf(b.B,5),g.Gf(U,5)),2&e){let e;g.iGM(e=g.CRH())&&(t.tabItem=e.first),g.iGM(e=g.CRH())&&(t.routerLinkActive=e.first)}},hostBindings:function(e,t){1&e&&g.NdJ("keydown",(function(e){return t.onKeyDown(e)}))},inputs:{route:"route",disabled:"disabled"},ngContentSelectors:["*"],decls:6,vars:5,consts:[["bitTabListItem","","routerLinkActive","","ariaCurrentWhenActive","page","role","link",3,"routerLink","routerLinkActiveOptions","active","disabled"],["rla","routerLinkActive"]],template:function(e,t){if(1&e&&(g.F$t(),g.TgZ(0,"a",0,1),g._uU(2,"\n  "),g.Hsn(3),g._uU(4,"\n"),g.qZA(),g._uU(5,"\n")),2&e){const e=g.MAs(1);g.Q6J("routerLink",t.disabled?null:t.route)("routerLinkActiveOptions",t.routerLinkMatchOptions)("active",e.isActive)("disabled",t.disabled),g.uIk("aria-disabled",t.disabled)}},dependencies:[o.rH,o.Od,b.B],encapsulation:2});var _=i(52850),w=i(59047);class A{constructor(){this.label=""}ngAfterContentInit(){this.keyManager=new v.Em(this.tabLabels).withHorizontalOrientation("ltr").withWrap().withHomeAndEnd()}updateActiveLink(){const e=this.tabLabels.toArray();for(let t=0;t<e.length;t++)e[t].active&&this.keyManager.updateActiveItem(t)}}A.ɵfac=function(e){return new(e||A)},A.ɵcmp=g.Xpm({type:A,selectors:[["bit-tab-nav-bar"]],contentQueries:function(e,t,i){if(1&e&&g.Suo(i,Z,4),2&e){let e;g.iGM(e=g.CRH())&&(t.tabLabels=e)}},hostAttrs:[1,"tw-block"],inputs:{label:"label"},ngContentSelectors:["*"],decls:8,vars:1,consts:[["bitTabListContainer","",3,"keydown"]],template:function(e,t){1&e&&(g.F$t(),g.TgZ(0,"bit-tab-header"),g._uU(1,"\n  "),g.TgZ(2,"nav",0),g.NdJ("keydown",(function(e){return t.keyManager.onKeydown(e)})),g._uU(3,"\n    "),g.Hsn(4),g._uU(5,"\n  "),g.qZA(),g._uU(6,"\n"),g.qZA(),g._uU(7,"\n")),2&e&&(g.xp6(2),g.uIk("aria-label",t.label))},dependencies:[_.M,w.Q],encapsulation:2});var x=i(12132),y=i(42934),C=(i(27263),i(27646)),T=i(78627),S=i(33245),I=i(14970),q=i(73974),z=i(26194),L=i(44234),M=i(91849),k=i(82933),O=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function F(e,t){1&e&&(g.TgZ(0,"div",16),g._uU(1,"\n      "),g.TgZ(2,"div",17),g._uU(3,"\n        "),g._UZ(4,"i",18),g._uU(5),g.ALo(6,"i18n"),g.qZA(),g._uU(7,"\n    "),g.qZA()),2&e&&(g.xp6(5),g.hij("\n        ",g.lcZ(6,1,"organizationIsDisabled"),"\n      "))}function J(e,t){if(1&e&&(g.TgZ(0,"div",19),g._uU(1,"\n      "),g.TgZ(2,"div",17),g._uU(3,"\n        "),g._UZ(4,"i",18),g._uU(5),g.ALo(6,"i18n"),g.qZA(),g._uU(7,"\n    "),g.qZA()),2&e){const e=g.oxw(2);g.xp6(5),g.hij("\n        ",g.xi3(6,1,"accessingUsingProvider",e.activeOrganization.providerName),"\n      ")}}const Y=function(e){return["/organizations",e]};function N(e,t){if(1&e&&(g.TgZ(0,"li",20),g._uU(1,"\n        "),g.TgZ(2,"a",21),g._uU(3,"\n          "),g.TgZ(4,"i",22),g._uU(5,"\n            "),g.TgZ(6,"span",23),g._uU(7),g.ALo(8,"i18n"),g.qZA(),g._uU(9,"\n          "),g.qZA(),g._uU(10),g.qZA(),g._uU(11,"\n      "),g.qZA()),2&e){const e=t.$implicit,i=g.oxw(2);g.xp6(2),g.Q6J("routerLink",g.VKq(6,Y,e.id)),g.xp6(2),g.Q6J("ngClass",e.id===i.activeOrganization.id?"visible":"invisible"),g.xp6(3),g.Oqu(g.lcZ(8,4,"currentOrganization")),g.xp6(3),g.hij("\n          ",e.name,"\n        ")}}function G(e,t){if(1&e&&(g.TgZ(0,"div",1),g._uU(1,"\n  "),g.TgZ(2,"button",2),g.ALo(3,"i18n"),g._uU(4,"\n    "),g._UZ(5,"bit-avatar",3),g._uU(6,"\n    "),g.TgZ(7,"div",1),g._uU(8,"\n      "),g.TgZ(9,"div",4),g._uU(10,"\n        "),g.TgZ(11,"span"),g._uU(12),g.qZA(),g._uU(13,"\n        "),g.TgZ(14,"small",5),g._uU(15),g.ALo(16,"i18n"),g.qZA(),g._uU(17,"\n      "),g.qZA(),g._uU(18,"\n      "),g.TgZ(19,"div",6),g._uU(20,"\n        "),g._UZ(21,"i",7),g._uU(22,"\n      "),g.qZA(),g._uU(23,"\n    "),g.qZA(),g._uU(24,"\n  "),g.qZA(),g._uU(25,"\n  "),g.TgZ(26,"div"),g._uU(27,"\n    "),g.YNc(28,F,8,3,"div",8),g._uU(29,"\n    "),g.YNc(30,J,8,4,"div",9),g._uU(31,"\n  "),g.qZA(),g._uU(32,"\n\n  "),g.TgZ(33,"bit-menu",null,10),g._uU(35,"\n    "),g.TgZ(36,"ul",11),g._uU(37,"\n      "),g.YNc(38,N,12,8,"li",12),g.ALo(39,"async"),g._uU(40,"\n      "),g._UZ(41,"bit-menu-divider"),g._uU(42,"\n      "),g.TgZ(43,"li",13),g._uU(44,"\n        "),g.TgZ(45,"a",14),g._uU(46,"\n          "),g._UZ(47,"i",15),g._uU(48),g.ALo(49,"i18n"),g.qZA(),g._uU(50,"\n      "),g.qZA(),g._uU(51,"\n    "),g.qZA(),g._uU(52,"\n  "),g.qZA(),g._uU(53,"\n"),g.qZA()),2&e){const e=g.MAs(34),t=g.oxw();g.xp6(2),g.Q6J("appA11yTitle",g.lcZ(3,9,"organizationPicker"))("bitMenuTriggerFor",e),g.xp6(3),g.Q6J("text",t.activeOrganization.name),g.xp6(7),g.Oqu(t.activeOrganization.name),g.xp6(3),g.Oqu(g.lcZ(16,11,"organization")),g.xp6(13),g.Q6J("ngIf",!t.activeOrganization.enabled),g.xp6(2),g.Q6J("ngIf",t.activeOrganization.isProviderUser),g.xp6(8),g.Q6J("ngForOf",g.lcZ(39,13,t.organizations$)),g.xp6(10),g.hij("\n          ",g.lcZ(49,15,"newOrganization"),"")}}class D{constructor(e,t){this.organizationService=e,this.i18nService=t,this.activeOrganization=null,this.loaded=!1}ngOnInit(){return O(this,void 0,void 0,(function*(){this.organizations$=this.organizationService.memberOrganizations$.pipe((0,l.D8)(this.i18nService),(0,d.U)((e=>e.sort(C.c.getSortFunction(this.i18nService,"name"))))),this.loaded=!0}))}}D.ɵfac=function(e){return new(e||D)(g.Y36(l.Mn),g.Y36(T.D))},D.ɵcmp=g.Xpm({type:D,selectors:[["app-organization-switcher"]],inputs:{activeOrganization:"activeOrganization"},decls:2,vars:1,consts:[["class","tw-flex",4,"ngIf"],[1,"tw-flex"],["type","button","id","pickerButton",1,"tw-flex","tw-items-center","tw-border-none","tw-bg-background-alt",3,"appA11yTitle","bitMenuTriggerFor"],[3,"text"],[1,"org-name","tw-ml-3"],[1,"tw-text-muted"],[1,"tw-ml-3"],["aria-hidden","true",1,"bwi","bwi-angle-down","tw-text-main"],["class","tw-ml-3 tw-rounded tw-border tw-border-solid tw-border-danger-500 tw-text-danger",4,"ngIf"],["class","tw-ml-3 tw-rounded tw-border tw-border-solid tw-border-info-500 tw-text-info",4,"ngIf"],["orgPickerMenu",""],["aria-labelledby","pickerButton",1,"tw-m-0","tw-p-0"],["class","tw-flex tw-list-none tw-flex-col","role","none",4,"ngFor","ngForOf"],["role","none",1,"tw-list-none"],["bitMenuItem","","routerLink","/create-organization"],[1,"bwi","bwi-plus","mr-2"],[1,"tw-ml-3","tw-rounded","tw-border","tw-border-solid","tw-border-danger-500","tw-text-danger"],[1,"tw-px-5","tw-py-2"],["aria-hidden","true",1,"bwi","bwi-exclamation-triangle"],[1,"tw-ml-3","tw-rounded","tw-border","tw-border-solid","tw-border-info-500","tw-text-info"],["role","none",1,"tw-flex","tw-list-none","tw-flex-col"],["bitMenuItem","",3,"routerLink"],[1,"bwi","bwi-check","mr-2",3,"ngClass"],[1,"tw-sr-only"]],template:function(e,t){1&e&&(g.YNc(0,G,54,17,"div",0),g._uU(1,"\n")),2&e&&g.Q6J("ngIf",t.loaded&&null!=t.activeOrganization)},dependencies:[m.mk,m.sg,m.O5,o.rH,S.B,I.A,q.M,z.t,L.e,M.n,m.Ov,k.C],encapsulation:2});var E=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function Q(e,t){1&e&&(g.TgZ(0,"bit-tab-link",13),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"collections")))}function $(e,t){1&e&&(g.TgZ(0,"bit-tab-link",13),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"vault")))}function P(e,t){if(1&e&&(g._uU(0,"\n          "),g.YNc(1,$,3,3,"bit-tab-link",14),g._uU(2,"\n        ")),2&e){const e=g.oxw().ngIf,t=g.oxw();g.xp6(1),g.Q6J("ngIf",t.canShowVaultTab(e))}}function B(e,t){1&e&&(g.TgZ(0,"bit-tab-link",15),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"members")))}function R(e,t){1&e&&(g.TgZ(0,"bit-tab-link",16),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"groups")))}function H(e,t){if(1&e&&(g.TgZ(0,"bit-tab-link",17),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e){const e=g.oxw().ngIf,t=g.oxw();g.xp6(1),g.hij("\n          ",g.lcZ(2,1,t.getReportTabLabel(e)),"\n        ")}}function j(e,t){1&e&&(g.TgZ(0,"bit-tab-link",18),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"billing")))}function K(e,t){1&e&&(g.TgZ(0,"bit-tab-link",19),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"settings")))}function W(e,t){if(1&e&&(g.TgZ(0,"div",1),g._uU(1,"\n  "),g.TgZ(2,"div",2),g._uU(3,"\n    "),g.TgZ(4,"div",3),g._uU(5,"\n      "),g._UZ(6,"app-organization-switcher",4),g._uU(7,"\n      "),g.TgZ(8,"bit-tab-nav-bar",5),g._uU(9,"\n        "),g.YNc(10,Q,3,3,"bit-tab-link",6),g.ALo(11,"async"),g._uU(12,"\n        "),g.YNc(13,P,3,1,"ng-template",null,7,g.W1O),g._uU(15,"\n        "),g.YNc(16,B,3,3,"bit-tab-link",8),g._uU(17,"\n        "),g.YNc(18,R,3,3,"bit-tab-link",9),g._uU(19,"\n        "),g.YNc(20,H,3,3,"bit-tab-link",10),g._uU(21,"\n        "),g.YNc(22,j,3,3,"bit-tab-link",11),g._uU(23,"\n        "),g.YNc(24,K,3,3,"bit-tab-link",12),g._uU(25,"\n      "),g.qZA(),g._uU(26,"\n    "),g.qZA(),g._uU(27,"\n  "),g.qZA(),g._uU(28,"\n"),g.qZA()),2&e){const e=t.ngIf,i=g.MAs(14),n=g.oxw();g.xp6(6),g.Q6J("activeOrganization",e),g.xp6(4),g.Q6J("ngIf",n.canShowVaultTab(e)&&g.lcZ(11,8,n.flexibleCollectionsEnabled$))("ngIfElse",i),g.xp6(6),g.Q6J("ngIf",n.canShowMembersTab(e)),g.xp6(2),g.Q6J("ngIf",n.canShowGroupsTab(e)),g.xp6(2),g.Q6J("ngIf",n.canShowReportsTab(e)),g.xp6(2),g.Q6J("ngIf",n.canShowBillingTab(e)),g.xp6(2),g.Q6J("ngIf",n.canShowSettingsTab(e))}}class V{constructor(e,t,i){this.route=e,this.organizationService=t,this.configService=i,this._destroy=new a.x,this.flexibleCollectionsEnabled$=this.configService.getFeatureFlag$(h.T.FlexibleCollections,!1)}ngOnInit(){return E(this,void 0,void 0,(function*(){document.body.classList.remove("layout_frontend"),this.organization$=this.route.params.pipe((0,u.R)(this._destroy)).pipe((0,d.U)((e=>e.organizationId))).pipe((0,p.z)((e=>this.organizationService.organizations$.pipe((0,u.R)(this._destroy)).pipe((0,l.$9)(e)))))}))}ngOnDestroy(){this._destroy.next(),this._destroy.complete()}canShowVaultTab(e){return(0,l.Po)(e)}canShowSettingsTab(e){return(0,l.DL)(e)}canShowMembersTab(e){return(0,l.tt)(e)}canShowGroupsTab(e){return(0,l.WW)(e)}canShowReportsTab(e){return(0,l.$G)(e)}canShowBillingTab(e){return(0,l.pF)(e)}getReportTabLabel(e){return e.useEvents?"reporting":"reports"}}V.ɵfac=function(e){return new(e||V)(g.Y36(o.gz),g.Y36(l.Mn),g.Y36(f.i))},V.ɵcmp=g.Xpm({type:V,selectors:[["app-organization-layout"]],decls:9,vars:3,consts:[["class","org-nav !tw-h-32",4,"ngIf"],[1,"org-nav","!tw-h-32"],[1,"container","d-flex"],[1,"d-flex","flex-column"],[1,"my-auto","pl-1",3,"activeOrganization"],[1,"-tw-mb-px"],["route","vault",4,"ngIf","ngIfElse"],["vaultTab",""],["route","members",4,"ngIf"],["route","groups",4,"ngIf"],["route","reporting",4,"ngIf"],["route","billing",4,"ngIf"],["route","settings",4,"ngIf"],["route","vault"],["route","vault",4,"ngIf"],["route","members"],["route","groups"],["route","reporting"],["route","billing"],["route","settings"]],template:function(e,t){1&e&&(g._UZ(0,"app-navbar"),g._uU(1,"\n"),g.YNc(2,W,29,10,"div",0),g.ALo(3,"async"),g._uU(4,"\n\n"),g._UZ(5,"router-outlet"),g._uU(6,"\n"),g._UZ(7,"app-footer"),g._uU(8,"\n")),2&e&&(g.xp6(2),g.Q6J("ngIf",g.lcZ(3,1,t.organization$)))},dependencies:[m.O5,o.lC,A,Z,x.c,y.S,D,m.Ov,k.C],encapsulation:2});var X,ee,te=i(59554),ie=i(80060),ne=i(30359),oe=i(33031),re=i(59260),le=i(59157),se=i(70032),ce=i(19887),ae=i(5712),ue=i(68134),de=i(54193),pe=i(65017),he=i(98645),ge=i(92716),fe=i(79596),me=i(25679),ve=i(14309),be=i(55602),Ue=i(47244),Ze=i(31754),_e=i(99721),we=i(66459),Ae=i(73369),xe=i(62357),ye=i(98205),Ce=i(46246),Te=i(36338),Se=i(81974),Ie=i(29465),qe=i(18362),ze=i(24637),Le=i(11512),Me=i(36179),ke=i(44358),Oe=i(21656),Fe=i(17731),Je=i(26536),Ye=i(90054),Ne=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function Ge(e,t){if(1&e&&(g.TgZ(0,"span",11),g._uU(1),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Oqu(null==e.group?null:e.group.name)}}function De(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1,"\n        "),g._UZ(2,"i",12),g.ALo(3,"i18n"),g._uU(4,"\n        "),g.TgZ(5,"span",13),g._uU(6),g.ALo(7,"i18n"),g.qZA(),g._uU(8,"\n      "),g.qZA()),2&e&&(g.xp6(2),g.s9C("title",g.lcZ(3,2,"loading")),g.xp6(4),g.Oqu(g.lcZ(7,4,"loading")))}function Ee(e,t){1&e&&(g.TgZ(0,"div",20),g._uU(1,"\n            "),g._UZ(2,"input",21),g._uU(3,"\n            "),g.TgZ(4,"label",22),g._uU(5),g.ALo(6,"i18n"),g.qZA(),g._uU(7,"\n            "),g.TgZ(8,"p",23),g._uU(9),g.ALo(10,"i18n"),g.qZA(),g._uU(11,"\n          "),g.qZA()),2&e&&(g.xp6(5),g.Oqu(g.lcZ(6,2,"accessAllCollectionsDesc")),g.xp6(4),g.Oqu(g.lcZ(10,4,"accessAllCollectionsHelp")))}function Qe(e,t){if(1&e&&(g.ynx(0),g._uU(1,"\n            "),g._UZ(2,"bit-access-selector",24),g.ALo(3,"i18n"),g.ALo(4,"i18n"),g.ALo(5,"i18n"),g.ALo(6,"async"),g._uU(7,"\n          "),g.BQk()),2&e){const e=g.oxw(2);g.xp6(2),g.Q6J("items",e.collections)("permissionMode",e.PermissionMode.Edit)("columnHeader",g.lcZ(3,6,"collection"))("selectorLabelText",g.lcZ(4,8,"selectCollections"))("emptySelectionText",g.lcZ(5,10,"noCollectionsAdded"))("flexibleCollectionsEnabled",g.lcZ(6,12,e.flexibleCollectionsEnabled$))}}function $e(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"bit-tab-group",14),g.NdJ("selectedIndexChange",(function(t){g.CHM(e);const i=g.oxw();return g.KtG(i.tabIndex=t)})),g._uU(1,"\n        "),g.TgZ(2,"bit-tab",15),g.ALo(3,"i18n"),g._uU(4,"\n          "),g.TgZ(5,"bit-form-field"),g._uU(6,"\n            "),g.TgZ(7,"bit-label"),g._uU(8),g.ALo(9,"i18n"),g.qZA(),g._uU(10,"\n            "),g._UZ(11,"input",16),g._uU(12,"\n            "),g.TgZ(13,"bit-hint"),g._uU(14),g.ALo(15,"i18n"),g.qZA(),g._uU(16,"\n          "),g.qZA(),g._uU(17,"\n          "),g.TgZ(18,"bit-form-field"),g._uU(19,"\n            "),g.TgZ(20,"bit-label"),g._uU(21),g.ALo(22,"i18n"),g.qZA(),g._uU(23,"\n            "),g._UZ(24,"input",17),g._uU(25,"\n            "),g.TgZ(26,"bit-hint"),g._uU(27),g.ALo(28,"i18n"),g.qZA(),g._uU(29,"\n          "),g.qZA(),g._uU(30,"\n        "),g.qZA(),g._uU(31,"\n\n        "),g.TgZ(32,"bit-tab",15),g.ALo(33,"i18n"),g._uU(34,"\n          "),g.TgZ(35,"p"),g._uU(36),g.ALo(37,"i18n"),g.qZA(),g._uU(38,"\n          "),g._UZ(39,"bit-access-selector",18),g.ALo(40,"i18n"),g.ALo(41,"i18n"),g.ALo(42,"i18n"),g.ALo(43,"async"),g._uU(44,"\n        "),g.qZA(),g._uU(45,"\n\n        "),g.TgZ(46,"bit-tab",15),g.ALo(47,"i18n"),g._uU(48,"\n          "),g.TgZ(49,"p"),g._uU(50),g.ALo(51,"i18n"),g.qZA(),g._uU(52,"\n          "),g.YNc(53,Ee,12,6,"div",19),g.ALo(54,"async"),g._uU(55,"\n          "),g.YNc(56,Qe,8,14,"ng-container",5),g._uU(57,"\n        "),g.qZA(),g._uU(58,"\n      "),g.qZA()}if(2&e){const e=g.oxw();g.Q6J("selectedIndex",e.tabIndex),g.xp6(2),g.s9C("label",g.lcZ(3,19,"groupInfo")),g.xp6(6),g.Oqu(g.lcZ(9,21,"name")),g.xp6(6),g.Oqu(g.xi3(15,23,"characterMaximum",100)),g.xp6(7),g.Oqu(g.lcZ(22,26,"externalId")),g.xp6(6),g.Oqu(g.lcZ(28,28,"externalIdDesc")),g.xp6(5),g.s9C("label",g.lcZ(33,30,"members")),g.xp6(4),g.Oqu(g.lcZ(37,32,"editGroupMembersDesc")),g.xp6(3),g.Q6J("items",e.members)("showMemberRoles",!0)("permissionMode",e.PermissionMode.Hidden)("columnHeader",g.lcZ(40,34,"member"))("selectorLabelText",g.lcZ(41,36,"selectMembers"))("emptySelectionText",g.lcZ(42,38,"noMembersAdded"))("flexibleCollectionsEnabled",g.lcZ(43,40,e.flexibleCollectionsEnabled$)),g.xp6(7),g.s9C("label",g.lcZ(47,42,"collections")),g.xp6(4),g.Oqu(g.lcZ(51,44,"editGroupCollectionsDesc")),g.xp6(3),g.Q6J("ngIf",!g.lcZ(54,46,e.flexibleCollectionsEnabled$)),g.xp6(3),g.Q6J("ngIf",!e.groupForm.value.accessAll)}}!function(e){e[e.Info=0]="Info",e[e.Members=1]="Members",e[e.Collections=2]="Collections"}(X||(X={})),function(e){e.Saved="saved",e.Canceled="canceled",e.Deleted="deleted"}(ee||(ee={}));class Pe{get groupId(){return this.params.groupId}get organizationId(){return this.params.organizationId}get orgCollections$(){return(0,re.D)(this.apiService.getCollections(this.organizationId)).pipe((0,ne.w)((e=>(0,re.D)(this.collectionService.decryptMany(e.data.map((e=>new de.F(new ue.Z(e)))))))),(0,d.U)((e=>e.map((e=>({id:e.id,type:ve.zD.Collection,labelName:e.name,listName:e.name}))))))}get orgMembers$(){return(0,re.D)(this.organizationUserService.getAllUsers(this.organizationId)).pipe((0,d.U)((e=>e.data.map((e=>{var t;return{id:e.id,type:ve.zD.Member,email:e.email,role:e.type,listName:(null===(t=e.name)||void 0===t?void 0:t.length)>0?`${e.name} (${e.email})`:e.email,labelName:e.name||e.email,status:e.status}})))))}get groupDetails$(){return this.editMode?(0,oe.a)([this.groupService.get(this.organizationId,this.groupId),this.apiService.getGroupUsers(this.organizationId,this.groupId)]).pipe((0,d.U)((([e,t])=>(e.members=t,e))),(0,fe.K)((e=>(e instanceof me.i?this.logService.error(e.message):this.logService.error(e.toString()),(0,ge.of)(void 0))))):(0,ge.of)(void 0)}constructor(e,t,i,o,r,l,s,c,u,d,p,g,f){var m;this.params=e,this.dialogRef=t,this.apiService=i,this.organizationUserService=o,this.groupService=r,this.i18nService=l,this.collectionService=s,this.platformUtilsService=c,this.logService=u,this.formBuilder=d,this.changeDetectorRef=p,this.dialogService=g,this.configService=f,this.flexibleCollectionsEnabled$=this.configService.getFeatureFlag$(h.T.FlexibleCollections,!1),this.PermissionMode=ve.R9,this.ResultType=ee,this.loading=!0,this.editMode=!1,this.collections=[],this.members=[],this.groupForm=this.formBuilder.group({accessAll:[!1],name:["",[he.kI.required,he.kI.maxLength(100)]],externalId:this.formBuilder.control({value:"",disabled:!0}),members:[[]],collections:[[]]}),this.destroy$=new a.x,this.submit=()=>Ne(this,void 0,void 0,(function*(){var e,t;if(this.groupForm.markAllAsTouched(),this.groupForm.invalid)return void(this.tabIndex!==X.Info&&this.platformUtilsService.showToast("error",null,this.i18nService.t("fieldOnTabRequiresAttention",this.i18nService.t("groupInfo"))));const i=new n.Rq;i.id=this.groupId,i.organizationId=this.organizationId;const o=this.groupForm.value;i.name=o.name,i.accessAll=o.accessAll,i.members=null!==(t=null===(e=o.members)||void 0===e?void 0:e.map((e=>e.id)))&&void 0!==t?t:[],i.accessAll||(i.collections=o.collections.map((e=>(0,ve.E2)(e)))),yield this.groupService.save(i),this.platformUtilsService.showToast("success",null,this.i18nService.t(this.editMode?"editedGroupId":"createdGroupId",o.name)),this.dialogRef.close(ee.Saved)})),this.delete=()=>Ne(this,void 0,void 0,(function*(){if(!this.editMode)return;if(!(yield this.dialogService.openSimpleDialog({title:this.group.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;yield this.groupService.delete(this.organizationId,this.groupId),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedGroupId",this.group.name)),this.dialogRef.close(ee.Deleted)})),this.tabIndex=null!==(m=e.initialTab)&&void 0!==m?m:X.Info}ngOnInit(){this.editMode=this.loading=null!=this.groupId,this.title=this.i18nService.t(this.editMode?"editGroup":"newGroup"),(0,oe.a)([this.orgCollections$,this.orgMembers$,this.groupDetails$]).pipe((0,u.R)(this.destroy$)).subscribe((([e,t,i])=>{this.collections=e,this.members=t,this.group=i,null!=this.group&&(this.changeDetectorRef.detectChanges(),this.groupForm.patchValue({name:this.group.name,externalId:this.group.externalId,accessAll:this.group.accessAll,members:this.group.members.map((e=>({id:e,type:ve.zD.Member}))),collections:this.group.collections.map((e=>({id:e.id,type:ve.zD.Collection,permission:(0,ve.d4)(e)})))})),this.loading=!1}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}Pe.ɵfac=function(e){return new(e||Pe)(g.Y36(pe.Kt),g.Y36(pe.zj),g.Y36(be.s),g.Y36(Ue.t),g.Y36(n.My),g.Y36(T.D),g.Y36(Ze.a),g.Y36(_e.P),g.Y36(we.$),g.Y36(he.qu),g.Y36(g.sBO),g.Y36(Ae.x),g.Y36(f.i))},Pe.ɵcmp=g.Xpm({type:Pe,selectors:[["app-group-add-edit"]],decls:32,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"disablePadding"],["bitDialogTitle",""],["class","tw-text-sm tw-normal-case tw-text-muted",4,"ngIf"],["bitDialogContent",""],[4,"ngIf"],[3,"selectedIndex","selectedIndexChange",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","primary","bitFormButton","","type","submit"],["bitButton","","buttonType","secondary","type","button",3,"bitDialogClose"],["type","button","buttonType","danger","bitIconButton","bwi-trash","bitFormButton","",1,"tw-ml-auto",3,"bitAction","appA11yTitle"],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"],[3,"selectedIndex","selectedIndexChange"],[3,"label"],["bitInput","","appAutofocus","","type","text","formControlName","name"],["bitInput","","type","text","formControlName","externalId"],["formControlName","members",3,"items","showMemberRoles","permissionMode","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled"],["class","tw-my-3",4,"ngIf"],[1,"tw-my-3"],["type","checkbox","formControlName","accessAll","id","accessAll"],["for","accessAll",1,"tw-mb-0","tw-text-lg"],[1,"tw-my-0","tw-text-muted"],["formControlName","collections",3,"items","permissionMode","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled"]],template:function(e,t){1&e&&(g.TgZ(0,"form",0),g._uU(1,"\n  "),g.TgZ(2,"bit-dialog",1),g._uU(3,"\n    "),g.TgZ(4,"span",2),g._uU(5),g.YNc(6,Ge,2,1,"span",3),g._uU(7,"\n    "),g.qZA(),g._uU(8,"\n    "),g.TgZ(9,"div",4),g._uU(10,"\n      "),g.YNc(11,De,9,6,"div",5),g._uU(12,"\n\n      "),g.YNc(13,$e,59,48,"bit-tab-group",6),g._uU(14,"\n    "),g.qZA(),g._uU(15,"\n    "),g.ynx(16,7),g._uU(17,"\n      "),g.TgZ(18,"button",8),g._uU(19),g.ALo(20,"i18n"),g.qZA(),g._uU(21,"\n      "),g.TgZ(22,"button",9),g._uU(23),g.ALo(24,"i18n"),g.qZA(),g._uU(25,"\n      "),g._UZ(26,"button",10),g.ALo(27,"i18n"),g._uU(28,"\n    "),g.BQk(),g._uU(29,"\n  "),g.qZA(),g._uU(30,"\n"),g.qZA(),g._uU(31,"\n")),2&e&&(g.Q6J("formGroup",t.groupForm)("bitSubmit",t.submit),g.xp6(2),g.Q6J("disablePadding",!t.loading),g.xp6(3),g.hij("\n      ",t.title,"\n      "),g.xp6(1),g.Q6J("ngIf",t.editMode),g.xp6(5),g.Q6J("ngIf",t.loading),g.xp6(2),g.Q6J("ngIf",!t.loading),g.xp6(6),g.hij("\n        ",g.lcZ(20,12,"save"),"\n      "),g.xp6(3),g.Q6J("bitDialogClose",t.ResultType.Canceled),g.xp6(1),g.hij("\n        ",g.lcZ(24,14,"cancel"),"\n      "),g.xp6(3),g.Q6J("bitAction",t.delete)("appA11yTitle",g.lcZ(27,16,"delete")))},dependencies:[m.O5,he._Y,he.Fj,he.Wl,he.JJ,he.JL,he.sg,he.u,S.B,xe.U,ye.Q,Ce.b,Te.u,Se.r,Ie.a,qe.f,ze.d,Le.G,Me.u,ke.M,Oe.Q,Fe.Q,Je.i,Ye.f,m.Ov,k.C],encapsulation:2});var Be=i(51430),Re=i(56617),He=i(1874),je=i(7172),Ke=i(12492),We=i(54735),Ve=i(50941),Xe=i(26361),et=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};const tt=["addEdit"],it=["usersTemplate"];function nt(e,t){1&e&&(g.ynx(0),g._uU(1,"\n    "),g._UZ(2,"i",12),g.ALo(3,"i18n"),g._uU(4,"\n    "),g.TgZ(5,"span",4),g._uU(6),g.ALo(7,"i18n"),g.qZA(),g._uU(8,"\n  "),g.BQk()),2&e&&(g.xp6(2),g.s9C("title",g.lcZ(3,2,"loading")),g.xp6(4),g.Oqu(g.lcZ(7,4,"loading")))}function ot(e,t){1&e&&(g.TgZ(0,"p"),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"noGroupsInList")))}function rt(e,t){if(1&e&&g._UZ(0,"bit-badge-list",38),2&e){const e=g.oxw().$implicit;g.Q6J("items",e.collectionNames)("maxItems",3)}}function lt(e,t){1&e&&(g.TgZ(0,"span"),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,1,"all")))}function st(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"tr",28),g._uU(1,"\n          "),g.TgZ(2,"td",29),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(4);return g.KtG(i.check(t))})),g._uU(3,"\n            "),g.TgZ(4,"input",30),g.NdJ("ngModelChange",(function(t){const i=g.CHM(e).$implicit;return g.KtG(i.checked=t)})),g.qZA(),g._uU(5,"\n          "),g.qZA(),g._uU(6,"\n          "),g.TgZ(7,"td",31),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(4);return g.KtG(i.edit(t))})),g._uU(8,"\n            "),g.TgZ(9,"button",32),g._uU(10),g.qZA(),g._uU(11,"\n          "),g.qZA(),g._uU(12,"\n          "),g.TgZ(13,"td",29),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(4);return g.KtG(i.edit(t,i.ModalTabType.Collections))})),g._uU(14,"\n            "),g.YNc(15,rt,1,2,"bit-badge-list",33),g._uU(16,"\n            "),g.YNc(17,lt,3,3,"span",10),g._uU(18,"\n          "),g.qZA(),g._uU(19,"\n          "),g.TgZ(20,"td",19),g._uU(21,"\n            "),g._UZ(22,"button",21),g.ALo(23,"i18n"),g._uU(24,"\n\n            "),g.TgZ(25,"bit-menu",null,34),g._uU(27,"\n              "),g.TgZ(28,"button",23),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(4);return g.KtG(i.edit(t))})),g._uU(29,"\n                "),g._UZ(30,"i",35),g._uU(31),g.ALo(32,"i18n"),g.qZA(),g._uU(33,"\n              "),g.TgZ(34,"button",23),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(4);return g.KtG(i.edit(t,i.ModalTabType.Members))})),g._uU(35,"\n                "),g._UZ(36,"i",36),g._uU(37),g.ALo(38,"i18n"),g.qZA(),g._uU(39,"\n              "),g.TgZ(40,"button",23),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(4);return g.KtG(i.edit(t,i.ModalTabType.Collections))})),g._uU(41,"\n                "),g._UZ(42,"i",37),g._uU(43),g.ALo(44,"i18n"),g.qZA(),g._uU(45,"\n              "),g.TgZ(46,"button",23),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(4);return g.KtG(i.delete(t))})),g._uU(47,"\n                "),g.TgZ(48,"span",24),g._UZ(49,"i",25),g._uU(50),g.ALo(51,"i18n"),g.qZA(),g._uU(52,"\n              "),g.qZA(),g._uU(53,"\n            "),g.qZA(),g._uU(54,"\n          "),g.qZA(),g._uU(55,"\n        "),g.qZA()}if(2&e){const e=t.$implicit,i=g.MAs(26);g.xp6(4),g.Q6J("ngModel",e.checked),g.xp6(6),g.hij("\n              ",e.details.name,"\n            "),g.xp6(5),g.Q6J("ngIf",!e.details.accessAll),g.xp6(2),g.Q6J("ngIf",e.details.accessAll),g.xp6(5),g.s9C("appA11yTitle",g.lcZ(23,10,"options")),g.Q6J("bitMenuTriggerFor",i),g.xp6(9),g.hij(" ",g.lcZ(32,12,"editInfo"),"\n              "),g.xp6(6),g.hij(" ",g.lcZ(38,14,"members"),"\n              "),g.xp6(6),g.hij(" ",g.lcZ(44,16,"collections"),"\n              "),g.xp6(7),g.hij(" ",g.lcZ(51,18,"delete"),"")}}function ct(e,t){if(1&e&&(g._uU(0,"\n        "),g.YNc(1,st,56,20,"tr",27),g._uU(2,"\n      ")),2&e){const e=g.oxw(3);g.xp6(1),g.Q6J("ngForOf",e.visibleGroups)}}function at(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"bit-table",14),g.NdJ("scrolled",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.loadMore())})),g._uU(1,"\n      "),g.ynx(2,15),g._uU(3,"\n        "),g.TgZ(4,"tr"),g._uU(5,"\n          "),g.TgZ(6,"th",16),g._uU(7,"\n            "),g.TgZ(8,"input",17),g.NdJ("change",(function(t){g.CHM(e);const i=g.oxw(2);return g.KtG(i.toggleAllVisible(t))})),g.qZA(),g._uU(9,"\n            "),g.TgZ(10,"label",18),g._uU(11),g.ALo(12,"i18n"),g.qZA(),g._uU(13,"\n          "),g.qZA(),g._uU(14,"\n          "),g.TgZ(15,"th",19),g._uU(16),g.ALo(17,"i18n"),g.qZA(),g._uU(18,"\n          "),g.TgZ(19,"th",19),g._uU(20),g.ALo(21,"i18n"),g.qZA(),g._uU(22,"\n          "),g.TgZ(23,"th",20),g._uU(24,"\n            "),g._UZ(25,"button",21),g.ALo(26,"i18n"),g._uU(27,"\n\n            "),g.TgZ(28,"bit-menu",null,22),g._uU(30,"\n              "),g.TgZ(31,"button",23),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.deleteAllSelected())})),g._uU(32,"\n                "),g.TgZ(33,"span",24),g._UZ(34,"i",25),g._uU(35),g.ALo(36,"i18n"),g.qZA(),g._uU(37,"\n              "),g.qZA(),g._uU(38,"\n            "),g.qZA(),g._uU(39,"\n          "),g.qZA(),g._uU(40,"\n        "),g.qZA(),g._uU(41,"\n      "),g.BQk(),g._uU(42,"\n      "),g.YNc(43,ct,3,1,"ng-template",26),g._uU(44,"\n    "),g.qZA()}if(2&e){const e=g.MAs(29),t=g.oxw(2);g.Q6J("infiniteScrollDistance",1)("infiniteScrollDisabled",!t.isPaging()),g.xp6(11),g.Oqu(g.lcZ(12,8,"all")),g.xp6(5),g.Oqu(g.lcZ(17,10,"name")),g.xp6(4),g.Oqu(g.lcZ(21,12,"collections")),g.xp6(5),g.s9C("appA11yTitle",g.lcZ(26,14,"options")),g.Q6J("bitMenuTriggerFor",e),g.xp6(10),g.hij(" ",g.lcZ(36,16,"delete"),"")}}function ut(e,t){if(1&e&&(g.ynx(0),g._uU(1,"\n    "),g.YNc(2,ot,3,3,"p",10),g._uU(3,"\n    "),g.YNc(4,at,45,18,"bit-table",13),g._uU(5,"\n  "),g.BQk()),2&e){const e=g.oxw();g.xp6(2),g.Q6J("ngIf",!e.visibleGroups.length),g.xp6(2),g.Q6J("ngIf",e.visibleGroups.length)}}function dt(e,t){}class pt{get searchText(){return this._searchText}set searchText(e){this._searchText=e,this.updateSearchedGroups()}get visibleGroups(){return this.isPaging()?this.pagedGroups:this.isSearching()?this.searchedGroups:this.groups}constructor(e,t,i,n,o,r,l,s,c,u){this.apiService=e,this.groupService=t,this.route=i,this.i18nService=n,this.dialogService=o,this.platformUtilsService=r,this.searchService=l,this.logService=s,this.collectionService=c,this.searchPipe=u,this.loading=!0,this.didScroll=!1,this.pageSize=100,this.ModalTabType=X,this.pagedGroupsCount=0,this.destroy$=new a.x,this.refreshGroups$=new te.X(null)}ngOnInit(){return et(this,void 0,void 0,(function*(){this.route.params.pipe((0,ie.b)((e=>this.organizationId=e.organizationId)),(0,ne.w)((()=>(0,oe.a)([(0,re.D)(this.apiService.getCollections(this.organizationId)).pipe((0,le.b)((e=>this.toCollectionMap(e)))),this.refreshGroups$.pipe((0,ne.w)((()=>this.groupService.getAll(this.organizationId))))]))),(0,d.U)((([e,t])=>t.sort(C.c.getSortFunction(this.i18nService,"name")).map((t=>{var i;return{id:t.id,name:t.name,details:t,checked:!1,collectionNames:t.collections.map((t=>{var i;return null===(i=e[t.id])||void 0===i?void 0:i.name})).sort(null===(i=this.i18nService.collator)||void 0===i?void 0:i.compare)}})))),(0,u.R)(this.destroy$)).subscribe((e=>{this.groups=e,this.resetPaging(),this.updateSearchedGroups(),this.loading=!1})),this.route.queryParams.pipe((0,ce.P)(),(0,le.b)((e=>et(this,void 0,void 0,(function*(){this.searchText=e.search})))),(0,u.R)(this.destroy$)).subscribe()}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadMore(){if(!this.groups||this.groups.length<=this.pageSize)return;const e=this.pagedGroups.length;let t=this.pageSize;0===e&&this.pagedGroupsCount>this.pageSize&&(t=this.pagedGroupsCount),this.groups.length>e&&(this.pagedGroups=this.pagedGroups.concat(this.groups.slice(e,e+t))),this.pagedGroupsCount=this.pagedGroups.length,this.didScroll=this.pagedGroups.length>this.pageSize}edit(e,t=X.Info){return et(this,void 0,void 0,(function*(){const i=(n=this.dialogService,o={data:{initialTab:t,organizationId:this.organizationId,groupId:null!=e?e.details.id:null}},n.open(Pe,o));var n,o;const r=yield(0,se.n)(i.closed);r==ee.Saved?this.refreshGroups$.next():r==ee.Deleted&&this.removeGroup(e.details.id)}))}add(){this.edit(null)}delete(e){return et(this,void 0,void 0,(function*(){if(!(yield this.dialogService.openSimpleDialog({title:e.details.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;try{yield this.groupService.delete(this.organizationId,e.details.id),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedGroupId",e.details.name)),this.removeGroup(e.details.id)}catch(t){this.logService.error(t)}}))}deleteAllSelected(){return et(this,void 0,void 0,(function*(){const e=this.groups.filter((e=>e.checked));if(0==e.length)return;const t=e.map((e=>e.details.name)).join(", ");if(!(yield this.dialogService.openSimpleDialog({title:{key:"deleteMultipleGroupsConfirmation",placeholders:[e.length.toString()]},content:t,type:"warning"})))return!1;try{yield this.groupService.deleteMany(this.organizationId,e.map((e=>e.details.id))),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedManyGroups",e.length.toString())),e.forEach((e=>this.removeGroup(e.details.id)))}catch(i){this.logService.error(i)}}))}resetPaging(){this.pagedGroups=[],this.loadMore()}isSearching(){return this.searchService.isSearchable(this.searchText)}check(e){e.checked=!e.checked}toggleAllVisible(e){this.visibleGroups.forEach((t=>t.checked=e.target.checked))}isPaging(){const e=this.isSearching();return e&&this.didScroll&&this.resetPaging(),!e&&this.groups&&this.groups.length>this.pageSize}removeGroup(e){const t=this.groups.findIndex((t=>t.details.id===e));t>-1&&(this.groups.splice(t,1),this.resetPaging(),this.updateSearchedGroups())}toCollectionMap(e){return et(this,void 0,void 0,(function*(){const t=e.data.map((e=>new de.F(new ue.Z(e)))),i=yield this.collectionService.decryptMany(t),n={};return i.forEach((e=>n[e.id]=e)),n}))}updateSearchedGroups(){this.searchService.isSearchable(this.searchText)&&(this.searchedGroups=this.searchPipe.transform(this.groups,this.searchText,(e=>e.details.name),(e=>e.details.id)))}}pt.ɵfac=function(e){return new(e||pt)(g.Y36(be.s),g.Y36(n.My),g.Y36(o.gz),g.Y36(T.D),g.Y36(Ae.x),g.Y36(_e.P),g.Y36(Be.o),g.Y36(we.$),g.Y36(Ze.a),g.Y36(ae.C))},pt.ɵcmp=g.Xpm({type:pt,selectors:[["app-org-groups"]],viewQuery:function(e,t){if(1&e&&(g.Gf(tt,7,g.s_b),g.Gf(it,7,g.s_b)),2&e){let e;g.iGM(e=g.CRH())&&(t.addEditModalRef=e.first),g.iGM(e=g.CRH())&&(t.usersModalRef=e.first)}},decls:41,vars:15,consts:[[1,"container","page-content"],[1,"tw-mb-4","tw-flex"],[1,"tw-ml-auto","tw-flex","tw-items-center"],[1,"tw-mr-2"],[1,"sr-only"],[1,"tw-flex","tw-items-center"],["aria-hidden","true",1,"bwi","bwi-search","bwi-fw","tw-z-20","-tw-mr-7","tw-text-muted"],["bitInput","","type","search",1,"tw-rounded-l","tw-pl-9",3,"placeholder","ngModel","ngModelChange"],["bitButton","","type","button","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],[4,"ngIf"],["addEdit",""],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollDisabled","scrolled",4,"ngIf"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollDisabled","scrolled"],["header",""],["bitCell","",1,"tw-w-20"],["type","checkbox","bitCheckbox","","id","selectAll",1,"tw-mr-2",3,"change"],["for","selectAll",1,"tw-mb-0","!tw-font-bold","!tw-text-muted"],["bitCell",""],["bitCell","",1,"tw-w-10"],["type","button","bitIconButton","bwi-ellipsis-v","size","small",3,"bitMenuTriggerFor","appA11yTitle"],["headerMenu",""],["type","button","bitMenuItem","",3,"click"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-trash"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell","",1,"tw-cursor-pointer",3,"click"],["type","checkbox","bitCheckbox","",3,"ngModel","ngModelChange"],["bitCell","",1,"tw-cursor-pointer","tw-font-bold",3,"click"],["type","button","bitLink",""],["variant","secondary",3,"items","maxItems",4,"ngIf"],["rowMenu",""],["aria-hidden","true",1,"bwi","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-user"],["aria-hidden","true",1,"bwi","bwi-collection"],["variant","secondary",3,"items","maxItems"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._uU(1,"\n  "),g.TgZ(2,"div",1),g._uU(3,"\n    "),g.TgZ(4,"h1"),g._uU(5),g.ALo(6,"i18n"),g.qZA(),g._uU(7,"\n    "),g.TgZ(8,"div",2),g._uU(9,"\n      "),g.TgZ(10,"div",3),g._uU(11,"\n        "),g.TgZ(12,"label",4),g._uU(13),g.ALo(14,"i18n"),g.qZA(),g._uU(15,"\n        "),g.TgZ(16,"div",5),g._uU(17,"\n          "),g._UZ(18,"i",6),g._uU(19,"\n          "),g.TgZ(20,"input",7),g.NdJ("ngModelChange",(function(e){return t.searchText=e})),g.ALo(21,"i18n"),g.qZA(),g._uU(22,"\n        "),g.qZA(),g._uU(23,"\n      "),g.qZA(),g._uU(24,"\n      "),g.TgZ(25,"button",8),g.NdJ("click",(function(){return t.add()})),g._uU(26,"\n        "),g._UZ(27,"i",9),g._uU(28),g.ALo(29,"i18n"),g.qZA(),g._uU(30,"\n    "),g.qZA(),g._uU(31,"\n  "),g.qZA(),g._uU(32,"\n  "),g.YNc(33,nt,9,6,"ng-container",10),g._uU(34,"\n  "),g.YNc(35,ut,6,2,"ng-container",10),g._uU(36,"\n  "),g.YNc(37,dt,0,0,"ng-template",null,11,g.W1O),g._uU(39,"\n"),g.qZA(),g._uU(40,"\n")),2&e&&(g.xp6(5),g.Oqu(g.lcZ(6,7,"groups")),g.xp6(8),g.Oqu(g.lcZ(14,9,"search")),g.xp6(7),g.s9C("placeholder",g.lcZ(21,11,"searchGroups")),g.Q6J("ngModel",t.searchText),g.xp6(8),g.hij("\n        ",g.lcZ(29,13,"newGroup"),"\n      "),g.xp6(5),g.Q6J("ngIf",t.loading),g.xp6(2),g.Q6J("ngIf",!t.loading&&t.visibleGroups))},dependencies:[m.sg,m.O5,he.Fj,he.Wl,he.JJ,he.On,Re.Ry,S.B,He.b,Se.r,je.b,Le.G,Oe.Q,Ke._,q.M,z.t,L.e,We.a,Ve.Y,Xe.v,We.f,k.C],encapsulation:2});var ht=i(82421),gt=i(40857),ft=i(4679),mt=i(98694),vt=i(63391),bt=i(21151),Ut=i(74690),Zt=i(35504),_t=i(66997),wt=i(40925),At=i(98002),xt=i(71146),yt=i(63339);const Ct=_t.W4`<svg xmlns="http://www.w3.org/2000/svg" width="140" height="121" fill="none">
  <rect class="tw-stroke-secondary-500" width="134" height="86" x="3" y="31.485" stroke-width="6" rx="11"/>
  <path class="tw-fill-secondary-500" d="M123.987 20.15H14.779a3.114 3.114 0 0 1-2.083-.95 3.036 3.036 0 0 1 0-4.208 3.125 3.125 0 0 1 2.083-.951h109.208c.792.043 1.536.38 2.083.95a3.035 3.035 0 0 1 0 4.208 3.115 3.115 0 0 1-2.083.95Zm-6.649-14.041h-95.91a3.114 3.114 0 0 1-2.082-.95 3.036 3.036 0 0 1-.848-2.105c0-.782.306-1.538.848-2.104A3.125 3.125 0 0 1 21.43 0h95.909c.791.043 1.535.38 2.082.95.547.57.849 1.322.849 2.104a3.05 3.05 0 0 1-.849 2.104 3.115 3.115 0 0 1-2.082.95ZM95.132 74.407A42.317 42.317 0 0 0 83.59 65.43l8.799-8.657a1.59 1.59 0 0 0 .004-2.27 1.641 1.641 0 0 0-2.298-.004l-9.64 9.479a28.017 28.017 0 0 0-10.483-2.13c-14.323 0-24.814 12.342-25.298 12.89a2.431 2.431 0 0 0-.675 1.64c-.01.612.215 1.203.626 1.66a43.981 43.981 0 0 0 11.873 9.485l-8.806 8.658a1.601 1.601 0 0 0-.499 1.138 1.602 1.602 0 0 0 1.008 1.5 1.651 1.651 0 0 0 1.255-.009c.199-.085.379-.205.528-.359l9.634-9.443a27.16 27.16 0 0 0 10.359 2.158c14.323 0 24.753-12.086 25.23-12.63a2.983 2.983 0 0 0-.078-4.128h.002ZM49.204 77.82a1.82 1.82 0 0 1-.43-.6 1.767 1.767 0 0 1-.152-.72 1.778 1.778 0 0 1 .582-1.32c3.857-3.564 11.782-9.686 20.77-9.676 2.564.037 5.105.508 7.508 1.395l-3.291 3.235a7.793 7.793 0 0 0-5.02-1.226 7.746 7.746 0 0 0-4.676 2.18 7.528 7.528 0 0 0-1 9.563l-4.199 4.143a43.135 43.135 0 0 1-10.092-6.974Zm26.059-1.318a5.19 5.19 0 0 1-1.557 3.68 5.326 5.326 0 0 1-3.733 1.521c-.82-.005-1.63-.2-2.359-.57l7.067-6.952c.377.718.575 1.513.582 2.321Zm-10.58 0a5.136 5.136 0 0 1 .673-2.555 5.204 5.204 0 0 1 1.862-1.897 5.302 5.302 0 0 1 5.172-.146l-7.096 6.977a5.06 5.06 0 0 1-.61-2.379Zm26.053 1.331c-3.857 3.56-11.779 9.677-20.763 9.677a22.723 22.723 0 0 1-7.454-1.369l3.292-3.226a7.793 7.793 0 0 0 4.995 1.192 7.734 7.734 0 0 0 4.642-2.176 7.524 7.524 0 0 0 1.033-9.506l4.224-4.168a43.258 43.258 0 0 1 10.02 6.945 1.788 1.788 0 0 1 .585 1.313 1.788 1.788 0 0 1-.577 1.318h.003Z"/>
</svg>`;class Tt{constructor(){this.icon=Ct,this.editInfoClicked=new g.vpe}}Tt.ɵfac=function(e){return new(e||Tt)},Tt.ɵcmp=g.Xpm({type:Tt,selectors:[["collection-access-restricted"]],outputs:{editInfoClicked:"editInfoClicked"},standalone:!0,features:[g.jDz],decls:12,vars:7,consts:[[3,"icon"],["slot","title",1,"tw-mt-4","tw-block"],["slot","button","bitButton","","buttonType","secondary","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-pencil-square"]],template:function(e,t){1&e&&(g.TgZ(0,"bit-no-items",0),g._uU(1,"\n    "),g.TgZ(2,"span",1),g._uU(3),g.ALo(4,"i18n"),g.qZA(),g._uU(5,"\n    "),g.TgZ(6,"button",2),g.NdJ("click",(function(){return t.editInfoClicked.emit()})),g._uU(7,"\n      "),g._UZ(8,"i",3),g._uU(9),g.ALo(10,"i18n"),g.qZA(),g._uU(11,"\n  "),g.qZA()),2&e&&(g.Q6J("icon",t.icon),g.xp6(3),g.Oqu(g.lcZ(4,3,"collectionAccessRestricted")),g.xp6(6),g.hij(" ",g.lcZ(10,5,"editInfo"),"\n    "))},dependencies:[xt.m,Se.r,k.C,wt.h,At.t,yt.M],encapsulation:2});var St=i(16857),It=i(6242),qt=i(75028),zt=i(98913),Lt=i(56110),Mt=i(92333),kt=i(88409),Ot=i(72530),Ft=i(23031),Jt=i(92236),Yt=i(83924),Nt=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};class Gt extends Ot.n{constructor(e,t,i,n,o,r,l){super(e,t,i,n,o,r),this.collectionAdminService=l,this.destroy$=new a.x,this._collections=new Lt.t(1),this.filteredCollections$=this._collections.asObservable(),this.collectionTree$=this.filteredCollections$.pipe((0,d.U)((e=>this.buildCollectionTree(e))))}reloadCollections(e){return Nt(this,void 0,void 0,(function*(){this._collections.next(e)}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}Gt.ɵfac=function(e){return new(e||Gt)(g.LFG(Mt.b2),g.LFG(l.Mn),g.LFG(Ft.s),g.LFG(Jt.u),g.LFG(Yt.d),g.LFG(T.D),g.LFG(kt.m))},Gt.ɵprov=g.Yz7({token:Gt,factory:Gt.ɵfac});class Dt{}Dt.ɵfac=function(e){return new(e||Dt)},Dt.ɵmod=g.oAB({type:Dt}),Dt.ɵinj=g.cJS({providers:[{provide:qt.n,useClass:Gt}],imports:[zt.d]});var Et=i(99042),Qt=i(67775),$t=i(72591),Pt=i(84598),Bt=i(27027),Rt=i(77494),Ht=i(87264),jt=i(72285),Kt=i(39194),Wt=i(83505),Vt=i(25406),Xt=i(33287),ei=i(27643),ti=i(95607),ii=i(91480),ni=i(37417),oi=i(95638),ri=i(4003),li=i(16776),si=i(75230),ci=i(24415),ai=i(61265),ui=i(19572),di=i(77140),pi=i(76528),hi=i(58172),gi=i(53481),fi=i(24610),mi=i(2051),vi=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function bi(e,t){if(1&e&&(g.TgZ(0,"small"),g._uU(1),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Oqu(e.cipher.name)}}function Ui(e,t){1&e&&g._UZ(0,"i",24)}function Zi(e,t){1&e&&g._UZ(0,"i",25)}function _i(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",26),g._uU(1,"\n                    "),g.TgZ(2,"a",27),g._uU(3,"\n                      "),g._UZ(4,"i",28),g.ALo(5,"i18n"),g._uU(6,"\n                      "),g.TgZ(7,"span",29),g._uU(8),g.ALo(9,"i18n"),g.qZA()(),g._uU(10,"\n                    "),g.TgZ(11,"button",30,31),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw().$implicit,i=g.oxw(2);return g.KtG(i.reupload(t))})),g._uU(13),g.ALo(14,"i18n"),g.qZA(),g._uU(15,"\n                  "),g.qZA()}if(2&e){const e=g.MAs(12),t=g.oxw().$implicit,i=g.oxw(2);g.xp6(4),g.s9C("title",g.lcZ(5,5,"attachmentFixDescription")),g.xp6(4),g.Oqu(g.lcZ(9,7,"attachmentFixDescription")),g.xp6(3),g.Q6J("appApiAction",i.reuploadPromises[t.id])("disabled",e.loading),g.xp6(2),g.hij("\n                      ",g.lcZ(14,9,"fix"),"\n                    ")}}function wi(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"td",32),g._uU(1,"\n                "),g.TgZ(2,"button",33,34),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw().$implicit,i=g.oxw(2);return g.KtG(i.delete(t))})),g.ALo(4,"i18n"),g._uU(5,"\n                  "),g._UZ(6,"i",35),g._uU(7,"\n                  "),g._UZ(8,"i",36),g.ALo(9,"i18n"),g._uU(10,"\n                "),g.qZA(),g._uU(11,"\n              "),g.qZA()}if(2&e){const e=g.MAs(3),t=g.oxw().$implicit,i=g.oxw(2);g.xp6(2),g.s9C("appA11yTitle",g.lcZ(4,6,"delete")),g.Q6J("appApiAction",i.deletePromises[t.id])("disabled",e.loading),g.xp6(4),g.Q6J("hidden",e.loading),g.xp6(2),g.s9C("title",g.lcZ(9,8,"loading")),g.Q6J("hidden",!e.loading)}}function Ai(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"tr"),g._uU(1,"\n              "),g.TgZ(2,"td",16),g._uU(3,"\n                "),g.YNc(4,Ui,1,0,"i",17),g._uU(5,"\n                "),g.YNc(6,Zi,1,0,"i",18),g._uU(7,"\n              "),g.qZA(),g._uU(8,"\n              "),g.TgZ(9,"td",19),g._uU(10,"\n                "),g.TgZ(11,"div",20),g._uU(12,"\n                  "),g.TgZ(13,"a",21),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(2);return g.KtG(i.download(t))})),g._uU(14),g.qZA(),g._uU(15,"\n                  "),g.YNc(16,_i,16,11,"div",22),g._uU(17,"\n                "),g.qZA(),g._uU(18,"\n                "),g.TgZ(19,"small"),g._uU(20),g.qZA(),g._uU(21,"\n              "),g.qZA(),g._uU(22,"\n              "),g.YNc(23,wi,12,10,"td",23),g._uU(24,"\n            "),g.qZA()}if(2&e){const e=t.$implicit,i=g.oxw(2);g.xp6(4),g.Q6J("ngIf",!e.downloading),g.xp6(2),g.Q6J("ngIf",e.downloading),g.xp6(8),g.Oqu(e.fileName),g.xp6(2),g.Q6J("ngIf",i.showFixOldAttachments(e)),g.xp6(4),g.Oqu(e.sizeName),g.xp6(3),g.Q6J("ngIf",!i.viewOnly)}}function xi(e,t){if(1&e&&(g.TgZ(0,"table",14),g._uU(1,"\n          "),g.TgZ(2,"tbody"),g._uU(3,"\n            "),g.YNc(4,Ai,25,6,"tr",15),g._uU(5,"\n          "),g.qZA(),g._uU(6,"\n        "),g.qZA()),2&e){const e=g.oxw();g.xp6(4),g.Q6J("ngForOf",e.cipher.attachments)}}function yi(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1,"\n          "),g.TgZ(2,"h3"),g._uU(3),g.ALo(4,"i18n"),g.qZA(),g._uU(5,"\n          "),g.TgZ(6,"label",37),g._uU(7),g.ALo(8,"i18n"),g.qZA(),g._uU(9,"\n          "),g._UZ(10,"input",38),g._uU(11,"\n          "),g.TgZ(12,"small",39),g._uU(13),g.ALo(14,"i18n"),g.qZA(),g._uU(15,"\n        "),g.qZA()),2&e&&(g.xp6(3),g.Oqu(g.lcZ(4,3,"newAttachment")),g.xp6(4),g.Oqu(g.lcZ(8,5,"file")),g.xp6(6),g.Oqu(g.lcZ(14,7,"maxFileSize")))}function Ci(e,t){if(1&e&&(g.TgZ(0,"button",40),g._uU(1,"\n          "),g._UZ(2,"i",41),g.ALo(3,"i18n"),g._uU(4,"\n          "),g.TgZ(5,"span"),g._uU(6),g.ALo(7,"i18n"),g.qZA(),g._uU(8,"\n        "),g.qZA()),2&e){g.oxw();const e=g.MAs(5);g.Q6J("disabled",e.loading),g.xp6(2),g.s9C("title",g.lcZ(3,3,"loading")),g.xp6(4),g.Oqu(g.lcZ(7,5,"save"))}}class Ti extends di.t{constructor(e,t,i,n,o,r,l,s,c){super(e,t,i,n,o,r,l,s,c),this.viewOnly=!1}reupload(e){const t=Object.create(null,{reuploadCipherAttachment:{get:()=>super.reuploadCipherAttachment}});return vi(this,void 0,void 0,(function*(){this.organization.canEditAnyCollection&&this.showFixOldAttachments(e)&&(yield t.reuploadCipherAttachment.call(this,e,!0))}))}loadCipher(){const e=Object.create(null,{loadCipher:{get:()=>super.loadCipher}});return vi(this,void 0,void 0,(function*(){if(!this.organization.canEditAnyCollection)return yield e.loadCipher.call(this);const t=yield this.apiService.getCipherAdmin(this.cipherId);return new ui.t(new ai.O(t))}))}saveCipherAttachment(e){return this.cipherService.saveAttachmentWithServer(this.cipherDomain,e,this.organization.canEditAnyCollection)}deleteCipherAttachment(e){return this.organization.canEditAnyCollection?this.apiService.deleteCipherAttachmentAdmin(this.cipherId,e):super.deleteCipherAttachment(e)}showFixOldAttachments(e){return null==e.key&&this.organization.canEditAnyCollection}}Ti.ɵfac=function(e){return new(e||Ti)(g.Y36(Jt.u),g.Y36(T.D),g.Y36(pi.$),g.Y36(hi.b),g.Y36(_e.P),g.Y36(be.s),g.Y36(we.$),g.Y36(gi._),g.Y36(Ae.x))},Ti.ɵcmp=g.Xpm({type:Ti,selectors:[["app-org-vault-attachments"]],features:[g.qOj],decls:42,vars:14,consts:[["role","dialog","aria-modal","true","aria-labelledby","attachmentsTitle",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-scrollable"],["ngNativeValidate","",1,"modal-content",3,"appApiAction","ngSubmit"],["form",""],[1,"modal-header"],["id","attachmentsTitle",1,"modal-title"],[4,"ngIf"],["type","button","data-dismiss","modal",1,"close",3,"appA11yTitle"],["aria-hidden","true"],[1,"modal-body"],["class","table table-hover table-list",4,"ngIf"],[1,"modal-footer"],["type","submit","class","btn btn-primary btn-submit",3,"disabled",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-outline-secondary"],[1,"table","table-hover","table-list"],[4,"ngFor","ngForOf"],[1,"table-list-icon"],["class","bwi bwi-fw bwi-lg bwi-file","aria-hidden","true",4,"ngIf"],["class","bwi bwi-spinner bwi-lg bwi-fw bwi-spin","aria-hidden","true",4,"ngIf"],[1,"wrap"],[1,"d-flex"],["href","#","appStopClick","",3,"click"],["class","ml-2",4,"ngIf"],["class","table-list-options",4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-lg","bwi-file"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-lg","bwi-fw","bwi-spin"],[1,"ml-2"],["href","https://bitwarden.com/help/attachments/#fixing-old-attachments","target","_blank","rel","noopener"],["aria-hidden","true",1,"bwi","bwi-exclamation-triangle","text-warning",3,"title"],[1,"sr-only"],["type","button",1,"btn","btn-outline-primary","btn-sm","m-0","py-0","px-2",3,"appApiAction","disabled","click"],["reuploadBtn",""],[1,"table-list-options"],["type","button","appStopClick","",1,"btn","btn-outline-danger",3,"appA11yTitle","appApiAction","disabled","click"],["deleteBtn",""],["aria-hidden","true",1,"bwi","bwi-trash","bwi-lg","bwi-fw",3,"hidden"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","bwi-lg","bwi-fw",3,"hidden","title"],["for","file",1,"sr-only"],["type","file","id","file","name","file","required","",1,"form-control-file"],[1,"form-text","text-muted"],["type","submit",1,"btn","btn-primary","btn-submit",3,"disabled"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._uU(1,"\n  "),g.TgZ(2,"div",1),g._uU(3,"\n    "),g.TgZ(4,"form",2,3),g.NdJ("ngSubmit",(function(){return t.submit()})),g._uU(6,"\n      "),g.TgZ(7,"div",4),g._uU(8,"\n        "),g.TgZ(9,"h1",5),g._uU(10),g.ALo(11,"i18n"),g.YNc(12,bi,2,1,"small",6),g._uU(13,"\n        "),g.qZA(),g._uU(14,"\n        "),g.TgZ(15,"button",7),g.ALo(16,"i18n"),g._uU(17,"\n          "),g.TgZ(18,"span",8),g._uU(19,"×"),g.qZA(),g._uU(20,"\n        "),g.qZA(),g._uU(21,"\n      "),g.qZA(),g._uU(22,"\n      "),g.TgZ(23,"div",9),g._uU(24,"\n        "),g.YNc(25,xi,7,1,"table",10),g._uU(26,"\n        "),g.YNc(27,yi,16,9,"div",6),g._uU(28,"\n      "),g.qZA(),g._uU(29,"\n      "),g.TgZ(30,"div",11),g._uU(31,"\n        "),g.YNc(32,Ci,9,7,"button",12),g._uU(33,"\n        "),g.TgZ(34,"button",13),g._uU(35),g.ALo(36,"i18n"),g.qZA(),g._uU(37,"\n      "),g.qZA(),g._uU(38,"\n    "),g.qZA(),g._uU(39,"\n  "),g.qZA(),g._uU(40,"\n"),g.qZA(),g._uU(41,"\n")),2&e&&(g.xp6(4),g.Q6J("appApiAction",t.formPromise),g.xp6(6),g.hij("\n          ",g.lcZ(11,8,"attachments"),"\n          "),g.xp6(2),g.Q6J("ngIf",t.cipher),g.xp6(3),g.s9C("appA11yTitle",g.lcZ(16,10,"close")),g.xp6(10),g.Q6J("ngIf",t.cipher&&t.cipher.hasAttachments),g.xp6(2),g.Q6J("ngIf",!t.viewOnly),g.xp6(5),g.Q6J("ngIf",!t.viewOnly),g.xp6(3),g.hij("\n          ",g.lcZ(36,12,"close"),"\n        "))},dependencies:[m.sg,m.O5,he.JL,he.F,S.B,fi.b,mi.O,k.C],encapsulation:2});var Si,Ii=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function qi(e,t){if(1&e&&(g._UZ(0,"bit-access-selector",10),g.ALo(1,"i18n"),g.ALo(2,"i18n"),g.ALo(3,"i18n"),g.ALo(4,"i18n"),g.ALo(5,"async")),2&e){const e=g.oxw();g.Q6J("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",g.lcZ(1,7,"groupAndMemberColumnHeader"))("selectorLabelText",g.lcZ(2,9,"selectGroupsAndMembers"))("selectorHelpText",g.lcZ(3,11,"userPermissionOverrideHelper"))("emptySelectionText",g.lcZ(4,13,"noMembersOrGroupsAdded"))("flexibleCollectionsEnabled",g.lcZ(5,15,e.flexibleCollectionsEnabled$))}}function zi(e,t){if(1&e&&(g._UZ(0,"bit-access-selector",11),g.ALo(1,"i18n"),g.ALo(2,"i18n"),g.ALo(3,"i18n"),g.ALo(4,"async")),2&e){const e=g.oxw();g.Q6J("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",g.lcZ(1,6,"memberColumnHeader"))("selectorLabelText",g.lcZ(2,8,"selectMembers"))("emptySelectionText",g.lcZ(3,10,"noMembersAdded"))("flexibleCollectionsEnabled",g.lcZ(4,12,e.flexibleCollectionsEnabled$))}}!function(e){e.Saved="saved",e.Canceled="canceled"}(Si||(Si={}));class Li{constructor(e,t,i,n,o,r,l,s,c,d){this.params=e,this.dialogRef=t,this.formBuilder=i,this.organizationService=n,this.groupService=o,this.organizationUserService=r,this.platformUtilsService=l,this.i18nService=s,this.collectionAdminService=c,this.configService=d,this.flexibleCollectionsEnabled$=this.configService.getFeatureFlag$(h.T.FlexibleCollections,!1),this.PermissionMode=ve.R9,this.formGroup=this.formBuilder.group({access:[[]]}),this.loading=!0,this.accessItems=[],this.destroy$=new a.x,this.submit=()=>Ii(this,void 0,void 0,(function*(){const e=this.formGroup.controls.access.value.filter((e=>e.type===ve.zD.Member)).map(ve.E2),t=this.formGroup.controls.access.value.filter((e=>e.type===ve.zD.Group)).map(ve.E2);yield this.collectionAdminService.bulkAssignAccess(this.organization.id,this.params.collections.map((e=>e.id)),e,t),this.platformUtilsService.showToast("success",null,this.i18nService.t("editedCollections")),this.dialogRef.close(Si.Saved)})),this.numCollections=this.params.collections.length;const p=this.organizationService.get$(this.params.organizationId),g=p.pipe((0,ne.w)((e=>e.useGroups?this.groupService.getAll(e.id):(0,ge.of)([]))));(0,oe.a)([p,g,this.organizationUserService.getAllUsers(this.params.organizationId)]).pipe((0,u.R)(this.destroy$)).subscribe((([e,t,i])=>{this.organization=e,this.accessItems=[].concat(t.map(ve.hs),i.data.map(ve.XL)),this.loading=!1}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static open(e,t){return e.open(Li,t)}}Li.ɵfac=function(e){return new(e||Li)(g.Y36(pe.Kt),g.Y36(pe.zj),g.Y36(he.qu),g.Y36(l.Mn),g.Y36(n.lT),g.Y36(Ue.t),g.Y36(_e.P),g.Y36(T.D),g.Y36(kt.m),g.Y36(f.i))},Li.ɵcmp=g.Xpm({type:Li,selectors:[["app-bulk-collections-dialog"]],standalone:!0,features:[g.jDz],decls:32,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"loading"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText","flexibleCollectionsEnabled",4,"ngIf"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled",4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","bitFormButton","","buttonType","primary"],["type","button","bitButton","","bitFormButton","","buttonType","secondary","bitDialogClose",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText","flexibleCollectionsEnabled"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled"]],template:function(e,t){1&e&&(g.TgZ(0,"form",0),g._uU(1,"\n  "),g.TgZ(2,"bit-dialog",1),g._uU(3,"\n    "),g.TgZ(4,"span",2),g._uU(5),g.ALo(6,"i18n"),g.TgZ(7,"span",3),g._uU(8),g.ALo(9,"i18n"),g.qZA(),g._uU(10,"\n    "),g.qZA(),g._uU(11,"\n\n    "),g.TgZ(12,"div",4),g._uU(13,"\n      "),g.YNc(14,qi,6,17,"bit-access-selector",5),g._uU(15,"\n      "),g.YNc(16,zi,5,14,"bit-access-selector",6),g._uU(17,"\n    "),g.qZA(),g._uU(18,"\n\n    "),g.ynx(19,7),g._uU(20,"\n      "),g.TgZ(21,"button",8),g._uU(22),g.ALo(23,"i18n"),g.qZA(),g._uU(24,"\n      "),g.TgZ(25,"button",9),g._uU(26),g.ALo(27,"i18n"),g.qZA(),g._uU(28,"\n    "),g.BQk(),g._uU(29,"\n  "),g.qZA(),g._uU(30,"\n"),g.qZA(),g._uU(31,"\n")),2&e&&(g.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),g.xp6(2),g.Q6J("loading",t.loading),g.xp6(3),g.hij("\n      ",g.lcZ(6,10,"assignCollectionAccess"),"\n      "),g.xp6(3),g.AsE("\n        ",t.numCollections," ",g.lcZ(9,12,1==t.numCollections?"collection":"collections"),"\n      "),g.xp6(6),g.Q6J("ngIf",null==t.organization?null:t.organization.useGroups),g.xp6(2),g.Q6J("ngIf",!(null!=t.organization&&t.organization.useGroups)),g.xp6(6),g.hij("\n        ",g.lcZ(23,14,"save"),"\n      "),g.xp6(4),g.hij("\n        ",g.lcZ(27,16,"cancel"),"\n      "))},dependencies:[xt.m,m.O5,he._Y,he.JJ,he.JL,he.sg,he.u,Ce.b,Te.u,Se.r,Ie.a,qe.f,m.Ov,k.C,ve.k4,Ye.f],encapsulation:2});var Mi=i(43898),ki=i(17475),Oi=i(12963),Fi=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function Ji(e,t){if(1&e&&(g.TgZ(0,"small"),g._uU(1),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Oqu(e.cipher.name)}}function Yi(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",17),g._uU(1,"\n            "),g.TgZ(2,"button",18),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw();return g.KtG(t.selectAll(!0))})),g._uU(3),g.ALo(4,"i18n"),g.qZA(),g._uU(5,"\n            "),g.TgZ(6,"button",18),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw();return g.KtG(t.selectAll(!1))})),g._uU(7),g.ALo(8,"i18n"),g.qZA(),g._uU(9,"\n          "),g.qZA()}2&e&&(g.xp6(3),g.hij("\n              ",g.lcZ(4,2,"selectAll"),"\n            "),g.xp6(4),g.hij("\n              ",g.lcZ(8,4,"unselectAll"),"\n            "))}function Ni(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1),g.ALo(2,"i18n"),g.qZA()),2&e&&(g.xp6(1),g.hij("\n          ",g.lcZ(2,1,"noCollectionsInList"),"\n        "))}function Gi(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"tr",21),g.NdJ("click",(function(){const t=g.CHM(e).$implicit,i=g.oxw(2);return g.KtG(i.check(t))})),g._uU(1,"\n              "),g.TgZ(2,"td",22),g._uU(3,"\n                "),g.TgZ(4,"input",23),g.NdJ("ngModelChange",(function(t){const i=g.CHM(e).$implicit;return g.KtG(i.checked=t)})),g.qZA(),g._uU(5,"\n              "),g.qZA(),g._uU(6,"\n              "),g.TgZ(7,"td"),g._uU(8),g.qZA(),g._uU(9,"\n            "),g.qZA()}if(2&e){const e=t.$implicit,i=t.index;g.xp6(4),g.MGl("name","Collection[",i,"].Checked"),g.Q6J("ngModel",e.checked),g.xp6(4),g.hij("\n                ",e.name,"\n              ")}}function Di(e,t){if(1&e&&(g.TgZ(0,"table",19),g._uU(1,"\n          "),g.TgZ(2,"tbody"),g._uU(3,"\n            "),g.YNc(4,Gi,10,3,"tr",20),g._uU(5,"\n          "),g.qZA(),g._uU(6,"\n        "),g.qZA()),2&e){const e=g.oxw();g.xp6(4),g.Q6J("ngForOf",e.collections)}}class Ei extends ki.U{constructor(e,t,i,n,o,r){super(e,t,i,n,r),this.apiService=o,this.allowSelectNone=!0}loadCipher(){const e=Object.create(null,{loadCipher:{get:()=>super.loadCipher}});return Fi(this,void 0,void 0,(function*(){if(!this.organization.canViewAllCollections)return yield e.loadCipher.call(this);const t=yield this.apiService.getCipherAdmin(this.cipherId);return new ui.t(new ai.O(t))}))}loadCipherCollections(){return this.organization.canViewAllCollections?this.collectionIds:super.loadCipherCollections()}loadCollections(){return this.organization.canViewAllCollections?Promise.resolve(this.collections):super.loadCollections()}saveCollections(){if(this.organization.canEditAnyCollection){const e=new Mi.L(this.cipherDomain.collectionIds);return this.apiService.putCipherCollectionsAdmin(this.cipherId,e)}return super.saveCollections()}}Ei.ɵfac=function(e){return new(e||Ei)(g.Y36(Ze.a),g.Y36(_e.P),g.Y36(T.D),g.Y36(Jt.u),g.Y36(be.s),g.Y36(we.$))},Ei.ɵcmp=g.Xpm({type:Ei,selectors:[["app-org-vault-collections"]],features:[g.qOj],decls:63,vars:27,consts:[["role","dialog","aria-modal","true","aria-labelledby","collectionsTitle",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-scrollable"],[1,"modal-content",3,"appApiAction","ngSubmit"],["form",""],[1,"modal-header"],["id","collectionsTitle",1,"modal-title"],[4,"ngIf"],["type","button","data-dismiss","modal",1,"close",3,"appA11yTitle"],["aria-hidden","true"],[1,"modal-body"],[1,"d-flex"],["class","ml-auto d-flex",4,"ngIf"],["class","table table-hover table-list mb-0",4,"ngIf"],[1,"modal-footer"],["type","submit",1,"btn","btn-primary","btn-submit",3,"disabled"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"],["type","button","data-dismiss","modal",1,"btn","btn-outline-secondary"],[1,"ml-auto","d-flex"],["type","button",1,"btn","btn-link","btn-sm","py-0",3,"click"],[1,"table","table-hover","table-list","mb-0"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"table-list-checkbox"],["type","checkbox","appStopProp","",3,"ngModel","name","ngModelChange"]],template:function(e,t){if(1&e&&(g.TgZ(0,"div",0),g._uU(1,"\n  "),g.TgZ(2,"div",1),g._uU(3,"\n    "),g.TgZ(4,"form",2,3),g.NdJ("ngSubmit",(function(){return t.submit()})),g._uU(6,"\n      "),g.TgZ(7,"div",4),g._uU(8,"\n        "),g.TgZ(9,"h1",5),g._uU(10),g.ALo(11,"i18n"),g.YNc(12,Ji,2,1,"small",6),g._uU(13,"\n        "),g.qZA(),g._uU(14,"\n        "),g.TgZ(15,"button",7),g.ALo(16,"i18n"),g._uU(17,"\n          "),g.TgZ(18,"span",8),g._uU(19,"×"),g.qZA(),g._uU(20,"\n        "),g.qZA(),g._uU(21,"\n      "),g.qZA(),g._uU(22,"\n      "),g.TgZ(23,"div",9),g._uU(24,"\n        "),g.TgZ(25,"p"),g._uU(26),g.ALo(27,"i18n"),g.qZA(),g._uU(28,"\n        "),g.TgZ(29,"div",10),g._uU(30,"\n          "),g.TgZ(31,"h3"),g._uU(32),g.ALo(33,"i18n"),g.qZA(),g._uU(34,"\n          "),g.YNc(35,Yi,10,6,"div",11),g._uU(36,"\n        "),g.qZA(),g._uU(37,"\n        "),g.YNc(38,Ni,3,3,"div",6),g._uU(39,"\n        "),g.YNc(40,Di,7,1,"table",12),g._uU(41,"\n      "),g.qZA(),g._uU(42,"\n      "),g.TgZ(43,"div",13),g._uU(44,"\n        "),g.TgZ(45,"button",14),g._uU(46,"\n          "),g._UZ(47,"i",15),g.ALo(48,"i18n"),g._uU(49,"\n          "),g.TgZ(50,"span"),g._uU(51),g.ALo(52,"i18n"),g.qZA(),g._uU(53,"\n        "),g.qZA(),g._uU(54,"\n        "),g.TgZ(55,"button",16),g._uU(56),g.ALo(57,"i18n"),g.qZA(),g._uU(58,"\n      "),g.qZA(),g._uU(59,"\n    "),g.qZA(),g._uU(60,"\n  "),g.qZA(),g._uU(61,"\n"),g.qZA(),g._uU(62,"\n")),2&e){const e=g.MAs(5);g.xp6(4),g.Q6J("appApiAction",t.formPromise),g.xp6(6),g.hij("\n          ",g.lcZ(11,13,"collections"),"\n          "),g.xp6(2),g.Q6J("ngIf",t.cipher),g.xp6(3),g.s9C("appA11yTitle",g.lcZ(16,15,"close")),g.xp6(11),g.Oqu(g.lcZ(27,17,"collectionsDesc")),g.xp6(6),g.Oqu(g.lcZ(33,19,"collections")),g.xp6(3),g.Q6J("ngIf",t.collections&&t.collections.length),g.xp6(3),g.Q6J("ngIf",!t.collections||!t.collections.length),g.xp6(2),g.Q6J("ngIf",t.collections&&t.collections.length),g.xp6(5),g.Q6J("disabled",e.loading),g.xp6(2),g.s9C("title",g.lcZ(48,21,"loading")),g.xp6(4),g.Oqu(g.lcZ(52,23,"save")),g.xp6(5),g.hij("\n          ",g.lcZ(57,25,"cancel"),"\n        ")}},dependencies:[m.sg,m.O5,he._Y,he.Wl,he.JJ,he.JL,he.On,he.F,S.B,fi.b,Oi._,k.C],encapsulation:2});var Qi=i(30276),$i=i(26187),Pi=i(94239),Bi=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};function Ri(e,t){1&e&&(g.TgZ(0,"div",3),g._uU(1,"\n    "),g._UZ(2,"i",4),g._uU(3,"\n  "),g.qZA())}function Hi(e,t){if(1&e&&(g.ynx(0),g._uU(1,"\n        "),g.TgZ(2,"div",12),g._uU(3,"\n          "),g.TgZ(4,"app-filter-section",13),g._uU(5," "),g.qZA(),g._uU(6,"\n        "),g.qZA(),g._uU(7,"\n      "),g.BQk()),2&e){const e=t.$implicit,i=g.oxw(2);g.xp6(4),g.Q6J("activeFilter",i.activeFilter)("section",e)}}function ji(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div"),g._uU(1,"\n    "),g.TgZ(2,"div",5),g._uU(3),g.ALo(4,"i18n"),g.TgZ(5,"a",6),g.ALo(6,"i18n"),g._uU(7,"\n        "),g._UZ(8,"i",7),g._uU(9,"\n      "),g.qZA(),g._uU(10,"\n    "),g.qZA(),g._uU(11,"\n    "),g.TgZ(12,"div",8),g._uU(13,"\n      "),g.TgZ(14,"div",9),g._uU(15,"\n        "),g.TgZ(16,"bit-search",10),g.NdJ("ngModelChange",(function(t){g.CHM(e);const i=g.oxw();return g.KtG(i.searchText=t)}))("ngModelChange",(function(t){g.CHM(e);const i=g.oxw();return g.KtG(i.onSearchTextChanged(t))})),g.ALo(17,"i18n"),g.qZA(),g._uU(18,"\n      "),g.qZA(),g._uU(19,"\n      "),g.YNc(20,Hi,8,2,"ng-container",11),g._uU(21,"\n    "),g.qZA(),g._uU(22,"\n  "),g.qZA()}if(2&e){const e=g.oxw();g.xp6(3),g.hij("\n      ",g.lcZ(4,5,"filters"),"\n      "),g.xp6(2),g.s9C("appA11yTitle",g.lcZ(6,7,"learnMore")),g.xp6(11),g.s9C("placeholder",g.lcZ(17,9,e.searchPlaceholder)),g.Q6J("ngModel",e.searchText),g.xp6(4),g.Q6J("ngForOf",e.filtersList)}}class Ki extends Qi.P{set organization(e){e&&e!==this._organization&&(this._organization=e,this.vaultFilterService.setOrganizationFilter(this._organization))}constructor(e,t,i,n,o){super(e,t,i,n),this.vaultFilterService=e,this.policyService=t,this.i18nService=i,this.platformUtilsService=n,this.configService=o}ngOnInit(){return Bi(this,void 0,void 0,(function*(){this.flexibleCollectionsEnabled=yield this.configService.getFeatureFlag(h.T.FlexibleCollections),this.filters=yield this.buildAllFilters(),this.activeFilter.selectedCipherTypeNode||(this.activeFilter.resetFilter(),this.activeFilter.selectedCollectionNode=yield this.getDefaultFilter()),this.isLoaded=!0}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}removeCollapsibleCollection(){return Bi(this,void 0,void 0,(function*(){const e=yield(0,Et.z)(this.vaultFilterService.collapsedFilterNodes$);e.delete("AllCollections"),yield this.vaultFilterService.setCollapsedFilterNodes(e)}))}addCollectionFilter(){return Bi(this,void 0,void 0,(function*(){this.removeCollapsibleCollection();return{data$:this.vaultFilterService.buildTypeTree({id:"AllCollections",name:"collections",type:"all",icon:"bwi-collection"},[{id:"AllCollections",name:"Collections",type:"all",icon:"bwi-collection"}]),header:{showHeader:!1,isSelectable:!0},action:this.applyCollectionFilter}}))}buildAllFilters(){const e=Object.create(null,{addCollectionFilter:{get:()=>super.addCollectionFilter}});return Bi(this,void 0,void 0,(function*(){const t={};return t.typeFilter=yield this.addTypeFilter(["favorites"]),this.flexibleCollectionsEnabled?t.collectionFilter=yield this.addCollectionFilter():t.collectionFilter=yield e.addCollectionFilter.call(this),t.trashFilter=yield this.addTrashFilter(),t}))}getDefaultFilter(){var e;return Bi(this,void 0,void 0,(function*(){return yield(0,Et.z)(null===(e=this.filters)||void 0===e?void 0:e.collectionFilter.data$)}))}}Ki.ɵfac=function(e){return new(e||Ki)(g.Y36(qt.n),g.Y36(Yt.d),g.Y36(T.D),g.Y36(_e.P),g.Y36(f.i))},Ki.ɵcmp=g.Xpm({type:Ki,selectors:[["app-organization-vault-filter"]],inputs:{organization:"organization"},features:[g.qOj],decls:7,vars:2,consts:[[1,"card","vault-filters"],["class","container loading-spinner",4,"ngIf"],[4,"ngIf"],[1,"container","loading-spinner"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],[1,"card-header","d-flex"],["href","https://bitwarden.com/help/searching-vault/","target","_blank","rel","noopener",1,"ml-auto",3,"appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-question-circle"],[1,"card-body"],[1,"tw-mb-4"],["id","search","autocomplete","off","appAutofocus","",3,"placeholder","ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"filter"],[3,"activeFilter","section"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._uU(1,"\n  "),g.YNc(2,Ri,4,0,"div",1),g._uU(3,"\n  "),g.YNc(4,ji,23,11,"div",2),g._uU(5,"\n"),g.qZA(),g._uU(6,"\n")),2&e&&(g.xp6(2),g.Q6J("ngIf",!t.isLoaded),g.xp6(2),g.Q6J("ngIf",t.isLoaded))},dependencies:[m.sg,m.O5,he.JJ,he.On,S.B,xe.U,$i.n,Pi.g,k.C],encapsulation:2});var Wi=i(4871),Vi=i(34961),Xi=i(7323),en=i(87483),tn=i(8067),nn=i(53707),on=i(22221),rn=i(98583),ln=i(8427),sn=i(93814),cn=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};const an=function(){return[]},un=function(e){return{collectionId:e}};function dn(e,t){if(1&e&&(g.TgZ(0,"bit-breadcrumb",7),g._uU(1),g.qZA()),2&e){const e=t.$implicit;g.Q6J("route",g.DdM(3,an))("queryParams",g.VKq(4,un,e.id)),g.xp6(1),g.hij("\n          ",e.name,"\n        ")}}const pn=function(e){return{organizationId:e,collectionId:null}};function hn(e,t){if(1&e&&(g.TgZ(0,"bit-breadcrumbs"),g._uU(1,"\n      "),g.TgZ(2,"bit-breadcrumb",5),g._uU(3),g.ALo(4,"lowercase"),g.ALo(5,"i18n"),g.qZA(),g._uU(6,"\n      "),g.ynx(7),g._uU(8,"\n        "),g.YNc(9,dn,2,6,"bit-breadcrumb",6),g._uU(10,"\n      "),g.BQk(),g._uU(11,"\n    "),g.qZA()),2&e){const e=g.oxw();g.xp6(2),g.Q6J("route",g.DdM(9,an))("queryParams",g.VKq(10,pn,e.organization.id)),g.xp6(1),g.AsE("\n        ",e.organization.name," ",g.lcZ(4,5,g.lcZ(5,7,"vault")),"\n      "),g.xp6(6),g.Q6J("ngForOf",e.collections)}}function gn(e,t){1&e&&g._UZ(0,"i",8)}function fn(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",12),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.editCollection(t.CollectionDialogTabType.Info))})),g._uU(1,"\n            "),g._UZ(2,"i",13),g._uU(3),g.ALo(4,"i18n"),g.qZA()}2&e&&(g.xp6(3),g.hij("\n            ",g.lcZ(4,1,"editInfo"),"\n          "))}function mn(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",12),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.editCollection(t.CollectionDialogTabType.Access))})),g._uU(1,"\n            "),g._UZ(2,"i",14),g._uU(3),g.ALo(4,"i18n"),g.qZA()}2&e&&(g.xp6(3),g.hij("\n            ",g.lcZ(4,1,"access"),"\n          "))}function vn(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",12),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.deleteCollection())})),g._uU(1,"\n            "),g.TgZ(2,"span",15),g._uU(3,"\n              "),g._UZ(4,"i",16),g._uU(5),g.ALo(6,"i18n"),g.qZA(),g._uU(7,"\n          "),g.qZA()}2&e&&(g.xp6(5),g.hij("\n              ",g.lcZ(6,1,"delete"),"\n            "))}function bn(e,t){if(1&e&&(g.ynx(0),g._uU(1,"\n        "),g._UZ(2,"button",9),g._uU(3,"\n        "),g.TgZ(4,"bit-menu",null,10),g._uU(6,"\n          "),g.YNc(7,fn,5,3,"button",11),g._uU(8,"\n          "),g.YNc(9,mn,5,3,"button",11),g._uU(10,"\n          "),g.YNc(11,vn,8,3,"button",11),g._uU(12,"\n        "),g.qZA(),g._uU(13,"\n      "),g.BQk()),2&e){const e=g.MAs(5),t=g.oxw();g.xp6(2),g.Q6J("bitMenuTriggerFor",e),g.xp6(5),g.Q6J("ngIf",t.canEditCollection),g.xp6(2),g.Q6J("ngIf",t.canEditCollection),g.xp6(2),g.Q6J("ngIf",t.canDeleteCollection)}}function Un(e,t){1&e&&(g.TgZ(0,"small"),g._uU(1,"\n        "),g._UZ(2,"i",17),g.ALo(3,"i18n"),g._uU(4,"\n        "),g.TgZ(5,"span",18),g._uU(6),g.ALo(7,"i18n"),g.qZA(),g._uU(8,"\n      "),g.qZA()),2&e&&(g.xp6(2),g.s9C("title",g.lcZ(3,2,"loading")),g.xp6(4),g.Oqu(g.lcZ(7,4,"loading")))}function Zn(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",22),g._uU(1,"\n      "),g.TgZ(2,"button",23),g.ALo(3,"i18n"),g._uU(4),g.ALo(5,"i18n"),g._UZ(6,"i",24),g._uU(7,"\n      "),g.qZA(),g._uU(8,"\n      "),g.TgZ(9,"bit-menu",25,26),g._uU(11,"\n        "),g.TgZ(12,"button",12),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.addCipher())})),g._uU(13,"\n          "),g._UZ(14,"i",27),g._uU(15),g.ALo(16,"i18n"),g.qZA(),g._uU(17,"\n        "),g.TgZ(18,"button",12),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.addCollection())})),g._uU(19,"\n          "),g._UZ(20,"i",28),g._uU(21),g.ALo(22,"i18n"),g.qZA(),g._uU(23,"\n      "),g.qZA(),g._uU(24,"\n    "),g.qZA()}if(2&e){const e=g.MAs(10);g.xp6(2),g.s9C("appA11yTitle",g.lcZ(3,5,"new")),g.Q6J("bitMenuTriggerFor",e),g.xp6(2),g.hij("\n        ",g.lcZ(5,7,"new"),""),g.xp6(11),g.hij("\n          ",g.lcZ(16,9,"item"),"\n        "),g.xp6(6),g.hij("\n          ",g.lcZ(22,11,"collection"),"\n        ")}}function _n(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",29),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.addCipher())})),g._uU(1,"\n      "),g._UZ(2,"i",30),g._uU(3),g.ALo(4,"i18n"),g.qZA()}2&e&&(g.xp6(3),g.hij("\n      ",g.lcZ(4,1,"newItem"),"\n    "))}function wn(e,t){if(1&e&&(g.TgZ(0,"div",19),g._uU(1,"\n    "),g.YNc(2,Zn,25,13,"div",20),g._uU(3,"\n    "),g.YNc(4,_n,5,3,"button",21),g._uU(5,"\n  "),g.qZA()),2&e){const e=g.oxw();g.xp6(2),g.Q6J("ngIf",e.organization.canCreateNewCollections),g.xp6(2),g.Q6J("ngIf",!e.organization.canCreateNewCollections)}}class An{constructor(e,t,i,n,o,r){this.organizationService=e,this.i18nService=t,this.dialogService=i,this.collectionAdminService=n,this.router=o,this.configService=r,this.All=li.oT,this.Unassigned=li.JK,this.onAddCipher=new g.vpe,this.onAddCollection=new g.vpe,this.onEditCollection=new g.vpe,this.onDeleteCollection=new g.vpe,this.CollectionDialogTabType=Ut.sn,this.organizations$=this.organizationService.organizations$}ngOnInit(){return cn(this,void 0,void 0,(function*(){this.flexibleCollectionsEnabled=yield this.configService.getFeatureFlag(h.T.FlexibleCollections)}))}get title(){const e=this.flexibleCollectionsEnabled?this.i18nService.t("collections").toLowerCase():this.i18nService.t("vault").toLowerCase();return void 0!==this.collection?this.collection.node.name:this.filter.collectionId===li.JK?this.i18nService.t("unassigned"):`${this.organization.name} ${e}`}get showBreadcrumbs(){return void 0!==this.filter.collectionId&&this.filter.collectionId!==li.oT}get collections(){if(null==this.collection)return[];const e=[this.collection];for(;null!=e[e.length-1].parent;)e.push(e[e.length-1].parent);return e.slice(1).reverse().map((e=>e.node))}showFreeOrgUpgradeDialog(){const e={title:this.i18nService.t("upgradeOrganization"),content:this.i18nService.t(this.organization.canEditSubscription?"freeOrgMaxCollectionReachedManageBilling":"freeOrgMaxCollectionReachedNoManageBilling",this.organization.maxCollections),type:"primary"};this.organization.canEditSubscription?e.acceptButtonText=this.i18nService.t("upgrade"):(e.acceptButtonText=this.i18nService.t("ok"),e.cancelButtonText=null);const t=this.dialogService.openSimpleDialogRef(e);(0,Et.z)(t.closed).then((e=>{e&&e&&this.organization.canEditSubscription&&this.router.navigate(["/organizations",this.organization.id,"billing","subscription"],{queryParams:{upgrade:!0}})}))}get canEditCollection(){return void 0!==this.collection&&this.collection.node.canEdit(this.organization,this.flexibleCollectionsEnabled)}addCipher(){this.onAddCipher.emit()}addCollection(){return cn(this,void 0,void 0,(function*(){if(this.organization.planProductType===Ht.kv.Free){if((yield this.collectionAdminService.getAll(this.organization.id)).length===this.organization.maxCollections)return void this.showFreeOrgUpgradeDialog()}this.onAddCollection.emit()}))}editCollection(e){return cn(this,void 0,void 0,(function*(){this.onEditCollection.emit({tab:e})}))}get canDeleteCollection(){return void 0!==this.collection&&this.collection.node.canDelete(this.organization,this.flexibleCollectionsEnabled)}deleteCollection(){this.onDeleteCollection.emit()}}An.ɵfac=function(e){return new(e||An)(g.Y36(l.Mn),g.Y36(T.D),g.Y36(Ae.x),g.Y36(kt.m),g.Y36(o.F0),g.Y36(f.i))},An.ɵcmp=g.Xpm({type:An,selectors:[["app-org-vault-header"]],inputs:{loading:"loading",filter:"filter",organization:"organization",collection:"collection"},outputs:{onAddCipher:"onAddCipher",onAddCollection:"onAddCollection",onEditCollection:"onEditCollection",onDeleteCollection:"onDeleteCollection"},decls:22,vars:6,consts:[[1,"tw-mb-4","tw-flex","tw-items-start","tw-justify-between"],[4,"ngIf"],[1,"tw-mb-0","tw-mt-1","tw-flex","tw-items-center","tw-space-x-2"],["class","bwi bwi-collection","aria-hidden","true",4,"ngIf"],["class","tw-shrink-0",4,"ngIf"],["queryParamsHandling","merge",3,"route","queryParams"],["icon","bwi-collection","queryParamsHandling","merge",3,"route","queryParams",4,"ngFor","ngForOf"],["icon","bwi-collection","queryParamsHandling","merge",3,"route","queryParams"],["aria-hidden","true",1,"bwi","bwi-collection"],["bitIconButton","bwi-angle-down","size","small","type","button","aria-haspopup","",3,"bitMenuTriggerFor"],["editCollectionMenu",""],["type","button","bitMenuItem","",3,"click",4,"ngIf"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-users"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"tw-sr-only"],[1,"tw-shrink-0"],["appListDropdown","",4,"ngIf"],["type","button","bitButton","","buttonType","primary",3,"click",4,"ngIf"],["appListDropdown",""],["bitButton","","buttonType","primary","type","button","id","newItemDropdown",3,"bitMenuTriggerFor","appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-angle-down","tw-ml-2"],["aria-labelledby","newItemDropdown"],["addOptions",""],["aria-hidden","true",1,"bwi","bwi-fw","bwi-globe"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-collection"],["type","button","bitButton","","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._uU(1,"\n  "),g.TgZ(2,"div"),g._uU(3,"\n    "),g.YNc(4,hn,12,12,"bit-breadcrumbs",1),g._uU(5,"\n    "),g.TgZ(6,"h1",2),g._uU(7,"\n      "),g.YNc(8,gn,1,0,"i",3),g._uU(9,"\n      "),g.TgZ(10,"span"),g._uU(11),g.qZA(),g._uU(12,"\n      "),g.YNc(13,bn,14,4,"ng-container",1),g._uU(14,"\n      "),g.YNc(15,Un,9,6,"small",1),g._uU(16,"\n    "),g.qZA(),g._uU(17,"\n  "),g.qZA(),g._uU(18,"\n\n  "),g.YNc(19,wn,6,2,"div",4),g._uU(20,"\n"),g.qZA(),g._uU(21,"\n")),2&e&&(g.xp6(4),g.Q6J("ngIf",t.showBreadcrumbs),g.xp6(4),g.Q6J("ngIf",void 0!==t.filter.collectionId),g.xp6(3),g.Oqu(t.title),g.xp6(2),g.Q6J("ngIf",void 0!==t.collection&&(t.canEditCollection||t.canDeleteCollection)),g.xp6(2),g.Q6J("ngIf",t.loading),g.xp6(4),g.Q6J("ngIf","trash"!==t.filter.type&&t.filter.collectionId!==t.Unassigned))},dependencies:[m.sg,m.O5,S.B,Se.r,Oe.Q,q.M,z.t,L.e,ln.n,sn.L,m.i8,k.C],encapsulation:2});var xn=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{c(n.next(e))}catch(t){r(t)}}function s(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}c((n=n.apply(e,t||[])).next())}))};const yn=["vaultFilter"],Cn=["attachments"],Tn=["cipherAddEdit"],Sn=["collectionsModal"];function In(e,t){if(1&e&&(g.TgZ(0,"app-callout",16),g._uU(1),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.hij("\n        ",e.trashCleanupWarning,"\n      ")}}function qn(e,t){if(1&e&&(g.TgZ(0,"div",17),g._uU(1,"\n        "),g._UZ(2,"bit-icon",18),g._uU(3,"\n        "),g.TgZ(4,"p"),g._uU(5),g.ALo(6,"i18n"),g.qZA(),g._uU(7,"\n      "),g.qZA()),2&e){const e=g.oxw();g.xp6(2),g.Q6J("icon",e.noItemIcon),g.xp6(3),g.Oqu(g.lcZ(6,2,"noPermissionToViewAllCollectionItems"))}}function zn(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",20),g.NdJ("click",(function(){g.CHM(e);const t=g.oxw(2);return g.KtG(t.addCipher())})),g._uU(1,"\n          "),g._UZ(2,"i",21),g._uU(3),g.ALo(4,"i18n"),g.qZA()}2&e&&(g.xp6(3),g.hij("\n          ",g.lcZ(4,1,"newItem"),"\n        "))}function Ln(e,t){if(1&e&&(g.TgZ(0,"div",17),g._uU(1,"\n        "),g._UZ(2,"bit-icon",18),g._uU(3,"\n        "),g.TgZ(4,"p"),g._uU(5),g.ALo(6,"i18n"),g.qZA(),g._uU(7,"\n        "),g.YNc(8,zn,5,3,"button",19),g._uU(9,"\n      "),g.qZA()),2&e){const e=g.oxw();g.xp6(2),g.Q6J("icon",e.noItemIcon),g.xp6(3),g.Oqu(g.lcZ(6,3,"noItemsInList")),g.xp6(3),g.Q6J("ngIf","trash"!==e.filter.type&&e.filter.collectionId!==e.Unassigned)}}function Mn(e,t){1&e&&(g.TgZ(0,"div",17),g._uU(1,"\n        "),g._UZ(2,"i",22),g.ALo(3,"i18n"),g._uU(4,"\n        "),g.TgZ(5,"span",23),g._uU(6),g.ALo(7,"i18n"),g.qZA(),g._uU(8,"\n      "),g.qZA()),2&e&&(g.xp6(2),g.s9C("title",g.lcZ(3,2,"loading")),g.xp6(4),g.Oqu(g.lcZ(7,4,"loading")))}function kn(e,t){}function On(e,t){}function Fn(e,t){}const Jn=function(e){return[e]},Yn=function(){return[]},Nn="OrgVaultComponent";class Gn{constructor(e,t,i,n,o,r,l,s,c,u,d,p,g,f,m,v,b,U,Z,_,w,A,x,y,C,T,S){this.route=e,this.organizationService=t,this.vaultFilterService=i,this.routedVaultFilterBridgeService=n,this.routedVaultFilterService=o,this.router=r,this.changeDetectorRef=l,this.syncService=s,this.i18nService=c,this.modalService=u,this.dialogService=d,this.messagingService=p,this.broadcasterService=g,this.ngZone=f,this.platformUtilsService=m,this.cipherService=v,this.passwordRepromptService=b,this.collectionAdminService=U,this.searchService=Z,this.searchPipe=_,this.groupService=w,this.logService=A,this.eventCollectionService=x,this.totpService=y,this.apiService=C,this.collectionService=T,this.configService=S,this.Unassigned=li.JK,this.trashCleanupWarning=null,this.activeFilter=new ei.l,this.noItemIcon=Wt.o,this.performingInitialLoad=!0,this.refreshing=!1,this.processingEvent=!1,this.filter={},this.showBulkEditCollectionAccess$=this.configService.getFeatureFlag$(h.T.BulkCollectionAccess,!1),this.searchText$=new a.x,this.refresh$=new te.X(null),this.destroy$=new a.x}ngOnInit(){return xn(this,void 0,void 0,(function*(){this.trashCleanupWarning=this.i18nService.t("trashCleanupWarningSelfHosted");const e=this.routedVaultFilterService.filter$,t=e.pipe((0,d.U)((e=>e.organizationId)),(0,Qt.h)((e=>void 0!==e)),(0,$t.x)()),i=t.pipe((0,ne.w)((e=>this.organizationService.get$(e))),(0,u.R)(this.destroy$),(0,Pt.d)({refCount:!1,bufferSize:1})),n=(0,oe.a)([i,this.route.queryParams]).pipe((0,ce.P)(),(0,ne.w)((([e])=>xn(this,void 0,void 0,(function*(){this.organization=e,e.canUseAdminCollections||(yield this.syncService.fullSync(!1))})))),(0,Pt.d)({refCount:!0,bufferSize:1}));this.broadcasterService.subscribe(Nn,(e=>{this.ngZone.run((()=>xn(this,void 0,void 0,(function*(){if("syncCompleted"===e.command)e.successfully&&(this.refresh(),this.changeDetectorRef.detectChanges())}))))})),this.routedVaultFilterBridgeService.activeFilter$.pipe((0,u.R)(this.destroy$)).subscribe((e=>{this.activeFilter=e})),this.searchText$.pipe((0,Bt.b)(200),(0,u.R)(this.destroy$)).subscribe((e=>this.router.navigate([],{queryParams:{search:C.c.isNullOrEmpty(e)?null:e},queryParamsHandling:"merge",replaceUrl:!0}))),this.currentSearchText$=this.route.queryParams.pipe((0,d.U)((e=>e.search)));const o=(0,oe.a)([t.pipe((0,ne.w)((e=>this.collectionAdminService.getAll(e)))),this.collectionService.getAllDecrypted()]).pipe((0,d.U)((([e,t])=>{const i=Object.fromEntries(t.map((e=>[e.id,e])));return e.map((e=>{const t=e.id,n=i[t];return n&&(e.manage=n.manage,e.readOnly=n.readOnly,e.hidePasswords=n.hidePasswords),e}))})),(0,Pt.d)({refCount:!0,bufferSize:1})),r=(0,oe.a)([t,o]).pipe((0,d.U)((([e,t])=>{const i=new ti.e;return i.name=this.i18nService.t("unassigned"),i.id=li.JK,i.organizationId=e,t.concat(i)}))),l=t.pipe((0,ne.w)((e=>this.groupService.getAll(e))),(0,Pt.d)({refCount:!0,bufferSize:1})),s=i.pipe((0,le.b)((e=>xn(this,void 0,void 0,(function*(){let t;return t=e.canEditAnyCollection?yield this.cipherService.getAllFromApiForOrganization(e.id):(yield this.cipherService.getAllDecrypted()).filter((t=>t.organizationId===e.id)),yield this.searchService.indexCiphers(t,e.id),t}))))),c=(0,oe.a)([s,e,this.currentSearchText$]).pipe((0,Qt.h)((([e,t])=>null!=e&&null!=t)),(0,le.b)((([e,t,i])=>xn(this,void 0,void 0,(function*(){if(void 0===t.collectionId&&void 0===t.type)return[];const n=(0,ri.E)(t);return this.searchService.isSearchable(i)?yield this.searchService.searchCiphers(i,[n],e):e.filter(n)})))),(0,Pt.d)({refCount:!0,bufferSize:1})),a=r.pipe((0,d.U)((e=>(0,si.o)(e))),(0,Pt.d)({refCount:!0,bufferSize:1})),p=(0,oe.a)([a,e,this.currentSearchText$]).pipe((0,Qt.h)((([e,t])=>null!=e&&null!=t)),(0,d.U)((([e,t,i])=>{var n;if(t.collectionId===li.JK||void 0===t.collectionId&&void 0!==t.type)return[];let o=[];if(void 0===t.collectionId||t.collectionId===li.oT)o=e.map((e=>e.node));else{const i=Kt.L.getTreeNodeObjectFromList(e,t.collectionId);o=null!==(n=null==i?void 0:i.children.map((e=>e.node)))&&void 0!==n?n:[]}return this.searchService.isSearchable(i)&&(o=this.searchPipe.transform(o,i,(e=>e.name),(e=>e.id))),o})),(0,u.R)(this.destroy$),(0,Pt.d)({refCount:!0,bufferSize:1})),h=(0,oe.a)([a,e]).pipe((0,Qt.h)((([e,t])=>null!=e&&null!=t)),(0,d.U)((([e,t])=>{if(void 0!==t.collectionId&&t.collectionId!==li.oT&&t.collectionId!==li.JK)return Kt.L.getTreeNodeObjectFromList(e,t.collectionId)})),(0,Pt.d)({refCount:!0,bufferSize:1})),g=(0,oe.a)([e,h,i]).pipe((0,d.U)((([e,t,i])=>e.collectionId===li.JK&&!i.canUseAdminCollections||null!=t&&!t.node.assigned&&!i.canUseAdminCollections)),(0,Pt.d)({refCount:!0,bufferSize:1}));n.pipe((0,ne.w)((()=>(0,oe.a)([this.route.queryParams,i]))),(0,ne.w)((([e,t])=>xn(this,void 0,void 0,(function*(){const i=Dn(e);i&&(t.canUseAdminCollections||null!=(yield this.cipherService.get(i))?this.editCipherId(i):(this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("unknownCipher")),this.router.navigate([],{queryParams:{cipherId:null,itemId:null},queryParamsHandling:"merge"})))})))),(0,u.R)(this.destroy$)).subscribe(),n.pipe((0,ne.w)((()=>(0,oe.a)([this.route.queryParams,i,s]))),(0,ne.w)((([e,t,i])=>xn(this,void 0,void 0,(function*(){const n=e.viewEvents;if(!n)return;const o=i.find((e=>e.id===n));t.useEvents&&null!=o?this.viewEvents(o):(this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("unknownCipher")),this.router.navigate([],{queryParams:{viewEvents:null},queryParamsHandling:"merge"}))})))),(0,u.R)(this.destroy$)).subscribe(),n.pipe((0,ne.w)((()=>this.refresh$)),(0,ie.b)((()=>this.refreshing=!0)),(0,ne.w)((()=>(0,oe.a)([i,e,r,l,c,p,h,g]))),(0,u.R)(this.destroy$)).subscribe((([e,t,i,n,o,r,l,s])=>{this.organization=e,this.filter=t,this.allCollections=i,this.allGroups=n,this.ciphers=o,this.collections=r,this.selectedCollection=l,this.showMissingCollectionPermissionMessage=s,this.isEmpty=0===(null==r?void 0:r.length)&&0===(null==o?void 0:o.length),this.vaultFilterService.reloadCollections(i),this.refreshing=!1,this.performingInitialLoad=!1}))}))}get loading(){return this.refreshing||this.processingEvent}ngOnDestroy(){this.broadcasterService.unsubscribe(Nn),this.destroy$.next(),this.destroy$.complete()}onVaultItemsEvent(e){return xn(this,void 0,void 0,(function*(){this.processingEvent=!0;try{if("viewAttachments"===e.type)yield this.editCipherAttachments(e.item);else if("viewCollections"===e.type)yield this.editCipherCollections(e.item);else if("clone"===e.type)yield this.cloneCipher(e.item);else if("restore"===e.type)1===e.items.length?yield this.restore(e.items[0]):yield this.bulkRestore(e.items);else if("delete"===e.type){const t=e.items.filter((e=>void 0===e.collection)).map((e=>e.cipher)),i=e.items.filter((e=>void 0===e.cipher)).map((e=>e.collection));1===t.length&&0===i.length?yield this.deleteCipher(t[0]):0===t.length&&1===i.length?yield this.deleteCollection(i[0]):yield this.bulkDelete(t,i,this.organization)}else"copyField"===e.type?yield this.copy(e.item,e.field):"editCollection"===e.type?yield this.editCollection(e.item,Ut.sn.Info):"viewCollectionAccess"===e.type?yield this.editCollection(e.item,Ut.sn.Access):"bulkEditCollectionAccess"===e.type?yield this.bulkEditCollectionAccess(e.items):"viewEvents"===e.type&&(yield this.viewEvents(e.item))}finally{this.processingEvent=!1}}))}filterSearchText(e){this.searchText$.next(e)}editCipherAttachments(e){return xn(this,void 0,void 0,(function*(){if(0!==(null==e?void 0:e.reprompt)&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});if(null==this.organization.maxStorageGb||0===this.organization.maxStorageGb)return void this.messagingService.send("upgradeOrganization",{organizationId:e.organizationId});let t=!1;const[i]=yield this.modalService.openViewRef(Ti,this.attachmentsModalRef,(i=>{i.organization=this.organization,i.cipherId=e.id,i.onUploadedAttachment.pipe((0,u.R)(this.destroy$)).subscribe((()=>t=!0)),i.onDeletedAttachment.pipe((0,u.R)(this.destroy$)).subscribe((()=>t=!0))}));i.onClosed.pipe((0,u.R)(this.destroy$)).subscribe((()=>{t&&this.refresh(),t=!1}))}))}editCipherCollections(e){return xn(this,void 0,void 0,(function*(){const t=yield(0,Et.z)(this.vaultFilterService.filteredCollections$),[i]=yield this.modalService.openViewRef(Ei,this.collectionsModalRef,(n=>{n.collectionIds=e.collectionIds,n.collections=t.filter((e=>!e.readOnly&&e.id!=li.JK)),n.organization=this.organization,n.cipherId=e.id,n.onSavedCollections.pipe((0,u.R)(this.destroy$)).subscribe((()=>{i.close(),this.refresh()}))}))}))}addCipher(){return xn(this,void 0,void 0,(function*(){const e=(yield(0,Et.z)(this.vaultFilterService.filteredCollections$)).filter((e=>!e.readOnly&&e.id!=li.JK));yield this.editCipher(null,(t=>{t.type=this.activeFilter.cipherType,t.collections=e,this.activeFilter.collectionId&&(t.collectionIds=[this.activeFilter.collectionId])}))}))}navigateToCipher(e){return xn(this,void 0,void 0,(function*(){this.go({itemId:null==e?void 0:e.id})}))}editCipher(e,t){return xn(this,void 0,void 0,(function*(){return this.editCipherId(null==e?void 0:e.id,t)}))}editCipherId(e,t){return xn(this,void 0,void 0,(function*(){const i=yield this.cipherService.get(e);if(i&&0!==i.reprompt&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});const n=t=>{t.organization=this.organization,t.organizationId=this.organization.id,t.cipherId=e,t.onSavedCipher.pipe((0,u.R)(this.destroy$)).subscribe((()=>{o.close(),this.refresh()})),t.onDeletedCipher.pipe((0,u.R)(this.destroy$)).subscribe((()=>{o.close(),this.refresh()})),t.onRestoredCipher.pipe((0,u.R)(this.destroy$)).subscribe((()=>{o.close(),this.refresh()}))},[o,r]=yield this.modalService.openViewRef(ci.Z,this.cipherAddEditModalRef,null==t?n:e=>{n(e),t(e)});return o.onClosedPromise().then((()=>{this.go({cipherId:null,itemId:null})})),r}))}cloneCipher(e){var t;return xn(this,void 0,void 0,(function*(){if(null===(t=e.login)||void 0===t?void 0:t.hasFido2Credentials){if(!(yield this.dialogService.openSimpleDialog({title:{key:"passkeyNotCopied"},content:{key:"passkeyNotCopiedAlert"},type:"info"})))return!1}const i=(yield(0,Et.z)(this.vaultFilterService.filteredCollections$)).filter((e=>!e.readOnly&&e.id!=li.JK));yield this.editCipher(e,(t=>{t.cloneMode=!0,t.collections=i,t.collectionIds=e.collectionIds}))}))}restore(e){var t;return xn(this,void 0,void 0,(function*(){if((yield this.repromptCipher([e]))&&e.isDeleted)try{const i=null===(t=this.organization)||void 0===t?void 0:t.canEditAnyCollection;yield this.cipherService.restoreWithServer(e.id,i),this.platformUtilsService.showToast("success",null,this.i18nService.t("restoredItem")),this.refresh()}catch(i){this.logService.error(i)}}))}bulkRestore(e){return xn(this,void 0,void 0,(function*(){if(!(yield this.repromptCipher(e)))return;const t=e.map((e=>e.id));0!==t.length?(yield this.cipherService.restoreManyWithServer(t),this.platformUtilsService.showToast("success",null,this.i18nService.t("restoredItems")),this.refresh()):this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"))}))}deleteCipher(e){return xn(this,void 0,void 0,(function*(){if(!(yield this.repromptCipher([e])))return;const t=e.isDeleted;if(!(yield this.dialogService.openSimpleDialog({title:{key:t?"permanentlyDeleteItem":"deleteItem"},content:{key:t?"permanentlyDeleteItemConfirmation":"deleteItemConfirmation"},type:"warning"})))return!1;try{yield this.deleteCipherWithServer(e.id,t),this.platformUtilsService.showToast("success",null,this.i18nService.t(t?"permanentlyDeletedItem":"deletedItem")),this.refresh()}catch(i){this.logService.error(i)}}))}deleteCollection(e){var t,i,n,o;return xn(this,void 0,void 0,(function*(){const r=yield this.configService.getFeatureFlag(h.T.FlexibleCollections,!1);if(!e.canDelete(this.organization,r))return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("missingPermissions"));if(yield this.dialogService.openSimpleDialog({title:e.name,content:{key:"deleteCollectionConfirmation"},type:"warning"}))try{yield this.apiService.deleteCollection(null===(t=this.organization)||void 0===t?void 0:t.id,e.id),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedCollectionId",e.name)),(null===(i=this.selectedCollection)||void 0===i?void 0:i.node.id)===e.id&&this.router.navigate([],{queryParams:{collectionId:null!==(o=null===(n=this.selectedCollection.parent)||void 0===n?void 0:n.node.id)&&void 0!==o?o:null},queryParamsHandling:"merge",replaceUrl:!0}),this.refresh()}catch(l){this.logService.error(l)}}))}bulkDelete(e,t,i){return xn(this,void 0,void 0,(function*(){if(!(yield this.repromptCipher(e)))return;if(0===e.length&&0===t.length)return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"));const n=(0,ii.E)(this.dialogService,{data:{permanent:"trash"===this.filter.type,cipherIds:e.map((e=>e.id)),collections:t,organization:i}});(yield(0,se.n)(n.closed))===ii.Jg.Deleted&&this.refresh()}))}copy(e,t){return xn(this,void 0,void 0,(function*(){let i,n,o;if("username"===t)i="Username",n=e.login.username,o="username";else if("password"===t)i="Password",n=e.login.password,o="password";else{if("totp"!==t)return void this.platformUtilsService.showToast("info",null,this.i18nService.t("unexpectedError"));i="TOTP",n=yield this.totpService.getCode(e.login.totp),o="verificationCodeTotp"}this.passwordRepromptService.protectedFields().includes(i)&&!(yield this.repromptCipher([e]))||e.viewPassword&&(this.platformUtilsService.copyToClipboard(n,{window}),this.platformUtilsService.showToast("info",null,this.i18nService.t("valueCopied",this.i18nService.t(o))),"password"===t?this.eventCollectionService.collect(Ht.tw.Cipher_ClientCopiedPassword,e.id):"totp"===t&&this.eventCollectionService.collect(Ht.tw.Cipher_ClientCopiedHiddenField,e.id))}))}addCollection(){var e,t;return xn(this,void 0,void 0,(function*(){const i=(0,Ut.ku)(this.dialogService,{data:{organizationId:null===(e=this.organization)||void 0===e?void 0:e.id,parentCollectionId:null===(t=this.selectedCollection)||void 0===t?void 0:t.node.id}}),n=yield(0,se.n)(i.closed);n.action!==Ut.a8.Saved&&n.action!==Ut.a8.Deleted||this.refresh()}))}editCollection(e,t){var i;return xn(this,void 0,void 0,(function*(){const n=(0,Ut.ku)(this.dialogService,{data:{collectionId:null==e?void 0:e.id,organizationId:null===(i=this.organization)||void 0===i?void 0:i.id,initialTab:t}}),o=yield(0,se.n)(n.closed);o.action!==Ut.a8.Saved&&o.action!==Ut.a8.Deleted||this.refresh()}))}bulkEditCollectionAccess(e){var t;return xn(this,void 0,void 0,(function*(){if(0===e.length)return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"));const i=Li.open(this.dialogService,{data:{collections:e,organizationId:null===(t=this.organization)||void 0===t?void 0:t.id}});(yield(0,se.n)(i.closed))===Si.Saved&&this.refresh()}))}viewEvents(e){return xn(this,void 0,void 0,(function*(){yield(0,Xt.Z)(this.dialogService,{data:{name:e.name,organizationId:this.organization.id,entityId:e.id,showUser:!0,entity:"cipher"}})}))}deleteCipherWithServer(e,t){var i;const n=null===(i=this.organization)||void 0===i?void 0:i.canEditAnyCollection;return t?this.cipherService.deleteWithServer(e,n):this.cipherService.softDeleteWithServer(e,n)}repromptCipher(e){return xn(this,void 0,void 0,(function*(){const t=!e.find((e=>e.reprompt!==jt.N.None));return t||(yield this.passwordRepromptService.showPasswordPrompt())}))}refresh(){this.refresh$.next()}go(e=null){null==e&&(e={type:this.activeFilter.cipherType,collectionId:this.activeFilter.collectionId,deleted:this.activeFilter.isDeleted||null}),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0})}}Gn.ɵfac=function(e){return new(e||Gn)(g.Y36(o.gz),g.Y36(l.Mn),g.Y36(qt.n),g.Y36(ni.b),g.Y36(oi.q),g.Y36(o.F0),g.Y36(g.sBO),g.Y36(Wi._),g.Y36(T.D),g.Y36(Rt.Z),g.Y36(Ae.x),g.Y36(Vi.o),g.Y36(Xi.A),g.Y36(g.R0b),g.Y36(_e.P),g.Y36(Jt.u),g.Y36(Vt.C),g.Y36(kt.m),g.Y36(Be.o),g.Y36(ae.C),g.Y36(n.lT),g.Y36(we.$),g.Y36(en.j),g.Y36(tn.w),g.Y36(be.s),g.Y36(Ze.a),g.Y36(f.i))},Gn.ɵcmp=g.Xpm({type:Gn,selectors:[["app-org-vault"]],viewQuery:function(e,t){if(1&e&&(g.Gf(yn,7),g.Gf(Cn,7,g.s_b),g.Gf(Tn,7,g.s_b),g.Gf(Sn,7,g.s_b)),2&e){let e;g.iGM(e=g.CRH())&&(t.vaultFilterComponent=e.first),g.iGM(e=g.CRH())&&(t.attachmentsModalRef=e.first),g.iGM(e=g.CRH())&&(t.cipherAddEditModalRef=e.first),g.iGM(e=g.CRH())&&(t.collectionsModalRef=e.first)}},features:[g._Bn([oi.q,ni.b])],decls:48,vars:36,consts:[[1,"container","page-content"],[1,"row"],[1,"col-3"],[1,"groupings"],[1,"content"],[1,"inner-content"],[3,"organization","activeFilter","searchText","searchTextChanged"],["vaultFilter",""],[1,"col-9"],[3,"filter","loading","organization","collection","onAddCipher","onAddCollection","onEditCollection","onDeleteCollection"],["type","warning","icon","bwi bwi-exclamation-triangle",4,"ngIf"],[3,"ciphers","collections","allCollections","allOrganizations","allGroups","disabled","showOwner","showPermissionsColumn","showCollections","showGroups","showPremiumFeatures","showBulkMove","showBulkTrashOptions","useEvents","cloneableOrganizationCiphers","showAdminActions","showBulkEditCollectionAccess","viewingOrgVault","onEvent"],["class","tw-mt-6 tw-flex tw-h-full tw-flex-col tw-items-center tw-justify-start",4,"ngIf"],["attachments",""],["cipherAddEdit",""],["collectionsModal",""],["type","warning","icon","bwi bwi-exclamation-triangle"],[1,"tw-mt-6","tw-flex","tw-h-full","tw-flex-col","tw-items-center","tw-justify-start"],["aria-hidden","true",3,"icon"],["type","button","buttonType","primary","bitButton","",3,"click",4,"ngIf"],["type","button","buttonType","primary","bitButton","",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._uU(1,"\n  "),g.TgZ(2,"div",1),g._uU(3,"\n    "),g.TgZ(4,"div",2),g._uU(5,"\n      "),g.TgZ(6,"div",3),g._uU(7,"\n        "),g.TgZ(8,"div",4),g._uU(9,"\n          "),g.TgZ(10,"div",5),g._uU(11,"\n            "),g.TgZ(12,"app-organization-vault-filter",6,7),g.NdJ("searchTextChanged",(function(e){return t.filterSearchText(e)})),g.ALo(14,"async"),g.qZA(),g._uU(15,"\n          "),g.qZA(),g._uU(16,"\n        "),g.qZA(),g._uU(17,"\n      "),g.qZA(),g._uU(18,"\n    "),g.qZA(),g._uU(19,"\n    "),g.TgZ(20,"div",8),g._uU(21,"\n      "),g.TgZ(22,"app-org-vault-header",9),g.NdJ("onAddCipher",(function(){return t.addCipher()}))("onAddCollection",(function(){return t.addCollection()}))("onEditCollection",(function(e){return t.editCollection(t.selectedCollection.node,e.tab)}))("onDeleteCollection",(function(){return t.deleteCollection(t.selectedCollection.node)})),g.qZA(),g._uU(23,"\n      "),g.YNc(24,In,2,1,"app-callout",10),g._uU(25,"\n      "),g.TgZ(26,"app-vault-items",11),g.NdJ("onEvent",(function(e){return t.onVaultItemsEvent(e)})),g.ALo(27,"async"),g._uU(28,"\n      "),g.qZA(),g._uU(29,"\n      "),g.YNc(30,qn,8,4,"div",12),g._uU(31,"\n      "),g.YNc(32,Ln,10,5,"div",12),g._uU(33,"\n      "),g.YNc(34,Mn,9,6,"div",12),g._uU(35,"\n    "),g.qZA(),g._uU(36,"\n  "),g.qZA(),g._uU(37,"\n  "),g.YNc(38,kn,0,0,"ng-template",null,13,g.W1O),g._uU(40,"\n  "),g.YNc(41,On,0,0,"ng-template",null,14,g.W1O),g._uU(43,"\n  "),g.YNc(44,Fn,0,0,"ng-template",null,15,g.W1O),g._uU(46,"\n"),g.qZA(),g._uU(47,"\n")),2&e&&(g.xp6(12),g.Q6J("organization",t.organization)("activeFilter",t.activeFilter)("searchText",g.lcZ(14,29,t.currentSearchText$)),g.xp6(10),g.Q6J("filter",t.filter)("loading",t.refreshing)("organization",t.organization)("collection",t.selectedCollection),g.xp6(2),g.Q6J("ngIf",t.activeFilter.isDeleted),g.xp6(2),g.Q6J("ciphers",t.ciphers)("collections",t.collections)("allCollections",t.allCollections)("allOrganizations",t.organization?g.VKq(33,Jn,t.organization):g.DdM(35,Yn))("allGroups",t.allGroups)("disabled",t.loading)("showOwner",!1)("showPermissionsColumn",!0)("showCollections",void 0!==t.filter.type)("showGroups",(null==t.organization?null:t.organization.useGroups)&&(void 0===t.filter.type&&void 0===t.filter.collectionId||void 0!==t.filter.collectionId))("showPremiumFeatures",null==t.organization?null:t.organization.useTotp)("showBulkMove",!1)("showBulkTrashOptions","trash"===t.filter.type)("useEvents",null==t.organization?null:t.organization.useEvents)("cloneableOrganizationCiphers",!0)("showAdminActions",!0)("showBulkEditCollectionAccess",g.lcZ(27,31,t.showBulkEditCollectionAccess$))("viewingOrgVault",!0),g.xp6(4),g.Q6J("ngIf",t.showMissingCollectionPermissionMessage),g.xp6(2),g.Q6J("ngIf",t.isEmpty&&!t.showMissingCollectionPermissionMessage&&!t.performingInitialLoad),g.xp6(2),g.Q6J("ngIf",t.performingInitialLoad))},dependencies:[Ki,m.O5,nn.O,Se.r,on.G,rn.JS,An,m.Ov,k.C],encapsulation:2});const Dn=e=>e.itemId||e.cipherId,En=[{path:"",component:Gn,canActivate:[s.G],data:{titleId:"vaults",organizationPermissions:l.Po}}];class Qn{}Qn.ɵfac=function(e){return new(e||Qn)},Qn.ɵmod=g.oAB({type:Qn}),Qn.ɵinj=g.cJS({imports:[o.Bz.forChild(En),o.Bz]});class $n{}$n.ɵfac=function(e){return new(e||$n)},$n.ɵmod=g.oAB({type:$n}),$n.ɵinj=g.cJS({imports:[Qn,Dt,mt.m,ft.f,It.x,St.e,vt.D,bt.D,gt.J,Zt.z,Ut.WK,Tt]});const Pn=[{path:":organizationId",component:V,canActivate:[(0,ht.k)(),r.a1,s.G],data:{organizationPermissions:l.gW},children:[{path:"",pathMatch:"full",canActivate:[c.S],data:{autoRedirectCallback:function(e){if((0,l.Po)(e))return"vault";if((0,l.tt)(e))return"members";if((0,l.WW)(e))return"groups";if((0,l.$G)(e))return"reporting";if((0,l.DL)(e))return"settings";return}},children:[]},{path:"vault",loadChildren:()=>$n},{path:"settings",loadChildren:()=>i.e(182).then(i.bind(i,38182)).then((e=>e.OrganizationSettingsModule))},{path:"members",loadChildren:()=>i.e(795).then(i.bind(i,59795)).then((e=>e.MembersModule))},{path:"groups",component:pt,canActivate:[s.G],data:{titleId:"groups",organizationPermissions:l.WW}},{path:"reporting",loadChildren:()=>i.e(551).then(i.bind(i,16894)).then((e=>e.OrganizationReportingModule))},{path:"billing",loadChildren:()=>Promise.all([i.e(883),i.e(946)]).then(i.bind(i,40946)).then((e=>e.OrganizationBillingModule))}]}];class Bn{}Bn.ɵfac=function(e){return new(e||Bn)},Bn.ɵmod=g.oAB({type:Bn}),Bn.ɵinj=g.cJS({imports:[o.Bz.forChild(Pn),o.Bz]});var Rn=i(64984);class Hn{}Hn.ɵfac=function(e){return new(e||Hn)},Hn.ɵmod=g.oAB({type:Hn}),Hn.ɵinj=g.cJS({imports:[Rn.P,ve.k4,n.WO,Bn]})},14309:(e,t,i)=>{i.d(t,{E2:()=>r.E2,R9:()=>n.R,XL:()=>r.XL,d4:()=>r.d4,hs:()=>r.hs,k4:()=>o.k,zD:()=>r.zD});var n=i(90054),o=i(1176),r=i(34632)},64984:(e,t,i)=>{i.d(t,{P:()=>s});var n=i(27420),o=i(98694),r=i(1176),l=i(24852);class s{}s.ɵfac=function(e){return new(e||s)},s.ɵmod=l.oAB({type:s}),s.ɵinj=l.cJS({imports:[o.m,r.k,n.t,o.m,r.k,n.t]})},53883:(e,t,i)=>{i.d(t,{Y:()=>n});class n{constructor(e){this.message=e.message,this.humanReadableMessage=e.humanReadableMessage,this.appIcon=e.appIcon,this.appName=e.appName,this.userId=e.userId,this.userName=e.userName,this.userEmail=e.userEmail,this.date=e.date,this.ip=e.ip,this.type=e.type,this.installationId=e.installationId,this.systemUser=e.systemUser,this.serviceAccountId=e.serviceAccountId}}}}]);
//# sourceMappingURL=941.b4347f9868520a6545b3.js.map