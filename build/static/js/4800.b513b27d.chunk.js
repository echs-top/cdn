"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[4800,8058],{8653:(e,t,i)=>{i.r(t),i.d(t,{default:()=>m});var s=i(12162),n=i(69805),l=i(18666),a=i(98496),r=i(10428),o=i(45558),d=i(28093),c=i(32563),u=i(27768),v=i(49450);const m=({itemData:e,objectType:t,curFilter:i,approveCallback:m})=>{const{t:x}=(0,a.B)("translation",{keyPrefix:"page_review"}),[f,h]=(0,s.useState)(!1),[g,p]=(0,s.useState)(!1),_=(0,d.TS)(m),j=(0,d.dj)(),y=(0,c.T5)("delete"),b=()=>{p(!g)},k=()=>{const i={operation_type:"delete_post",flag_id:String(null===e||void 0===e?void 0:e.flag_id),captcha_code:void 0,captcha_id:void 0};null===y||void 0===y||y.resolveCaptchaReq(i),delete i.captcha_code,delete i.captcha_id,(0,o.gI)(i).then((async()=>{await(null===y||void 0===y?void 0:y.close());let e="";"question"===t&&(e=x("post_deleted",{keyPrefix:"messages"})),"answer"===t&&(e=x("tip_answer_deleted")),"answer"!==t&&"question"!==t||j.onShow({msg:e,variant:"success"}),m()})).catch((e=>{e.isError&&(null===y||void 0===y||y.handleCaptchaError(e.list))})).finally((()=>{h(!1)}))},w=i=>{if("delete"===i&&(()=>{let i="";h(!0),"question"===t&&(i=Number(null===e||void 0===e?void 0:e.answer_count)>0?x("question",{keyPrefix:"delete"}):x("other",{keyPrefix:"delete"})),"answer"===t&&(i=null!==e&&void 0!==e&&e.answer_accepted?x("answer_accepted",{keyPrefix:"delete"}):x("other",{keyPrefix:"delete"})),"comment"===t&&(i=x("other",{keyPrefix:"delete"})),r.aF.confirm({title:x("title",{keyPrefix:"delete"}),content:i,cancelBtnVariant:"link",confirmBtnVariant:"danger",confirmText:x("delete",{keyPrefix:"btns"}),onConfirm:()=>{y?y.check((()=>k())):k()},onCancel:()=>{h(!1)}})})(),"close"===i&&_.onShow({type:"question",id:(null===e||void 0===e?void 0:e.flag_id)||"",action:"close",source:"review",content:null===e||void 0===e?void 0:e.reason_content,reportType:(null===e||void 0===e?void 0:e.reason.reason_type)||-1}),"unlist"===i){const t="question_detail.unlist";r.aF.confirm({title:x("title",{keyPrefix:t}),content:x("content",{keyPrefix:t}),cancelBtnVariant:"link",confirmText:x("confirm_btn",{keyPrefix:t}),onConfirm:()=>{(0,o.gI)({operation_type:"unlist_post",flag_id:(null===e||void 0===e?void 0:e.flag_id)||""}).then((()=>{j.onShow({msg:x(`post_${i}`,{keyPrefix:"messages"}),variant:"success"}),m()}))}})}};return(0,v.jsxs)("div",{children:[(0,v.jsxs)(n.A,{children:[(0,v.jsx)(n.A.Toggle,{as:l.A,disabled:f,variant:"outline-primary",id:"dropdown-basic",children:x("approve",{keyPrefix:"btns"})}),(0,v.jsxs)(n.A.Menu,{children:[(0,v.jsx)(n.A.Item,{onClick:()=>{b()},children:x("edit_post")}),"normal"===i&&"question"===t&&(0,v.jsx)(n.A.Item,{onClick:()=>w("close"),children:x("close",{keyPrefix:"btns"})}),"deleted"!==i&&(0,v.jsx)(n.A.Item,{onClick:()=>w("delete"),children:x("delete",{keyPrefix:"btns"})}),"question"===t&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n.A.Divider,{}),2!==(null===e||void 0===e?void 0:e.object_show_status)&&(0,v.jsx)(n.A.Item,{onClick:()=>w("unlist"),children:x("unlist_post")})]})]})]}),(0,v.jsx)(u.default,{visible:g,handleClose:b,objectType:t,originalData:{flag_id:(null===e||void 0===e?void 0:e.flag_id)||"",id:(null===e||void 0===e?void 0:e.object_id)||"",title:(null===e||void 0===e?void 0:e.title)||"",content:(null===e||void 0===e?void 0:e.original_text)||"",tags:(null===e||void 0===e?void 0:e.tags)||[],question_id:(null===e||void 0===e?void 0:e.question_id)||"",answer_id:(null===e||void 0===e?void 0:e.answer_id)||""},callback:m})]})}},27768:(e,t,i)=>{i.r(t),i.d(t,{default:()=>g});var s=i(12162),n=i(53652),l=i(14592),a=i(18666),r=i(98496),o=i(59660),d=i.n(o),c=i(45558),u=i(28093),v=i(32563),m=i(10428),x=i(93090),f=(i(70310),i(49450));const h={title:{value:"",isInvalid:!1,errorMsg:""},tags:{value:[],isInvalid:!1,errorMsg:""},content:{value:"",isInvalid:!1,errorMsg:""}},g=({originalData:e,visible:t=!1,objectType:i,handleClose:o,callback:g})=>{const{t:p}=(0,r.B)("translation",{keyPrefix:"ask"}),[_,j]=(0,s.useState)(h),[y,b]=(0,s.useState)(!1),[k,w]=(0,s.useState)(!1),A=(0,u.L7)(),I=(0,v.T5)("edit"),N=e=>{e&&(null===g||void 0===g||g()),j(h),o(),w(!1)},C=e=>{k&&j({..._,...e})},P=()=>{const t={title:_.title.value,content:_.content.value,tags:_.tags.value,operation_type:"edit_post",flag_id:e.flag_id};if("answer"===i&&(delete t.title,delete t.tags),"comment"===i){const{value:e}=_.content,i=(0,x.by)(e);t.content=i,delete t.title,delete t.tags}if("question"===i){const e=null===I||void 0===I?void 0:I.getCaptcha();null!==e&&void 0!==e&&e.verify&&(t.captcha_code=e.captcha_code,t.captcha_id=e.captcha_id)}(0,c.gI)(t).then((async()=>{await(null===I||void 0===I?void 0:I.close()),N(!0)})).catch((e=>{if(e.isError){null===I||void 0===I||I.handleCaptchaError(e.list);const t=(0,x.NC)(e,_);j({...t});const i=document.getElementById(e.list[0].error_field);(0,x.qt)(i)}}))};return(0,s.useEffect)((()=>{t&&(_.title.value=e.title,_.content.value=e.content,_.tags.value=e.tags.map((e=>({...e,parsed_text:"",original_text:""}))),j({..._}),w(!0))}),[t]),(0,f.jsxs)(n.A,{show:t,onHide:()=>N(!1),className:"w-100",dialogClassName:"edit-post-modal",children:[(0,f.jsx)(n.A.Header,{closeButton:!0,children:(0,f.jsx)(n.A.Title,{children:p("edit_post",{keyPrefix:"page_review"})})}),(0,f.jsxs)(l.A,{noValidate:!0,onSubmit:e=>{e.preventDefault(),e.stopPropagation(),(()=>{let e=!0;const{title:t,tags:s,content:n}=_;if("question"===i&&(t.value||(e=!1,_.title={value:t.value,isInvalid:!0,errorMsg:p("form.fields.title.msg.empty",{keyPrefix:"ask"})}),s.value.length||(e=!1,_.tags={value:s.value,isInvalid:!0,errorMsg:p("form.fields.tags.msg.empty",{keyPrefix:"ask"})})),!n.value||Array.from(n.value.trim()).length<6?(e=!1,_.content={value:n.value,isInvalid:!0,errorMsg:p("form.fields.answer.feedback.characters",{keyPrefix:"edit_answer"})}):_.content={value:n.value,isInvalid:!1,errorMsg:""},j({..._}),!e){const e=Object.keys(_).filter((e=>_[e].isInvalid)),t=document.getElementById(e[0]);(0,x.qt)(t)}return e})()&&(I?I.check((()=>P())):P())},children:[(0,f.jsxs)(n.A.Body,{children:["question"===i&&(0,f.jsxs)(l.A.Group,{controlId:"title",className:"mb-3",children:[(0,f.jsx)(l.A.Label,{children:p("form.fields.title.label")}),(0,f.jsx)(l.A.Control,{type:"text",value:_.title.value,isInvalid:_.title.isInvalid,onChange:e=>{C({title:{value:e.target.value,isInvalid:!1,errorMsg:""}})},placeholder:p("form.fields.title.placeholder"),autoFocus:!0,contentEditable:!0}),(0,f.jsx)(l.A.Control.Feedback,{type:"invalid",children:_.title.errorMsg})]}),"comment"!==i&&(0,f.jsxs)(l.A.Group,{controlId:"body",children:[(0,f.jsx)(l.A.Label,{children:p("question"===i?"form.fields.body.label":"form.fields.answer.label")}),(0,f.jsx)(l.A.Control,{defaultValue:_.content.value,isInvalid:_.content.isInvalid,hidden:!0}),(0,f.jsx)(m.KE,{value:_.content.value,onChange:e=>{C({content:{value:e,errorMsg:"",isInvalid:!1}})},className:d()("form-control p-0",y?"focus":""),onFocus:()=>{b(!0)},onBlur:()=>{b(!1)}}),(0,f.jsx)(l.A.Control.Feedback,{type:"invalid",children:_.content.errorMsg})]}),"question"===i&&(0,f.jsxs)(l.A.Group,{controlId:"tags",className:"my-3",children:[(0,f.jsx)(l.A.Label,{children:p("form.fields.tags.label")}),(0,f.jsx)(m.Cx,{value:_.tags.value,onChange:e=>{C({tags:{value:e,errorMsg:"",isInvalid:!1}})},showRequiredTag:!0,maxTagLength:5,isInvalid:_.tags.isInvalid,errMsg:_.tags.errorMsg})]}),"comment"===i&&(0,f.jsxs)("div",{className:"w-100",children:[(0,f.jsxs)("div",{className:d()("custom-form-control",{"is-invalid":_.content.isInvalid}),children:[(0,f.jsx)(l.A.Label,{children:"Comment"}),(0,f.jsx)(m.MW,{pageUsers:A.getUsers(),onSelected:e=>{k&&j({..._,content:{value:e,errorMsg:"",isInvalid:!1}})},children:(0,f.jsx)(m.fs,{size:"sm",rows:4,value:(0,x.$t)(_.content.value),onChange:e=>{C({content:{value:e.target.value,errorMsg:"",isInvalid:!1}})}})})]}),(0,f.jsx)(l.A.Control.Feedback,{type:"invalid",children:_.content.errorMsg})]})]}),(0,f.jsxs)(n.A.Footer,{children:[(0,f.jsx)(a.A,{variant:"secondary",onClick:()=>N(!1),children:p("close",{keyPrefix:"btns"})}),(0,f.jsx)(a.A,{variant:"primary",type:"submit",children:p("submit",{keyPrefix:"btns"})})]})]})]})}},64800:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var s=i(12162),n=i(84873),l=i(68442),a=i(63962),r=i(18666),o=i(98496),d=i(85940),c=i(59660),u=i.n(c),v=i(45558),m=i(10428),x=i(93090),f=i(91374),h=i(8653),g=i(98058),p=i(49450);const _=({refreshCount:e})=>{var t,i,c,_,j;const{t:y}=(0,o.B)("translation",{keyPrefix:"page_review"}),b=(0,s.useRef)(null),[k,w]=(0,s.useState)(!1),[A,I]=(0,s.useState)(!1),[N,C]=(0,s.useState)(1),[P,q]=(0,s.useState)(),S=null===P||void 0===P?void 0:P.list[0],T=e=>{(0,v.Vf)(e).then((t=>{((e,t)=>{const{count:i,list:s=[]}=e;if(!s.length&&i&&1!==N)return C(t=1),void T(t);t!==N&&C(t),q(e),s.length||w(!0),setTimeout((()=>{(0,x.Mv)()}),150)})(t,e)})).catch((e=>{console.error("review next error: ",e)}))};(0,s.useEffect)((()=>{T(N)}),[]);(0,s.useEffect)((()=>{b.current&&setTimeout((()=>{(0,m._A)(b.current,{copySuccessText:y("copied",{keyPrefix:"messages"}),copyText:y("copy",{keyPrefix:"messages"})})}),70)}),[b.current]);const{object_type:M,submitter_user:L,author_user_info:F,object_status:E,reason:B}=S||{object_type:"",submitter_user:null,author_user_info:null,reason:null,object_status:0},{itemLink:H,itemId:$,itemTimePrefix:D}=(0,g.default)(S);return k?null:(0,p.jsxs)(n.A,{children:[(0,p.jsx)(n.A.Header,{children:y("user"!==M?"flag_post":"flag_user")}),(0,p.jsxs)(n.A.Body,{className:"p-0",children:[(0,p.jsxs)(l.A,{variant:"info",className:"border-0 rounded-0 mb-0",children:[(0,p.jsxs)(a.A,{direction:"horizontal",gap:1,className:"align-items-center mb-2",children:[(0,p.jsx)(m.fZ,{data:L,avatarSize:"24px",avatarClass:"me-2"}),(null===S||void 0===S?void 0:S.submit_at)&&(0,p.jsx)(m.H0,{time:S.submit_at,className:"small text-secondary",preFix:y("proposed")})]}),(0,p.jsx)(a.A,{className:"align-items-start",children:(0,p.jsxs)("p",{className:"mb-0",children:[y("user"!==M?"flag_post_type":"flag_user_type",{type:null===B||void 0===B?void 0:B.name}),(null===S||void 0===S?void 0:S.reason_content)&&(null===B||void 0===B?void 0:B.content_type)&&(60!==(null===B||void 0===B?void 0:B.reason_type)?(0,p.jsxs)("span",{children:[" ",null===S||void 0===S?void 0:S.reason_content]}):null!==(t=S.reason_content)&&void 0!==t&&t.startsWith("http")?(0,p.jsx)("a",{href:S.reason_content,target:"_blank",className:"alert-exist",rel:"noreferrer",children:(0,p.jsxs)("strong",{children:[" ",y("show_exist",{keyPrefix:"question_detail"})]})}):(0,p.jsxs)("strong",{children:[" ",null===S||void 0===S?void 0:S.reason_content]}))]})})]}),(0,p.jsxs)("div",{className:"p-3",children:[(0,p.jsxs)("small",{className:"d-block text-secondary mb-4",children:[(0,p.jsxs)("span",{children:[y(M,{keyPrefix:"btns"})," "]}),(0,p.jsxs)(d.N_,{to:H,target:"_blank",className:"link-secondary",children:["#",$]})]}),"question"===M&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h5",{className:"mb-3",children:null===S||void 0===S?void 0:S.title}),(0,p.jsx)("div",{className:"mb-4",children:null===S||void 0===S||null===(i=S.tags)||void 0===i?void 0:i.map((e=>(0,p.jsx)(m.vw,{className:"me-1",data:e},e.slug_name)))})]}),(0,p.jsx)("div",{className:"small font-monospace",children:(0,p.jsx)(m.EQ,{children:(0,p.jsx)("article",{ref:b,className:"fmt text-break text-wrap",dangerouslySetInnerHTML:{__html:null===S||void 0===S?void 0:S.parsed_text}})})}),(0,p.jsxs)("div",{className:"d-flex flex-wrap align-items-center justify-content-between mt-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{className:u()("badge",null===(c=f.__[E])||void 0===c?void 0:c.variant),children:y(null===(_=f.__[E])||void 0===_?void 0:_.name,{keyPrefix:"btns"})}),2===(null===S||void 0===S?void 0:S.object_show_status)&&(0,p.jsx)("span",{className:u()("ms-1 badge",f.__.unlisted.variant),children:y(f.__.unlisted.name,{keyPrefix:"btns"})})]}),(0,p.jsxs)("div",{className:"d-flex align-items-center small",children:[(0,p.jsx)(m.fZ,{data:F,avatarSize:"24px",avatarClass:"me-2"}),(0,p.jsx)(m.H0,{time:Number(null===S||void 0===S?void 0:S.created_at),className:"text-secondary ms-1 flex-shrink-0",preFix:y(D,{keyPrefix:"question_detail"})})]})]})]})]}),(0,p.jsxs)(n.A.Footer,{className:"p-3",children:[(0,p.jsx)("p",{children:y("approve_flag_tip")}),(0,p.jsxs)(a.A,{direction:"horizontal",gap:2,children:[(0,p.jsx)(h.default,{objectType:M,itemData:S,curFilter:null===(j=f.__[E])||void 0===j?void 0:j.name,approveCallback:()=>{S&&(e(),T(N))}}),(0,p.jsx)(r.A,{variant:"outline-primary",disabled:A,onClick:()=>{I(!0),(0,v.gI)({operation_type:"ignore_report",flag_id:String(null===S||void 0===S?void 0:S.flag_id)}).then((()=>{e(),T(N)})).finally((()=>{I(!1)}))},children:y("ignore",{keyPrefix:"btns"})}),(0,p.jsx)(r.A,{variant:"outline-primary",disabled:A,onClick:()=>{T(N+1)},children:y("skip",{keyPrefix:"btns"})})]})]})]})}},98058:(e,t,i)=>{i.r(t),i.d(t,{default:()=>n});var s=i(91408);const n=e=>{if(null===e||void 0===e||!e.object_id)return{itemLink:"",itemId:"",itemTimePrefix:""};const{object_type:t="",object_id:i="",question_id:n="",answer_id:l="",comment_id:a="",url_title:r=""}=e;let o="",d="",c="";return"question"===t?(o=s.w.questionLanding(String(i),r),d=String(n),c="asked"):"answer"===t?(o=s.w.answerLanding({questionId:n,slugTitle:r,answerId:String(i)}),d=String(i),c="answered"):"comment"===t&&(o=n&&l?`${s.w.answerLanding({questionId:n,slugTitle:r,answerId:l})}?commentId=${a}`:`${s.w.questionLanding(String(n),r)}?commentId=${a}`,d=String(a),c="commented"),{itemLink:o,itemId:d,itemTimePrefix:c}}},68442:(e,t,i)=>{i.d(t,{A:()=>j});var s=i(59660),n=i.n(s),l=i(12162),a=i(18525),r=i(1921),o=i(42700),d=i(46024),c=i(49450);const u=(0,d.A)("h4");u.displayName="DivStyledAsH4";const v=l.forwardRef((({className:e,bsPrefix:t,as:i=u,...s},l)=>(t=(0,o.oU)(t,"alert-heading"),(0,c.jsx)(i,{ref:l,className:n()(e,t),...s}))));v.displayName="AlertHeading";const m=v;var x=i(41055);const f=l.forwardRef((({className:e,bsPrefix:t,as:i=x.A,...s},l)=>(t=(0,o.oU)(t,"alert-link"),(0,c.jsx)(i,{ref:l,className:n()(e,t),...s}))));f.displayName="AlertLink";const h=f;var g=i(70200),p=i(4576);const _=l.forwardRef(((e,t)=>{const{bsPrefix:i,show:s=!0,closeLabel:l="Close alert",closeVariant:d,className:u,children:v,variant:m="primary",onClose:x,dismissible:f,transition:h=g.A,..._}=(0,a.Zw)(e,{show:"onClose"}),j=(0,o.oU)(i,"alert"),y=(0,r.A)((e=>{x&&x(!1,e)})),b=!0===h?g.A:h,k=(0,c.jsxs)("div",{role:"alert",...b?void 0:_,ref:t,className:n()(u,j,m&&`${j}-${m}`,f&&`${j}-dismissible`),children:[f&&(0,c.jsx)(p.A,{onClick:y,"aria-label":l,variant:d}),v]});return b?(0,c.jsx)(b,{unmountOnExit:!0,..._,ref:void 0,in:s,children:k}):s?k:null}));_.displayName="Alert";const j=Object.assign(_,{Link:h,Heading:m})},70310:(e,t,i)=>{i.r(t),i.d(t,{default:()=>s});const s={}}}]);
//# sourceMappingURL=4800.b513b27d.chunk.js.map