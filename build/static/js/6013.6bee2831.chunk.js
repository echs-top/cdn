"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[6013,9403],{76013:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s=n(12162),l=n(98128),a=n(8810),i=n(14592),o=n(18666),r=n(84873),c=n(85940),d=n(98496),u=n(71115),v=n.n(u),m=n(59660),h=n.n(m),f=n(93090),p=n(28093),x=n(32563),g=n(91408),_=n(10428),j=n(45558),y=(n(29403),n(49450));const w=()=>{var e,t;const{aid:n="",qid:u=""}=(0,c.g)(),[m,w]=(0,s.useState)(""),{t:b}=(0,d.B)("translation",{keyPrefix:"edit_answer"}),A=(0,c.Zp)(),N={content:{value:"",isInvalid:!1,errorMsg:""},description:{value:"",isInvalid:!1,errorMsg:""}},{data:k}=(0,j.gy)(n),[I,C]=(0,s.useState)(N),[q,M]=(0,s.useState)(N),[P,S]=(0,s.useState)(!1),T=(0,x.T5)("edit");(0,s.useEffect)((()=>{var e;null!==k&&void 0!==k&&null!==(e=k.info)&&void 0!==e&&e.content&&C({...I,content:{value:k.info.content,isInvalid:!1,errorMsg:""}})}),[null===k||void 0===k||null===(e=k.info)||void 0===e?void 0:e.content]);const{data:$=[]}=(0,j.Of)(n),E=(0,s.useRef)({getHtml:()=>""}),H=(0,s.useRef)(null);(0,x.e9)(H.current),(0,s.useEffect)((()=>{null!==H&&void 0!==H&&H.current&&(0,_._A)(H.current,{copySuccessText:b("copied",{keyPrefix:"messages"}),copyText:b("copy",{keyPrefix:"messages"})})}),[H]),(0,p.XB)({when:P}),(0,s.useEffect)((()=>{const{content:e,description:t}=I;q.content.value!==e.value||t.value?S(!0):S(!1)}),[I.content.value,I.description.value]);const L=()=>{const e={content:I.content.value,html:E.current.getHtml(),question_id:u,id:n,edit_summary:I.description.value};null===T||void 0===T||T.resolveCaptchaReq(e),(0,j.lw)(e).then((async e=>{var t;await(null===T||void 0===T?void 0:T.close()),A(g.w.answerLanding({questionId:u,slugTitle:null===k||void 0===k||null===(t=k.question)||void 0===t?void 0:t.url_title,answerId:n}),{state:{isReview:null===e||void 0===e?void 0:e.wait_for_review}})})).catch((e=>{if(e.isError){null===T||void 0===T||T.handleCaptchaError(e.list);const t=(0,f.NC)(e,I);C({...t})}}))};return(0,p.M4)({title:b("edit_answer",{keyPrefix:"page_title"})}),(0,y.jsxs)("div",{className:"pt-4 mb-5 edit-answer-wrap",children:[(0,y.jsx)("h3",{className:"mb-4",children:b("title")}),(0,y.jsxs)(l.A,{children:[(0,y.jsxs)(a.A,{className:"page-main flex-auto",children:[(0,y.jsx)(c.N_,{to:g.w.questionLanding(u,null===k||void 0===k?void 0:k.question.url_title),target:"_blank",rel:"noreferrer",children:(0,y.jsx)("h5",{className:"mb-3",children:null===k||void 0===k?void 0:k.question.title})}),(0,y.jsxs)("div",{className:"question-content-wrap",children:[(0,y.jsx)("div",{ref:H,className:"content position-absolute top-0 w-100",dangerouslySetInnerHTML:{__html:null===k||void 0===k?void 0:k.question.html}}),(0,y.jsx)("div",{className:"resize-bottom",style:{maxHeight:null===H||void 0===H||null===(t=H.current)||void 0===t?void 0:t.scrollHeight}}),(0,y.jsx)("div",{className:"line bg-light  d-flex justify-content-center align-items-center",children:(0,y.jsx)(_.In,{type:"bi",name:"grip-horizontal",className:"mt-1"})})]}),(0,y.jsxs)(i.A,{noValidate:!0,onSubmit:async e=>{S(!1),e.preventDefault(),e.stopPropagation(),(()=>{let e=!0;const{content:t}=I;return!t.value||Array.from(t.value.trim()).length<6?(e=!1,I.content={value:t.value,isInvalid:!0,errorMsg:b("form.fields.answer.feedback.characters")}):I.content={value:t.value,isInvalid:!1,errorMsg:""},C({...I}),e})()&&(T?T.check((()=>L())):L())},children:[(0,y.jsxs)(i.A.Group,{controlId:"revision",className:"mb-3",children:[(0,y.jsx)(i.A.Label,{children:b("form.fields.revision.label")}),(0,y.jsx)(i.A.Select,{onChange:e=>{const t=e.target.value,n=$[t];null!==n&&void 0!==n&&n.content&&(I.content.value=n.content.content,M({...I}),C({...I}))},defaultValue:0,children:$.map((({create_at:e,reason:t,user_info:n},s)=>{const l=v()(1e3*e).tz().format(b("long_date_with_time",{keyPrefix:"dates"}));return(0,y.jsx)("option",{value:s,children:`${l} - ${n.display_name} - ${t||(s===$.length-1?b("default_first_reason"):b("default_reason"))}`},`${e}`)}))})]}),(0,y.jsxs)(i.A.Group,{controlId:"answer",className:"mt-3",children:[(0,y.jsx)(i.A.Label,{children:b("form.fields.answer.label")}),(0,y.jsx)(_.KE,{value:I.content.value,onChange:e=>C({...I,content:{...I.content,value:e}}),className:h()("form-control p-0","answer"===m&&"focus"),onFocus:()=>{w("answer")},onBlur:()=>{w("")},ref:E}),(0,y.jsx)(i.A.Control,{value:I.content.value,type:"text",isInvalid:I.content.isInvalid,readOnly:!0,hidden:!0}),(0,y.jsx)(i.A.Control.Feedback,{type:"invalid",children:I.content.errorMsg})]}),(0,y.jsxs)(i.A.Group,{controlId:"edit_summary",className:"my-3",children:[(0,y.jsx)(i.A.Label,{children:b("form.fields.edit_summary.label")}),(0,y.jsx)(i.A.Control,{type:"text",onChange:e=>{const t=e.currentTarget.value;C({...I,description:{...I.description,value:t}})},defaultValue:I.description.value,isInvalid:I.description.isInvalid,placeholder:b("form.fields.edit_summary.placeholder"),contentEditable:!0}),(0,y.jsx)(i.A.Control.Feedback,{type:"invalid",children:I.description.errorMsg})]}),(0,y.jsxs)("div",{className:"mt-3",children:[(0,y.jsx)(o.A,{type:"submit",className:"me-2",children:b("btn_save_edits")}),(0,y.jsx)(o.A,{variant:"link",onClick:()=>{A(-1)},children:b("btn_cancel")})]})]})]}),(0,y.jsx)(a.A,{className:"page-right-side mt-4 mt-xl-0",children:(0,y.jsxs)(r.A,{children:[(0,y.jsx)(r.A.Header,{children:b("title",{keyPrefix:"how_to_format"})}),(0,y.jsx)(r.A.Body,{className:"fmt small",dangerouslySetInnerHTML:{__html:b("desc",{keyPrefix:"how_to_format"})}})]})})]})]})}},98128:(e,t,n)=>{n.d(t,{A:()=>c});var s=n(59660),l=n.n(s),a=n(12162),i=n(42700),o=n(49450);const r=a.forwardRef((({bsPrefix:e,className:t,as:n="div",...s},a)=>{const r=(0,i.oU)(e,"row"),c=(0,i.gy)(),d=(0,i.Jm)(),u=`${r}-cols`,v=[];return c.forEach((e=>{const t=s[e];let n;delete s[e],null!=t&&"object"===typeof t?({cols:n}=t):n=t;const l=e!==d?`-${e}`:"";null!=n&&v.push(`${u}${l}-${n}`)})),(0,o.jsx)(n,{ref:a,...s,className:l()(t,r,...v)})}));r.displayName="Row";const c=r},29403:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});const s={}}}]);
//# sourceMappingURL=6013.6bee2831.chunk.js.map