"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[2699,7352,7639,7739],{37639:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var n=t(69805),r=t(98496),l=t(10428),a=t(28093),d=t(45558),i=t(59304),o=t(49450);const c=({showActionPassword:e,showActionStatus:s,showActionRole:t,currentUser:c,refreshUsers:u,showDeleteModal:h,userData:x,showSuspenseModal:m})=>{const{t:v}=(0,r.B)("translation",{keyPrefix:"admin.users"}),p=(0,a.dj)(),j=(0,a.Qt)({callback:()=>{p.onShow({msg:v("change_user_role",{keyPrefix:"messages"}),variant:"success"}),null===u||void 0===u||u()}}),f=(0,a.Ye)({onConfirm:e=>new Promise(((s,t)=>{(0,d.ej)(e).then((()=>{p.onShow({msg:v("update_password",{keyPrefix:"toast"}),variant:"success"}),s(!0)})).catch((e=>{t(e)}))}))}),_=(0,a.Io)({onConfirm:e=>new Promise(((s,t)=>{(0,d.eg)(e).then((()=>{p.onShow({msg:v("edit_success",{keyPrefix:"admin.edit_profile_modal"}),variant:"success"}),s(!0),null===u||void 0===u||u()})).catch((e=>{t(e)}))}))},x),w=(0,a.vx)(),g=e=>{(0,d.e8)({user_id:x.user_id,status:e}).then((()=>{i.ZW.getState().show({msg:v(`user_${e}`,{keyPrefix:"messages"}),variant:"success"}),null===u||void 0===u||u()}))},b=e=>{const{user_id:s,role_id:t,username:n}=x;n!==c.username?("role"===e&&j.onShow({id:s,role_id:t}),"password"===e&&f.onShow(s),"profile"===e&&_.onShow(s),"activation"===e&&w.onShow(s),"deactivate"===e&&l.aF.confirm({title:v("deactivate_user.title"),content:v("deactivate_user.content"),cancelBtnVariant:"link",confirmBtnVariant:"danger",cancelText:v("cancel",{keyPrefix:"btns"}),confirmText:v("deactivate",{keyPrefix:"btns"}),onConfirm:()=>{g("inactive")}}),"suspend"===e&&m({show:!0,userId:x.user_id}),"active"!==e&&"unsuspend"!==e||g("normal"),"delete"===e&&h({show:!0,userId:x.user_id})):p.onShow({msg:v("forbidden_operate_self",{keyPrefix:"toast"}),variant:"warning"})};return(0,o.jsx)("td",{className:"text-end",children:(0,o.jsxs)(n.A,{children:[(0,o.jsx)(n.A.Toggle,{variant:"link",className:"no-toggle p-0",children:(0,o.jsx)(l.In,{name:"three-dots-vertical",title:v("action")})}),(0,o.jsxs)(n.A.Menu,{align:"end",children:[e?(0,o.jsx)(n.A.Item,{onClick:()=>b("password"),children:v("set_new_password")}):null,(0,o.jsx)(n.A.Item,{onClick:()=>b("profile"),children:v("edit_profile")}),t?(0,o.jsx)(n.A.Item,{onClick:()=>b("role"),children:v("change_role")}):null,"inactive"===x.status?(0,o.jsx)(n.A.Item,{onClick:()=>b("activation"),children:v("btn_name",{keyPrefix:"inactive"})}):null,s&&"deleted"!==x.status?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.A.Divider,{}),"inactive"===x.status&&(0,o.jsx)(n.A.Item,{onClick:()=>b("active"),children:v("active",{keyPrefix:"btns"})}),"normal"===x.status&&(0,o.jsx)(n.A.Item,{onClick:()=>b("deactivate"),children:v("deactivate",{keyPrefix:"btns"})}),"normal"===x.status&&(0,o.jsx)(n.A.Item,{onClick:()=>b("suspend"),children:v("suspend",{keyPrefix:"btns"})}),"suspended"===x.status&&(0,o.jsx)(n.A.Item,{onClick:()=>b("unsuspend"),children:v("unsuspend",{keyPrefix:"btns"})}),(0,o.jsx)(n.A.Item,{onClick:()=>b("delete"),children:v("delete",{keyPrefix:"btns"})})]}):null]})]})})}},87352:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var n=t(12162),r=t(53652),l=t(14592),a=t(18666),d=t(98496),i=t(49450);const o=({show:e,onClose:s,onDelete:t})=>{const{t:o}=(0,d.B)("translation",{keyPrefix:"admin.users"}),[c,u]=(0,n.useState)(!1),h=()=>{s(),u(!1)};return(0,i.jsxs)(r.A,{show:e,onHide:h,children:[(0,i.jsx)(r.A.Header,{closeButton:!0,children:(0,i.jsx)(r.A.Title,{children:o("delete_user.title")})}),(0,i.jsxs)(r.A.Body,{children:[(0,i.jsx)("p",{children:o("delete_user.content")}),(0,i.jsxs)("div",{className:"text-danger mb-2",children:[o("delete_user.remove")," ",o("optional",{keyPrefix:"form"})]}),(0,i.jsx)(l.A,{children:(0,i.jsx)(l.A.Group,{controlId:"delete_user",children:(0,i.jsxs)(l.A.Check,{type:"checkbox",id:"delete_user",children:[(0,i.jsx)(l.A.Check.Input,{type:"checkbox",checked:c,onChange:e=>{u(e.target.checked)}}),(0,i.jsxs)(l.A.Check.Label,{htmlFor:"delete_user",children:[(0,i.jsx)("span",{children:o("delete_user.label")}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"small text-secondary",children:o("delete_user.text")})]})]})})})]}),(0,i.jsxs)(r.A.Footer,{children:[(0,i.jsx)(a.A,{variant:"link",onClick:h,children:o("cancel",{keyPrefix:"btns"})}),(0,i.jsx)(a.A,{variant:"danger",onClick:()=>t(c),children:o("delete",{keyPrefix:"btns"})})]})]})}},87739:(e,s,t)=>{t.r(s),t.d(s,{default:()=>h});var n=t(12162),r=t(53652),l=t(14592),a=t(18666),d=t(98496),i=t(45558),o=t(91374),c=t(59304),u=t(49450);const h=({show:e,userId:s,onClose:t,refreshUsers:h})=>{const{t:x}=(0,d.B)("translation",{keyPrefix:"admin.users"}),[m,v]=(0,n.useState)("forever"),p=()=>{t(),v("forever")};return(0,u.jsxs)(r.A,{show:e,onHide:p,children:[(0,u.jsx)(r.A.Header,{closeButton:!0,children:(0,u.jsx)(r.A.Title,{children:x("suspend_user.title")})}),(0,u.jsxs)(r.A.Body,{children:[(0,u.jsx)("p",{children:x("suspend_user.content")}),(0,u.jsx)(l.A,{children:(0,u.jsxs)(l.A.Group,{controlId:"delete_user",className:"mb-3",children:[(0,u.jsx)(l.A.Label,{children:x("suspend_user.label")}),(0,u.jsxs)(l.A.Select,{value:m,onChange:e=>v(e.target.value),children:[(0,u.jsx)("option",{value:"forever",children:x("suspend_user.forever")}),o.V7.map((e=>(0,u.jsxs)("option",{value:e.value,children:[e.time," ",x(e.label,{keyPrefix:"dates"})]},e.value)))]})]})})]}),(0,u.jsxs)(r.A.Footer,{children:[(0,u.jsx)(a.A,{variant:"link",onClick:p,children:x("cancel",{keyPrefix:"btns"})}),(0,u.jsx)(a.A,{variant:"danger",onClick:e=>{e.preventDefault(),(0,i.e8)({user_id:s,status:"suspended",suspend_duration:m}).then((()=>{c.ZW.getState().show({msg:x("user_suspended",{keyPrefix:"messages"}),variant:"success"}),null===h||void 0===h||h(),p()}))},children:x("suspend",{keyPrefix:"btns"})})]})]})}},42699:(e,s,t)=>{t.r(s),t.d(s,{default:()=>A});var n=t(12162),r=t(63962),l=t(18666),a=t(14592),d=t(27396),i=t(85940),o=t(98496),c=t(59660),u=t.n(c),h=t(71115),x=t.n(h),m=t(10428),v=t(28093),p=t(59304),j=t(45558),f=t(93090),_=t(87352),w=t(37639),g=t(87739),b=t(49450);const k=["normal","staff","inactive","suspended","deleted"],y={normal:"text-bg-success",suspended:"text-bg-danger",deleted:"text-bg-danger",inactive:"text-bg-secondary"},A=()=>{const{t:e}=(0,o.B)("translation",{keyPrefix:"admin.users"}),[s,t]=(0,n.useState)({show:!1,userId:""}),[c,h]=(0,n.useState)({show:!1,userId:""}),[A,P]=(0,i.ok)(),C=A.get("filter")||k[0],N=Number(A.get("page")||"1"),S=A.get("query")||"",I=(0,p.bb)((e=>e.user)),{agent:$}=(0,p.ym)(),[B,z]=(0,n.useState)({allow_create_user:!0,allow_update_user_status:!0,allow_update_user_password:!0,allow_update_user_role:!0}),{data:D,isLoading:F,mutate:T}=(0,j.If)({page:N,page_size:10,query:S,..."all"===C?{}:"staff"===C?{staff:!0}:{status:C}}),H=(0,v.GW)({onConfirm:e=>new Promise(((s,t)=>{(0,j.g1)(e).then((()=>{/all|staff/.test(C)&&1===N&&T(),s(!0)})).catch((e=>{t(e)}))}))});(0,n.useEffect)((()=>{null!==$&&void 0!==$&&$.enabled&&(0,j.hx)().then((e=>{z(e)}))}),[$]);const M=e=>{t(e)},U=e=>{h(e)},W=!(null!==$&&void 0!==$&&$.enabled)||(null===$||void 0===$?void 0:$.enabled)&&(null===B||void 0===B?void 0:B.allow_create_user),V=!(null!==$&&void 0!==$&&$.enabled)||(null===$||void 0===$?void 0:$.enabled)&&(null===B||void 0===B?void 0:B.allow_update_user_password),Y=!(null!==$&&void 0!==$&&$.enabled)||(null===$||void 0===$?void 0:$.enabled)&&(null===B||void 0===B?void 0:B.allow_update_user_role),Z=!(null!==$&&void 0!==$&&$.enabled)||(null===$||void 0===$?void 0:$.enabled)&&(null===B||void 0===B?void 0:B.allow_update_user_status),R=V||Y||Z;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h3",{className:"mb-4",children:e("title")}),(0,b.jsxs)("div",{className:"d-flex flex-wrap justify-content-between align-items-center",children:[(0,b.jsxs)(r.A,{direction:"horizontal",gap:3,className:"mb-3",children:[(0,b.jsx)(m.gu,{data:k,currentSort:C,sortKey:"filter",i18nKeyPrefix:"admin.users"}),"deleted"===C&&Number(null===D||void 0===D?void 0:D.count)>0?(0,b.jsx)(l.A,{variant:"outline-danger",size:"sm",onClick:()=>{m.aF.confirm({title:e("title",{keyPrefix:"delete_permanently"}),content:e("content",{keyPrefix:"delete_permanently"}),cancelBtnVariant:"link",confirmText:e("delete",{keyPrefix:"btns"}),confirmBtnVariant:"danger",onConfirm:()=>{(0,j.jM)("users").then((()=>{p.ZW.getState().show({msg:e("users_deleted",{keyPrefix:"messages"}),variant:"success"}),T()}))}})},children:e("deleted_permanently",{keyPrefix:"btns"})}):null,W?(0,b.jsx)(l.A,{variant:"outline-primary",size:"sm",onClick:()=>H.onShow(),children:e("add_user")}):null]}),(0,b.jsx)(a.A.Control,{size:"sm",type:"search",value:S,onChange:e=>{A.set("query",e.target.value),A.delete("page"),P(A)},placeholder:e("filter.placeholder"),style:{width:"12.25rem"},className:"mb-3"})]}),(0,b.jsxs)(d.A,{responsive:"md",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:e("name")}),(0,b.jsx)("th",{style:{width:"12%"},children:e("reputation")}),(0,b.jsx)("th",{style:{width:"15%"},className:"min-w-15",children:e("email")}),(0,b.jsx)("th",{className:"text-nowrap",style:{width:"12%"},children:e("created_at")}),("deleted"===C||"suspended"===C)&&(0,b.jsx)("th",{className:"text-nowrap",style:{width:"12%"},children:e("deleted"===C?"delete_at":"suspend_at")}),"suspended"===C&&(0,b.jsx)("th",{className:"text-nowrap",style:{width:"12%"},children:e("suspend_until")}),(0,b.jsx)("th",{style:{width:"12%"},children:e("status")}),"suspended"!==C&&"deleted"!==C&&(0,b.jsx)("th",{style:{width:"12%"},children:e("role")}),"deleted"!==C?(0,b.jsx)("th",{style:{width:"8%"},className:"text-end",children:e("action")}):null]})}),(0,b.jsx)("tbody",{className:"align-middle",children:null===D||void 0===D?void 0:D.list.map((s=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)(m.fZ,{data:s,className:"fs-6",avatarSize:"32px",avatarSearchStr:"s=48",avatarClass:"me-2",showReputation:!1,nameMaxWidth:"160px"})}),(0,b.jsx)("td",{children:(0,f.B4)(s.rank)}),(0,b.jsx)("td",{className:"text-break",children:s.e_mail}),(0,b.jsx)("td",{children:(0,b.jsx)(m.H0,{time:s.created_at})}),"suspended"===C&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("td",{className:"text-nowrap",children:(0,b.jsx)(m.H0,{time:s.suspended_at})}),(0,b.jsx)("td",{className:"text-nowrap",children:s.suspended_until<=0||Number(x()(1e3*s.suspended_until).format("YYYY"))>2099?e("suspend_user.forever"):x()(1e3*s.suspended_until).format(e("long_date_with_time",{keyPrefix:"dates"}))})]}),"deleted"===C&&(0,b.jsx)("td",{className:"text-nowrap",children:(0,b.jsx)(m.H0,{time:s.deleted_at})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:u()("badge",y[s.status]),children:e(s.status)})}),"suspended"!==C&&"deleted"!==C&&(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"badge text-bg-light",children:e(s.role_name)})}),"deleted"===C||!R&&"inactive"!==s.status?null:(0,b.jsx)(w.default,{userData:s,showActionPassword:V,showActionRole:Y,showActionStatus:Z,currentUser:I,refreshUsers:T,showDeleteModal:M,showSuspenseModal:U})]},s.user_id)))})]}),Number(null===D||void 0===D?void 0:D.count)<=0&&!F&&(0,b.jsx)(m.Sv,{}),(0,b.jsx)("div",{className:"mt-4 mb-2 d-flex justify-content-center",children:(0,b.jsx)(m.dK,{currentPage:N,totalSize:(null===D||void 0===D?void 0:D.count)||0,pageSize:10})}),(0,b.jsx)(_.default,{show:s.show,onClose:()=>{M({show:!1,userId:""})},onDelete:t=>(t=>{(0,j.e8)({user_id:s.userId,status:"deleted",remove_all_content:t}).then((()=>{p.ZW.getState().show({msg:e("user_deleted",{keyPrefix:"messages"}),variant:"success"}),M({show:!1,userId:""}),T()}))})(t)}),(0,b.jsx)(g.default,{show:c.show,userId:c.userId,onClose:()=>{U({show:!1,userId:""})},refreshUsers:T})]})}},27396:(e,s,t)=>{t.d(s,{A:()=>i});var n=t(59660),r=t.n(n),l=t(12162),a=t(42700),d=t(49450);const i=l.forwardRef((({bsPrefix:e,className:s,striped:t,bordered:n,borderless:l,hover:i,size:o,variant:c,responsive:u,...h},x)=>{const m=(0,a.oU)(e,"table"),v=r()(s,m,c&&`${m}-${c}`,o&&`${m}-${o}`,t&&`${m}-${"string"===typeof t?`striped-${t}`:"striped"}`,n&&`${m}-bordered`,l&&`${m}-borderless`,i&&`${m}-hover`),p=(0,d.jsx)("table",{...h,className:v,ref:x});if(u){let e=`${m}-responsive`;return"string"===typeof u&&(e=`${e}-${u}`),(0,d.jsx)("div",{className:e,children:p})}return p}))}}]);
//# sourceMappingURL=2699.f22135c0.chunk.js.map