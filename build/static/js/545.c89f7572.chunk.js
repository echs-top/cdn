"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[545],{30545:(e,n,s)=>{s.r(n),s.d(n,{default:()=>b});var a=s(12162),t=s(14592),i=s(68442),r=s(18666),l=s(98496),o=s(28446),c=s(85940),d=s(51780),u=s(59660),v=s.n(u),m=s(28093),h=s(32563),x=s(10428),f=s(45558),w=s(93090),g=s(91374),j=s(59304),p=s(49450);const _=new w.ZT({type:"answer"}),N=({visible:e=!1,data:n,callback:s})=>{const{t:u}=(0,l.B)("translation",{keyPrefix:"question_detail.write_answer"}),[N,b]=(0,a.useState)({content:{value:"",isInvalid:!1,errorMsg:""}}),[y,A]=(0,a.useState)(e),[k,C]=(0,a.useState)(""),[I,q]=(0,a.useState)(!1),[M,P]=(0,a.useState)(!1),[S,F]=(0,a.useState)(n.loggedUserRank<100),L=(0,h.T5)("answer"),T=(0,j.j7)((e=>e.write)),[E,K]=(0,a.useState)(!1);(0,m.XB)({when:Boolean(N.content.value)});const R=()=>{_.save.cancel(),_.remove(),P(!1)};(0,a.useEffect)((()=>{const e=w.KP.get(g.tQ);(null===e||void 0===e?void 0:e.questionId)===n.qid&&null!==e&&void 0!==e&&e.content&&(A(!0),b({content:{value:e.content,isInvalid:!1,errorMsg:""}}),P(!0)),setTimeout((()=>{K(!0)}),100)}),[]),(0,a.useEffect)((()=>{const e=w.KP.get(g.tQ),{content:s}=N;s.value?(_.save({questionId:null===n||void 0===n?void 0:n.qid,content:s.value}),P(!0)):(null===e||void 0===e?void 0:e.questionId)!==n.qid||s.value||R()}),[N.content.value]);const U=()=>{const e={question_id:null===n||void 0===n?void 0:n.qid,content:N.content.value,html:d.xI.parse(N.content.value)},a=null===L||void 0===L?void 0:L.getCaptcha();null!==a&&void 0!==a&&a.verify&&(e.captcha_code=a.captcha_code,e.captcha_id=a.captcha_id),(0,f.V_)(e).then((async e=>{await(null===L||void 0===L?void 0:L.close()),A(!1),b({content:{value:"",isInvalid:!1,errorMsg:""}}),R(),null===s||void 0===s||s(e.info)})).catch((e=>{if(e.isError){null===L||void 0===L||L.handleCaptchaError(e.list);const n=(0,w.NC)(e,N);b({...n})}}))},$=()=>{w.ah.tryNormalLogged(!0)&&(()=>{let e=!0;const{content:n}=N;return!n.value||Array.from(n.value.trim()).length<6?(e=!1,N.content={value:n.value,isInvalid:!0,errorMsg:u("characters")}):N.content={value:n.value,isInvalid:!1,errorMsg:""},b({...N}),e})()&&(L?L.check((()=>U())):U())},B=()=>{w.ah.tryNormalLogged(!0)&&(null===n||void 0===n||!n.answered||y?y?$():A(!0):x.aF.confirm({title:u("confirm_title"),content:u("confirm_info"),confirmText:u("continue"),onConfirm:()=>{A(!0)}}))};return(0,p.jsxs)(t.A,{noValidate:!0,className:"mt-4",children:[(!n.answered||y)&&(0,p.jsxs)(t.A.Group,{className:"mb-3",children:[(0,p.jsx)(t.A.Label,{children:(0,p.jsx)("h5",{children:u("title")})}),(0,p.jsx)(t.A.Control,{isInvalid:N.content.isInvalid,className:"d-none"}),!y&&!n.answered&&(0,p.jsx)("div",{className:"d-flex",children:(0,p.jsx)(x.fs,{className:"w-100",rows:8,autoFocus:!1,onFocus:e=>{w.ah.tryNormalLogged(!0)?(C("answer"),A(!0),q(!0)):e.currentTarget.blur()}})}),y&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(x.KE,{className:v()("form-control p-0","answer"===k&&"focus",N.content.isInvalid&&"is-invalid"),value:N.content.value,autoFocus:I,onChange:e=>{E&&b({content:{value:e,isInvalid:!1,errorMsg:""}})},onFocus:()=>{C("answer")},onBlur:()=>{C("")}}),(0,p.jsxs)(i.A,{variant:"warning",show:n.loggedUserRank<100&&S,onClose:()=>F(!1),dismissible:!0,className:"mt-3",children:[(0,p.jsx)("p",{children:u("tips.header_1")}),(0,p.jsxs)("ul",{children:[(0,p.jsx)("li",{children:(0,p.jsx)(o.x,{i18nKey:"question_detail.write_answer.tips.li1_1",components:{strong:(0,p.jsx)("strong",{})}})}),(0,p.jsx)("li",{children:u("tips.li1_2")})]}),(0,p.jsx)("p",{children:(0,p.jsx)(o.x,{i18nKey:"question_detail.write_answer.tips.header_2",components:{strong:(0,p.jsx)("strong",{})}})}),(0,p.jsx)("ul",{className:"mb-0",children:(0,p.jsx)("li",{children:u("tips.li2_1")})})]})]}),(0,p.jsx)(t.A.Control.Feedback,{type:"invalid",children:N.content.errorMsg})]}),n.answered&&!y?(0,p.jsx)(c.N_,{to:`/posts/${n.qid}/${n.first_answer_id}/edit`,className:"btn btn-primary",children:u("edit_answer")}):(0,p.jsx)(r.A,{onClick:B,children:u("btn_name")}),n.answered&&!y&&!T.restrict_answer&&(0,p.jsx)(r.A,{onClick:B,className:"ms-2 ",variant:"outline-primary",children:u("add_another_answer")}),M&&(0,p.jsx)(r.A,{variant:"link",className:"ms-2",onClick:()=>{window.confirm(u("discard_confirm",{keyPrefix:"draft"}))&&(R(),b({content:{value:"",isInvalid:!1,errorMsg:""}}))},children:u("discard_draft",{keyPrefix:"btns"})})]})},b=(0,a.memo)(N)},68442:(e,n,s)=>{s.d(n,{A:()=>p});var a=s(59660),t=s.n(a),i=s(12162),r=s(18525),l=s(1921),o=s(42700),c=s(46024),d=s(49450);const u=(0,c.A)("h4");u.displayName="DivStyledAsH4";const v=i.forwardRef((({className:e,bsPrefix:n,as:s=u,...a},i)=>(n=(0,o.oU)(n,"alert-heading"),(0,d.jsx)(s,{ref:i,className:t()(e,n),...a}))));v.displayName="AlertHeading";const m=v;var h=s(41055);const x=i.forwardRef((({className:e,bsPrefix:n,as:s=h.A,...a},i)=>(n=(0,o.oU)(n,"alert-link"),(0,d.jsx)(s,{ref:i,className:t()(e,n),...a}))));x.displayName="AlertLink";const f=x;var w=s(70200),g=s(4576);const j=i.forwardRef(((e,n)=>{const{bsPrefix:s,show:a=!0,closeLabel:i="Close alert",closeVariant:c,className:u,children:v,variant:m="primary",onClose:h,dismissible:x,transition:f=w.A,...j}=(0,r.Zw)(e,{show:"onClose"}),p=(0,o.oU)(s,"alert"),_=(0,l.A)((e=>{h&&h(!1,e)})),N=!0===f?w.A:f,b=(0,d.jsxs)("div",{role:"alert",...N?void 0:j,ref:n,className:t()(u,p,m&&`${p}-${m}`,x&&`${p}-dismissible`),children:[x&&(0,d.jsx)(g.A,{onClick:_,"aria-label":i,variant:c}),v]});return N?(0,d.jsx)(N,{unmountOnExit:!0,...j,ref:void 0,in:a,children:b}):a?b:null}));j.displayName="Alert";const p=Object.assign(j,{Link:f,Heading:m})}}]);
//# sourceMappingURL=545.c89f7572.chunk.js.map