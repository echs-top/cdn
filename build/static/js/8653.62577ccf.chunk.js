"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[310,7768,8653,9164],{8653:(e,t,i)=>{i.r(t),i.d(t,{default:()=>g});var l=i(12162),n=i(69805),a=i(18666),s=i(98496),o=i(10428),r=i(45558),d=i(28093),c=i(32563),u=i(27768),v=i(49450);const g=({itemData:e,objectType:t,curFilter:i,approveCallback:g})=>{const{t:f}=(0,s.B)("translation",{keyPrefix:"page_review"}),[h,m]=(0,l.useState)(!1),[p,x]=(0,l.useState)(!1),y=(0,d.TS)(g),_=(0,d.dj)(),k=(0,c.T5)("delete"),b=()=>{x(!p)},j=()=>{const i={operation_type:"delete_post",flag_id:String(null===e||void 0===e?void 0:e.flag_id),captcha_code:void 0,captcha_id:void 0};null===k||void 0===k||k.resolveCaptchaReq(i),delete i.captcha_code,delete i.captcha_id,(0,r.gI)(i).then((async()=>{await(null===k||void 0===k?void 0:k.close());let e="";"question"===t&&(e=f("post_deleted",{keyPrefix:"messages"})),"answer"===t&&(e=f("tip_answer_deleted")),"answer"!==t&&"question"!==t||_.onShow({msg:e,variant:"success"}),g()})).catch((e=>{e.isError&&(null===k||void 0===k||k.handleCaptchaError(e.list))})).finally((()=>{m(!1)}))},w=i=>{if("delete"===i&&(()=>{let i="";m(!0),"question"===t&&(i=Number(null===e||void 0===e?void 0:e.answer_count)>0?f("question",{keyPrefix:"delete"}):f("other",{keyPrefix:"delete"})),"answer"===t&&(i=null!==e&&void 0!==e&&e.answer_accepted?f("answer_accepted",{keyPrefix:"delete"}):f("other",{keyPrefix:"delete"})),"comment"===t&&(i=f("other",{keyPrefix:"delete"})),o.aF.confirm({title:f("title",{keyPrefix:"delete"}),content:i,cancelBtnVariant:"link",confirmBtnVariant:"danger",confirmText:f("delete",{keyPrefix:"btns"}),onConfirm:()=>{k?k.check((()=>j())):j()},onCancel:()=>{m(!1)}})})(),"close"===i&&y.onShow({type:"question",id:(null===e||void 0===e?void 0:e.flag_id)||"",action:"close",source:"review",content:null===e||void 0===e?void 0:e.reason_content,reportType:(null===e||void 0===e?void 0:e.reason.reason_type)||-1}),"unlist"===i){const t="question_detail.unlist";o.aF.confirm({title:f("title",{keyPrefix:t}),content:f("content",{keyPrefix:t}),cancelBtnVariant:"link",confirmText:f("confirm_btn",{keyPrefix:t}),onConfirm:()=>{(0,r.gI)({operation_type:"unlist_post",flag_id:(null===e||void 0===e?void 0:e.flag_id)||""}).then((()=>{_.onShow({msg:f(`post_${i}`,{keyPrefix:"messages"}),variant:"success"}),g()}))}})}};return(0,v.jsxs)("div",{children:[(0,v.jsxs)(n.A,{children:[(0,v.jsx)(n.A.Toggle,{as:a.A,disabled:h,variant:"outline-primary",id:"dropdown-basic",children:f("approve",{keyPrefix:"btns"})}),(0,v.jsxs)(n.A.Menu,{children:[(0,v.jsx)(n.A.Item,{onClick:()=>{b()},children:f("edit_post")}),"normal"===i&&"question"===t&&(0,v.jsx)(n.A.Item,{onClick:()=>w("close"),children:f("close",{keyPrefix:"btns"})}),"deleted"!==i&&(0,v.jsx)(n.A.Item,{onClick:()=>w("delete"),children:f("delete",{keyPrefix:"btns"})}),"question"===t&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n.A.Divider,{}),2!==(null===e||void 0===e?void 0:e.object_show_status)&&(0,v.jsx)(n.A.Item,{onClick:()=>w("unlist"),children:f("unlist_post")})]})]})]}),(0,v.jsx)(u.default,{visible:p,handleClose:b,objectType:t,originalData:{flag_id:(null===e||void 0===e?void 0:e.flag_id)||"",id:(null===e||void 0===e?void 0:e.object_id)||"",title:(null===e||void 0===e?void 0:e.title)||"",content:(null===e||void 0===e?void 0:e.original_text)||"",tags:(null===e||void 0===e?void 0:e.tags)||[],question_id:(null===e||void 0===e?void 0:e.question_id)||"",answer_id:(null===e||void 0===e?void 0:e.answer_id)||""},callback:g})]})}},27768:(e,t,i)=>{i.r(t),i.d(t,{default:()=>p});var l=i(12162),n=i(53652),a=i(14592),s=i(18666),o=i(98496),r=i(59660),d=i.n(r),c=i(45558),u=i(28093),v=i(32563),g=i(10428),f=i(93090),h=(i(70310),i(49450));const m={title:{value:"",isInvalid:!1,errorMsg:""},tags:{value:[],isInvalid:!1,errorMsg:""},content:{value:"",isInvalid:!1,errorMsg:""}},p=({originalData:e,visible:t=!1,objectType:i,handleClose:r,callback:p})=>{const{t:x}=(0,o.B)("translation",{keyPrefix:"ask"}),[y,_]=(0,l.useState)(m),[k,b]=(0,l.useState)(!1),[j,w]=(0,l.useState)(!1),I=(0,u.L7)(),A=(0,v.T5)("edit"),C=e=>{e&&(null===p||void 0===p||p()),_(m),r(),w(!1)},P=e=>{j&&_({...y,...e})},q=()=>{const t={title:y.title.value,content:y.content.value,tags:y.tags.value,operation_type:"edit_post",flag_id:e.flag_id};if("answer"===i&&(delete t.title,delete t.tags),"comment"===i){const{value:e}=y.content,i=(0,f.by)(e);t.content=i,delete t.title,delete t.tags}if("question"===i){const e=null===A||void 0===A?void 0:A.getCaptcha();null!==e&&void 0!==e&&e.verify&&(t.captcha_code=e.captcha_code,t.captcha_id=e.captcha_id)}(0,c.gI)(t).then((async()=>{await(null===A||void 0===A?void 0:A.close()),C(!0)})).catch((e=>{if(e.isError){null===A||void 0===A||A.handleCaptchaError(e.list);const t=(0,f.NC)(e,y);_({...t});const i=document.getElementById(e.list[0].error_field);(0,f.qt)(i)}}))};return(0,l.useEffect)((()=>{t&&(y.title.value=e.title,y.content.value=e.content,y.tags.value=e.tags.map((e=>({...e,parsed_text:"",original_text:""}))),_({...y}),w(!0))}),[t]),(0,h.jsxs)(n.A,{show:t,onHide:()=>C(!1),className:"w-100",dialogClassName:"edit-post-modal",children:[(0,h.jsx)(n.A.Header,{closeButton:!0,children:(0,h.jsx)(n.A.Title,{children:x("edit_post",{keyPrefix:"page_review"})})}),(0,h.jsxs)(a.A,{noValidate:!0,onSubmit:e=>{e.preventDefault(),e.stopPropagation(),(()=>{let e=!0;const{title:t,tags:l,content:n}=y;if("question"===i&&(t.value||(e=!1,y.title={value:t.value,isInvalid:!0,errorMsg:x("form.fields.title.msg.empty",{keyPrefix:"ask"})}),l.value.length||(e=!1,y.tags={value:l.value,isInvalid:!0,errorMsg:x("form.fields.tags.msg.empty",{keyPrefix:"ask"})})),!n.value||Array.from(n.value.trim()).length<6?(e=!1,y.content={value:n.value,isInvalid:!0,errorMsg:x("form.fields.answer.feedback.characters",{keyPrefix:"edit_answer"})}):y.content={value:n.value,isInvalid:!1,errorMsg:""},_({...y}),!e){const e=Object.keys(y).filter((e=>y[e].isInvalid)),t=document.getElementById(e[0]);(0,f.qt)(t)}return e})()&&(A?A.check((()=>q())):q())},children:[(0,h.jsxs)(n.A.Body,{children:["question"===i&&(0,h.jsxs)(a.A.Group,{controlId:"title",className:"mb-3",children:[(0,h.jsx)(a.A.Label,{children:x("form.fields.title.label")}),(0,h.jsx)(a.A.Control,{type:"text",value:y.title.value,isInvalid:y.title.isInvalid,onChange:e=>{P({title:{value:e.target.value,isInvalid:!1,errorMsg:""}})},placeholder:x("form.fields.title.placeholder"),autoFocus:!0,contentEditable:!0}),(0,h.jsx)(a.A.Control.Feedback,{type:"invalid",children:y.title.errorMsg})]}),"comment"!==i&&(0,h.jsxs)(a.A.Group,{controlId:"body",children:[(0,h.jsx)(a.A.Label,{children:x("question"===i?"form.fields.body.label":"form.fields.answer.label")}),(0,h.jsx)(a.A.Control,{defaultValue:y.content.value,isInvalid:y.content.isInvalid,hidden:!0}),(0,h.jsx)(g.KE,{value:y.content.value,onChange:e=>{P({content:{value:e,errorMsg:"",isInvalid:!1}})},className:d()("form-control p-0",k?"focus":""),onFocus:()=>{b(!0)},onBlur:()=>{b(!1)}}),(0,h.jsx)(a.A.Control.Feedback,{type:"invalid",children:y.content.errorMsg})]}),"question"===i&&(0,h.jsxs)(a.A.Group,{controlId:"tags",className:"my-3",children:[(0,h.jsx)(a.A.Label,{children:x("form.fields.tags.label")}),(0,h.jsx)(g.Cx,{value:y.tags.value,onChange:e=>{P({tags:{value:e,errorMsg:"",isInvalid:!1}})},showRequiredTag:!0,maxTagLength:5,isInvalid:y.tags.isInvalid,errMsg:y.tags.errorMsg})]}),"comment"===i&&(0,h.jsxs)("div",{className:"w-100",children:[(0,h.jsxs)("div",{className:d()("custom-form-control",{"is-invalid":y.content.isInvalid}),children:[(0,h.jsx)(a.A.Label,{children:"Comment"}),(0,h.jsx)(g.MW,{pageUsers:I.getUsers(),onSelected:e=>{j&&_({...y,content:{value:e,errorMsg:"",isInvalid:!1}})},children:(0,h.jsx)(g.fs,{size:"sm",rows:4,value:(0,f.$t)(y.content.value),onChange:e=>{P({content:{value:e.target.value,errorMsg:"",isInvalid:!1}})}})})]}),(0,h.jsx)(a.A.Control.Feedback,{type:"invalid",children:y.content.errorMsg})]})]}),(0,h.jsxs)(n.A.Footer,{children:[(0,h.jsx)(s.A,{variant:"secondary",onClick:()=>C(!1),children:x("close",{keyPrefix:"btns"})}),(0,h.jsx)(s.A,{variant:"primary",type:"submit",children:x("submit",{keyPrefix:"btns"})})]})]})]})}},70310:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});const l={}}}]);
//# sourceMappingURL=8653.62577ccf.chunk.js.map