{"version":3,"file":"static/js/886.281f28ff.chunk.js","mappings":"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","sources":["pages/Questions/Detail/components/Question/index.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { memo, FC, useState, useEffect, useRef } from 'react';\nimport { Link, useSearchParams } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { Button, OverlayTrigger, Tooltip } from 'react-bootstrap';\n\nimport {\n  Tag,\n  Actions,\n  Operate,\n  UserCard,\n  Comment,\n  FormatTime,\n  htmlRender,\n  Icon,\n  ImgViewer,\n} from '@/components';\nimport { useRenderHtmlPlugin } from '@/utils/pluginKit';\nimport { formatCount, guard } from '@/utils';\nimport { following } from '@/services';\nimport { pathFactory } from '@/router/pathFactory';\n\ninterface Props {\n  data: any;\n  hasAnswer: boolean;\n  isLogged: boolean;\n  initPage: (type: string) => void;\n}\n\nconst Index: FC<Props> = ({ data, initPage, hasAnswer, isLogged }) => {\n  const { t } = useTranslation('translation', {\n    keyPrefix: 'question_detail',\n  });\n  const [searchParams] = useSearchParams();\n  const [followed, setFollowed] = useState(data?.is_followed);\n  const ref = useRef<HTMLDivElement>(null);\n\n  useRenderHtmlPlugin(ref.current);\n\n  const handleFollow = (e) => {\n    e.preventDefault();\n    if (!guard.tryNormalLogged(true)) {\n      return;\n    }\n    following({\n      object_id: data?.id,\n      is_cancel: followed,\n    }).then((res) => {\n      setFollowed(res.is_followed);\n    });\n  };\n\n  useEffect(() => {\n    if (data) {\n      setFollowed(data?.is_followed);\n    }\n  }, [data]);\n\n  useEffect(() => {\n    if (!ref.current) {\n      return;\n    }\n\n    htmlRender(ref.current, {\n      copySuccessText: t('copied', { keyPrefix: 'messages' }),\n      copyText: t('copy', { keyPrefix: 'messages' }),\n    });\n  }, [ref.current]);\n\n  if (!data?.id) {\n    return null;\n  }\n\n  return (\n    <div>\n      <h1 className=\"h3 mb-3 text-wrap text-break\">\n        <Link\n          className=\"link-dark\"\n          reloadDocument\n          to={pathFactory.questionLanding(data.id, data.url_title)}>\n          {data.title}\n          {data.status === 2\n            ? ` [${t('closed', { keyPrefix: 'question' })}]`\n            : ''}\n        </Link>\n      </h1>\n\n      <div className=\"d-flex flex-wrap align-items-center small mb-3 text-secondary\">\n        {data?.pin === 2 && (\n          <div className=\"me-3\">\n            <Icon\n              name=\"pin-fill\"\n              className=\"me-1\"\n              title={t('pinned', { keyPrefix: 'btns' })}\n            />\n            <span>{t('pinned', { keyPrefix: 'btns' })}</span>\n          </div>\n        )}\n        <FormatTime\n          time={data.create_time}\n          preFix={t('Asked')}\n          className=\"me-3\"\n        />\n\n        <FormatTime\n          time={data.update_time}\n          preFix={t('update')}\n          className=\"me-3\"\n        />\n        {data?.view_count > 0 && (\n          <div className=\"me-3\">\n            {t('Views')} {formatCount(data.view_count)}\n          </div>\n        )}\n        <OverlayTrigger\n          placement=\"bottom\"\n          overlay={<Tooltip id=\"followTooltip\">{t('follow_tip')}</Tooltip>}>\n          <Button\n            variant=\"link\"\n            size=\"sm\"\n            className=\"p-0 btn-no-border\"\n            onClick={(e) => handleFollow(e)}>\n            {t(followed ? 'Following' : 'Follow')}\n          </Button>\n        </OverlayTrigger>\n      </div>\n      <div className=\"m-n1\">\n        {data?.tags?.map((item: any) => {\n          return <Tag className=\"m-1\" key={item.slug_name} data={item} />;\n        })}\n      </div>\n      <ImgViewer>\n        <article\n          ref={ref}\n          className=\"fmt text-break text-wrap mt-4\"\n          dangerouslySetInnerHTML={{ __html: data?.html }}\n        />\n      </ImgViewer>\n\n      <Actions\n        className=\"mt-4\"\n        source=\"question\"\n        data={{\n          id: data?.id,\n          isHate: data?.vote_status === 'vote_down',\n          isLike: data?.vote_status === 'vote_up',\n          votesCount: data?.vote_count,\n          collected: data?.collected,\n          collectCount: data?.collection_count,\n          username: data.user_info?.username,\n        }}\n      />\n\n      <div className=\"d-block d-md-flex flex-wrap mt-4 mb-3\">\n        <div className=\"mb-3 mb-md-0 me-4 flex-grow-1\">\n          <Operate\n            qid={data?.id}\n            type=\"question\"\n            memberActions={data?.member_actions}\n            title={data.title}\n            hasAnswer={hasAnswer}\n            isAccepted={Boolean(data?.accepted_answer_id)}\n            callback={initPage}\n          />\n        </div>\n        <div style={{ minWidth: '196px' }} className=\"mb-3 me-4 mb-md-0\">\n          {data.update_user_info &&\n          data.update_user_info?.username !== data.user_info?.username ? (\n            <UserCard\n              data={data?.update_user_info}\n              time={data.edit_time}\n              preFix={t('edit')}\n              isLogged={isLogged}\n              timelinePath={`/posts/${data.id}/timeline`}\n            />\n          ) : isLogged ? (\n            <Link to={`/posts/${data.id}/timeline`}>\n              <FormatTime\n                time={data.edit_time}\n                preFix={t('edit')}\n                className=\"link-secondary small\"\n              />\n            </Link>\n          ) : (\n            <FormatTime\n              time={data.edit_time}\n              preFix={t('edit')}\n              className=\"text-secondary small\"\n            />\n          )}\n        </div>\n        <div style={{ minWidth: '196px' }}>\n          <UserCard\n            data={data?.user_info}\n            time={data.create_time}\n            preFix={t('asked')}\n            isLogged={isLogged}\n            timelinePath={`/posts/${data.id}/timeline`}\n          />\n        </div>\n      </div>\n\n      <Comment\n        objectId={data?.id}\n        mode=\"question\"\n        commentId={searchParams.get('commentId')}\n      />\n    </div>\n  );\n};\n\nexport default memo(Index);\n"],"names":["Index","data","initPage","hasAnswer","isLogged","_data$tags","_data$user_info","_data$update_user_inf","_data$user_info2","t","useTranslation","keyPrefix","searchParams","useSearchParams","followed","setFollowed","useState","is_followed","ref","useRef","useRenderHtmlPlugin","current","useEffect","htmlRender","copySuccessText","copyText","id","_jsxs","children","_jsx","className","Link","reloadDocument","to","pathFactory","questionLanding","url_title","title","status","pin","Icon","name","FormatTime","time","create_time","preFix","update_time","view_count","formatCount","OverlayTrigger","placement","overlay","Tooltip","Button","variant","size","onClick","e","preventDefault","guard","following","object_id","is_cancel","then","res","handleFollow","tags","map","item","Tag","slug_name","ImgViewer","dangerouslySetInnerHTML","__html","html","Actions","source","isHate","vote_status","isLike","votesCount","vote_count","collected","collectCount","collection_count","username","user_info","Operate","qid","type","memberActions","member_actions","isAccepted","Boolean","accepted_answer_id","callback","style","minWidth","update_user_info","UserCard","edit_time","timelinePath","Comment","objectId","mode","commentId","get","memo"],"sourceRoot":""}