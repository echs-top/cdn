{"version":3,"file":"static/js/7639.b92a63cd.chunk.js","mappings":"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","sources":["pages/Admin/Users/components/Action/index.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Dropdown } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { Modal, Icon } from '@/components';\nimport {\n  useChangeUserRoleModal,\n  useChangeProfileModal,\n  useChangePasswordModal,\n  useActivationEmailModal,\n  useToast,\n} from '@/hooks';\nimport {\n  updateUserPassword,\n  changeUserStatus,\n  updateUserProfile,\n} from '@/services';\nimport { toastStore } from '@/stores';\n\ninterface Props {\n  showActionPassword?: boolean;\n  showActionStatus?: boolean;\n  showActionRole?: boolean;\n  currentUser;\n  refreshUsers: () => void;\n  showDeleteModal: (val) => void;\n  showSuspenseModal: (val) => void;\n  userData;\n}\n\nconst UserOperation = ({\n  showActionPassword,\n  showActionStatus,\n  showActionRole,\n  currentUser,\n  refreshUsers,\n  showDeleteModal,\n  userData,\n  showSuspenseModal,\n}: Props) => {\n  const { t } = useTranslation('translation', { keyPrefix: 'admin.users' });\n  const Toast = useToast();\n\n  const changeUserRoleModal = useChangeUserRoleModal({\n    callback: () => {\n      Toast.onShow({\n        msg: t('change_user_role', { keyPrefix: 'messages' }),\n        variant: 'success',\n      });\n      refreshUsers?.();\n    },\n  });\n  const changePasswordModal = useChangePasswordModal({\n    onConfirm: (rd) => {\n      return new Promise((resolve, reject) => {\n        updateUserPassword(rd)\n          .then(() => {\n            Toast.onShow({\n              msg: t('update_password', { keyPrefix: 'toast' }),\n              variant: 'success',\n            });\n            resolve(true);\n          })\n          .catch((e) => {\n            reject(e);\n          });\n      });\n    },\n  });\n  const changeProfileModal = useChangeProfileModal(\n    {\n      onConfirm: (rd) => {\n        return new Promise((resolve, reject) => {\n          updateUserProfile(rd)\n            .then(() => {\n              Toast.onShow({\n                msg: t('edit_success', {\n                  keyPrefix: 'admin.edit_profile_modal',\n                }),\n                variant: 'success',\n              });\n              resolve(true);\n              refreshUsers?.();\n            })\n            .catch((e) => {\n              reject(e);\n            });\n        });\n      },\n    },\n    userData,\n  );\n\n  const activationEmailModal = useActivationEmailModal();\n\n  const postUserStatus = (statusType) => {\n    changeUserStatus({\n      user_id: userData.user_id,\n      status: statusType,\n    }).then(() => {\n      toastStore.getState().show({\n        msg: t(`user_${statusType}`, { keyPrefix: 'messages' }),\n        variant: 'success',\n      });\n      refreshUsers?.();\n      // onClose();\n    });\n  };\n\n  const handleAction = (type) => {\n    const { user_id, role_id, username } = userData;\n    if (username === currentUser.username) {\n      Toast.onShow({\n        msg: t('forbidden_operate_self', { keyPrefix: 'toast' }),\n        variant: 'warning',\n      });\n      return;\n    }\n\n    if (type === 'role') {\n      changeUserRoleModal.onShow({\n        id: user_id,\n        role_id,\n      });\n    }\n\n    if (type === 'password') {\n      changePasswordModal.onShow(user_id);\n    }\n\n    if (type === 'profile') {\n      changeProfileModal.onShow(user_id);\n    }\n\n    if (type === 'activation') {\n      activationEmailModal.onShow(user_id);\n    }\n\n    if (type === 'deactivate') {\n      // cons\n      Modal.confirm({\n        title: t('deactivate_user.title'),\n        content: t('deactivate_user.content'),\n        cancelBtnVariant: 'link',\n        confirmBtnVariant: 'danger',\n        cancelText: t('cancel', { keyPrefix: 'btns' }),\n        confirmText: t('deactivate', { keyPrefix: 'btns' }),\n        onConfirm: () => {\n          // active -> inactive\n          postUserStatus('inactive');\n        },\n      });\n    }\n\n    if (type === 'suspend') {\n      // cons\n      showSuspenseModal({\n        show: true,\n        userId: userData.user_id,\n      });\n    }\n\n    if (type === 'active' || type === 'unsuspend') {\n      // to normal\n      postUserStatus('normal');\n    }\n\n    if (type === 'delete') {\n      showDeleteModal({\n        show: true,\n        userId: userData.user_id,\n      });\n    }\n  };\n\n  return (\n    <td className=\"text-end\">\n      <Dropdown>\n        <Dropdown.Toggle variant=\"link\" className=\"no-toggle p-0\">\n          <Icon name=\"three-dots-vertical\" title={t('action')} />\n        </Dropdown.Toggle>\n        <Dropdown.Menu align=\"end\">\n          {showActionPassword ? (\n            <Dropdown.Item onClick={() => handleAction('password')}>\n              {t('set_new_password')}\n            </Dropdown.Item>\n          ) : null}\n          <Dropdown.Item onClick={() => handleAction('profile')}>\n            {t('edit_profile')}\n          </Dropdown.Item>\n          {showActionRole ? (\n            <Dropdown.Item onClick={() => handleAction('role')}>\n              {t('change_role')}\n            </Dropdown.Item>\n          ) : null}\n          {userData.status === 'inactive' ? (\n            <Dropdown.Item onClick={() => handleAction('activation')}>\n              {t('btn_name', { keyPrefix: 'inactive' })}\n            </Dropdown.Item>\n          ) : null}\n          {showActionStatus && userData.status !== 'deleted' ? (\n            <>\n              <Dropdown.Divider />\n              {userData.status === 'inactive' && (\n                <Dropdown.Item onClick={() => handleAction('active')}>\n                  {t('active', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              {userData.status === 'normal' && (\n                <Dropdown.Item onClick={() => handleAction('deactivate')}>\n                  {t('deactivate', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              {userData.status === 'normal' && (\n                <Dropdown.Item onClick={() => handleAction('suspend')}>\n                  {t('suspend', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              {userData.status === 'suspended' && (\n                <Dropdown.Item onClick={() => handleAction('unsuspend')}>\n                  {t('unsuspend', { keyPrefix: 'btns' })}\n                </Dropdown.Item>\n              )}\n              <Dropdown.Item onClick={() => handleAction('delete')}>\n                {t('delete', { keyPrefix: 'btns' })}\n              </Dropdown.Item>\n            </>\n          ) : null}\n        </Dropdown.Menu>\n      </Dropdown>\n    </td>\n  );\n};\n\nexport default UserOperation;\n"],"names":["UserOperation","showActionPassword","showActionStatus","showActionRole","currentUser","refreshUsers","showDeleteModal","userData","showSuspenseModal","t","useTranslation","keyPrefix","Toast","useToast","changeUserRoleModal","useChangeUserRoleModal","callback","onShow","msg","variant","changePasswordModal","useChangePasswordModal","onConfirm","rd","Promise","resolve","reject","updateUserPassword","then","catch","e","changeProfileModal","useChangeProfileModal","updateUserProfile","activationEmailModal","useActivationEmailModal","postUserStatus","statusType","changeUserStatus","user_id","status","toastStore","getState","show","handleAction","type","role_id","username","id","Modal","confirm","title","content","cancelBtnVariant","confirmBtnVariant","cancelText","confirmText","userId","_jsx","className","children","_jsxs","Dropdown","Toggle","Icon","name","Menu","align","Item","onClick","_Fragment","Divider"],"sourceRoot":""}