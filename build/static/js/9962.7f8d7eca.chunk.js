"use strict";(globalThis.webpackChunkanswer_static=globalThis.webpackChunkanswer_static||[]).push([[104,1177,3225,3326,6907,8293,9962,9998],{8293:(e,l,a)=>{a.r(l),a.d(l,{default:()=>t});var s=a(18666),r=a(98496),n=a(28446),i=a(73225),d=a(49450);const t=({visible:e,siteUrl:l=""})=>{const{t:a}=(0,r.B)("translation",{keyPrefix:"install"});return e?(0,d.jsxs)("div",{children:[(0,d.jsx)("h5",{children:a("ready_title")}),(0,d.jsx)("p",{children:(0,d.jsxs)(n.x,{i18nKey:"install.ready_desc",children:["If you ever feel like changing more settings, visit",(0,d.jsx)("a",{href:`${l}/users/login`,children:" admin section"}),"; find it in the site menu."]})}),(0,d.jsx)("p",{children:a("good_luck")}),(0,d.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,d.jsx)(i.default,{step:5}),(0,d.jsx)(s.A,{href:l,children:a("done")})]})]}):null}},50104:(e,l,a)=>{a.r(l),a.d(l,{default:()=>_});var s=a(12162),r=a(14592),n=a(18666),i=a(98496),d=a(73225),t=a(45558),o=a(3176),c=a(91374),v=a(93090),u=a(49450);const _=({visible:e,data:l,changeCallback:a,nextCallback:_})=>{const{t:m}=(0,i.B)("translation",{keyPrefix:"install"}),[b,g]=(0,s.useState)();return(0,s.useEffect)((()=>{(async()=>{const e=await(0,t.KO)(),l=v.wc.get(c.rZ)||e[0].value;g(e),(0,o.setupInstallLanguage)(l),a({lang:{value:l,isInvalid:!1,errorMsg:""}})})()}),[]),e?(0,u.jsxs)(r.A,{noValidate:!0,onSubmit:()=>{_()},children:[(0,u.jsxs)(r.A.Group,{controlId:"lang",className:"mb-3",children:[(0,u.jsx)(r.A.Label,{children:m("lang.label")}),(0,u.jsx)(r.A.Select,{value:l.value,isInvalid:l.isInvalid,onChange:e=>{(0,o.setupInstallLanguage)(e.target.value),a({lang:{value:e.target.value,isInvalid:!1,errorMsg:""}})},children:null===b||void 0===b?void 0:b.map((e=>(0,u.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,u.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,u.jsx)(d.default,{step:1}),(0,u.jsx)(n.A,{type:"submit",children:m("next")})]})]}):null}},69998:(e,l,a)=>{a.r(l),a.d(l,{default:()=>o});var s=a(14592),r=a(18666),n=a(98496),i=a(51861),d=a(73225),t=a(49450);const o=({visible:e,data:l,changeCallback:a,nextCallback:o})=>{const{t:c}=(0,n.B)("translation",{keyPrefix:"install"});return e?(0,t.jsxs)(s.A,{noValidate:!0,onSubmit:e=>{e.preventDefault(),e.stopPropagation(),(()=>{let e=!0;const{site_name:s,site_url:r,confirm_password:n,contact_email:d,name:t,password:o,email:v}=l;return s.value||(e=!1,l.site_name={value:"",isInvalid:!0,errorMsg:c("site_name.msg")}),s.value&&s.value.length>30&&(e=!1,l.site_url={value:s.value,isInvalid:!0,errorMsg:c("site_name.msg_max_length")}),r.value||(e=!1,l.site_url={value:"",isInvalid:!0,errorMsg:c("site_name.msg.empty")}),r.value&&!r.value.match(/^(http|https):\/\//g)?(e=!1,l.site_url={value:r.value,isInvalid:!0,errorMsg:c("site_url.msg.incorrect")}):r.value.length>512&&(e=!1,l.site_url={value:r.value,isInvalid:!0,errorMsg:c("site_url.msg.max_length")}),d.value||(e=!1,l.contact_email={value:"",isInvalid:!0,errorMsg:c("contact_email.msg.empty")}),d.value&&!i.A.email.test(d.value)&&(e=!1,l.contact_email={value:d.value,isInvalid:!0,errorMsg:c("contact_email.msg.incorrect")}),t.value?t.value.length<2||t.value.length>30?(e=!1,l.name={value:t.value,isInvalid:!0,errorMsg:c("admin_name.msg_max_length")}):/^[\w.-\s]{2,30}$/.test(t.value)||(e=!1,l.name={value:t.value,isInvalid:!0,errorMsg:c("admin_name.character")}):(e=!1,l.name={value:"",isInvalid:!0,errorMsg:c("admin_name.msg")}),o.value||(e=!1,l.password={value:"",isInvalid:!0,errorMsg:c("admin_password.msg")}),o.value&&o.value.length<4&&(e=!1,l.password={value:l.password.value,isInvalid:!0,errorMsg:c("admin_password.msg_min_length")}),o.value&&o.value.length>32&&(e=!1,l.password={value:l.password.value,isInvalid:!0,errorMsg:c("admin_password.msg_max_length")}),n.value!==o.value&&(e=!1,l.confirm_password={value:"",isInvalid:!0,errorMsg:c("admin_confirm_password.msg")}),v.value||(e=!1,l.email={value:"",isInvalid:!0,errorMsg:c("admin_email.msg.empty")}),v.value&&!i.A.email.test(v.value)&&(e=!1,l.email={value:v.value,isInvalid:!0,errorMsg:c("admin_email.msg.incorrect")}),a({...l}),e})()&&o()},children:[(0,t.jsx)("h5",{children:c("site_information")}),(0,t.jsxs)(s.A.Group,{controlId:"site_name",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("site_name.label")}),(0,t.jsx)(s.A.Control,{required:!0,value:l.site_name.value,isInvalid:l.site_name.isInvalid,onChange:e=>{a({site_name:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.site_name.errorMsg})]}),(0,t.jsxs)(s.A.Group,{controlId:"site_url",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("site_url.label")}),(0,t.jsx)(s.A.Control,{required:!0,value:l.site_url.value,isInvalid:l.site_url.isInvalid,onChange:e=>{a({site_url:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Text,{children:c("site_url.text")}),(0,t.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.site_url.errorMsg})]}),(0,t.jsxs)(s.A.Group,{controlId:"contact_email",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("contact_email.label")}),(0,t.jsx)(s.A.Control,{required:!0,type:"email",value:l.contact_email.value,isInvalid:l.contact_email.isInvalid,onChange:e=>{a({contact_email:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Text,{children:c("contact_email.text")}),(0,t.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.contact_email.errorMsg})]}),(0,t.jsx)("h5",{children:c("login_required.label")}),(0,t.jsxs)(s.A.Group,{controlId:"login_required",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("login_required.label")}),(0,t.jsx)(s.A.Check,{type:"switch",id:"login_required",label:c("login_required.switch"),checked:l.login_required.value,onChange:e=>{a({login_required:{value:e.target.checked,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Text,{children:c("login_required.text")})]}),(0,t.jsxs)(s.A.Group,{controlId:"external_content_display",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("external_content_display.label",{keyPrefix:"admin.legal"})}),(0,t.jsxs)(s.A.Select,{value:l.external_content_display.value,onChange:e=>{a({external_content_display:{value:e.target.value,isInvalid:!1,errorMsg:""}})},children:[(0,t.jsx)("option",{value:"always_display",children:c("external_content_display.always_display",{keyPrefix:"admin.legal"})}),(0,t.jsx)("option",{value:"ask_before_display",children:c("external_content_display.ask_before_display",{keyPrefix:"admin.legal"})})]}),(0,t.jsx)(s.A.Text,{children:c("external_content_display.text",{keyPrefix:"admin.legal"})})]}),(0,t.jsx)("h5",{children:c("admin_account")}),(0,t.jsxs)(s.A.Group,{controlId:"name",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("admin_name.label")}),(0,t.jsx)(s.A.Control,{required:!0,value:l.name.value,isInvalid:l.name.isInvalid,onChange:e=>{a({name:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.name.errorMsg})]}),(0,t.jsxs)(s.A.Group,{controlId:"password",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("admin_password.label")}),(0,t.jsx)(s.A.Control,{required:!0,type:"password",value:l.password.value,isInvalid:l.password.isInvalid,onChange:e=>{a({password:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Text,{children:c("admin_password.text")}),(0,t.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.password.errorMsg})]}),(0,t.jsxs)(s.A.Group,{controlId:"confirm_password",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("admin_confirm_password.label")}),(0,t.jsx)(s.A.Control,{required:!0,type:"password",value:l.confirm_password.value,isInvalid:l.confirm_password.isInvalid,onChange:e=>{a({confirm_password:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Text,{children:c("admin_confirm_password.text")}),(0,t.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.confirm_password.errorMsg})]}),(0,t.jsxs)(s.A.Group,{controlId:"email",className:"mb-3",children:[(0,t.jsx)(s.A.Label,{children:c("admin_email.label")}),(0,t.jsx)(s.A.Control,{required:!0,value:l.email.value,isInvalid:l.email.isInvalid,onChange:e=>{a({email:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,t.jsx)(s.A.Text,{children:c("admin_email.text")}),(0,t.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.email.errorMsg})]}),(0,t.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,t.jsx)(d.default,{step:4}),(0,t.jsx)(r.A,{type:"submit",children:c("next")})]})]}):null}},73225:(e,l,a)=>{a.r(l),a.d(l,{default:()=>m});var s=a(12162),r=a(59660),n=a.n(r),i=a(42700),d=a(66087),t=a(49450);function o(e,l,a){const s=(e-l)/(a-l)*100;return Math.round(1e3*s)/1e3}function c({min:e,now:l,max:a,label:s,visuallyHidden:r,striped:i,animated:d,className:c,style:v,variant:u,bsPrefix:_,...m},b){return(0,t.jsx)("div",{ref:b,...m,role:"progressbar",className:n()(c,`${_}-bar`,{[`bg-${u}`]:u,[`${_}-bar-animated`]:d,[`${_}-bar-striped`]:d||i}),style:{width:`${o(l,e,a)}%`,...v},"aria-valuenow":l,"aria-valuemin":e,"aria-valuemax":a,children:r?(0,t.jsx)("span",{className:"visually-hidden",children:s}):s})}const v=s.forwardRef((({isChild:e=!1,...l},a)=>{const r={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...l};if(r.bsPrefix=(0,i.oU)(r.bsPrefix,"progress"),e)return c(r,a);const{min:o,now:v,max:u,label:_,visuallyHidden:m,striped:b,animated:g,bsPrefix:h,variant:x,className:p,children:j,...f}=r;return(0,t.jsx)("div",{ref:a,...f,className:n()(p,h),children:j?(0,d.Tj)(j,(e=>(0,s.cloneElement)(e,{isChild:!0}))):c({min:o,now:v,max:u,label:_,visuallyHidden:m,striped:b,animated:g,bsPrefix:h,variant:x},a)})}));v.displayName="ProgressBar";const u=v,_=({step:e})=>(0,t.jsxs)("div",{className:"d-flex align-items-center small text-secondary",children:[(0,t.jsx)(u,{now:e/5*100,variant:"success",style:{width:"200px"},className:"me-2"}),(0,t.jsxs)("span",{children:[e,"/5"]})]}),m=(0,s.memo)(_)},63326:(e,l,a)=>{a.r(l),a.d(l,{default:()=>u});var s=a(14592),r=a(98128),n=a(8810),i=a(18666),d=a(98496),t=a(73225),o=a(49450);const c=[{value:"mysql",label:"MariaDB/MySQL"},{value:"sqlite3",label:"SQLite"},{value:"postgres",label:"PostgreSQL"}],v=[{value:"require"},{value:"verify-ca"},{value:"verify-full"}],u=({visible:e,data:l,changeCallback:a,nextCallback:u})=>{const{t:_}=(0,d.B)("translation",{keyPrefix:"install"});return e?(0,o.jsxs)(s.A,{noValidate:!0,onSubmit:e=>{e.preventDefault(),e.stopPropagation(),(()=>{let e=!0;const{db_type:s,db_username:r,db_password:n,db_host:i,db_name:d,db_file:t}=l;return"sqlite3"!==s.value?(r.value||(e=!1,l.db_username={value:"",isInvalid:!0,errorMsg:_("db_username.msg")}),n.value||(e=!1,l.db_password={value:"",isInvalid:!0,errorMsg:_("db_password.msg")}),i.value||(e=!1,l.db_host={value:"",isInvalid:!0,errorMsg:_("db_host.msg")}),d.value||(e=!1,l.db_name={value:"",isInvalid:!0,errorMsg:_("db_name.msg")})):t.value||(e=!1,l.db_file={value:"",isInvalid:!0,errorMsg:_("db_file.msg")}),a({...l}),e})()&&u()},children:[(0,o.jsxs)(s.A.Group,{controlId:"database_engine",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("db_type.label")}),(0,o.jsx)(s.A.Select,{value:l.db_type.value,isInvalid:l.db_type.isInvalid,onChange:e=>{a({db_type:{value:e.target.value,isInvalid:!1,errorMsg:""}})},children:c.map((e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),"sqlite3"!==l.db_type.value?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s.A.Group,{controlId:"username",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("db_username.label")}),(0,o.jsx)(s.A.Control,{required:!0,placeholder:_("db_username.placeholder"),value:l.db_username.value,isInvalid:l.db_username.isInvalid,onChange:e=>{a({db_username:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.db_username.errorMsg})]}),(0,o.jsxs)(s.A.Group,{controlId:"db_password",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("db_password.label")}),(0,o.jsx)(s.A.Control,{required:!0,value:l.db_password.value,isInvalid:l.db_password.isInvalid,onChange:e=>{a({db_password:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.db_password.errorMsg})]}),"postgres"===l.db_type.value&&(0,o.jsxs)(s.A.Group,{controlId:"ssl_enabled",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("ssl_enabled.label")}),(0,o.jsx)(s.A.Check,{type:"switch",label:`${l.ssl_enabled.value?_("ssl_enabled_on.label"):_("ssl_enabled_off.label")}`,checked:l.ssl_enabled.value,onChange:e=>{a({ssl_enabled:{value:e.target.checked,isInvalid:!1,errorMsg:""},ssl_mode:{value:"require",isInvalid:!1,errorMsg:""},ssl_root_cert:{value:"",isInvalid:!1,errorMsg:""},ssl_cert:{value:"",isInvalid:!1,errorMsg:""},ssl_key:{value:"",isInvalid:!1,errorMsg:""}})}})]}),"postgres"===l.db_type.value&&l.ssl_enabled.value&&(0,o.jsxs)(s.A.Group,{controlId:"sslmodeOptionsDropdown",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("ssl_mode.label")}),(0,o.jsx)(s.A.Select,{value:l.ssl_mode.value,onChange:e=>{a({ssl_mode:{value:e.target.value,isInvalid:!1,errorMsg:""}})},children:v.map((e=>(0,o.jsx)("option",{value:e.value,children:e.value},e.value)))})]}),"postgres"===l.db_type.value&&l.ssl_enabled.value&&("verify-ca"===l.ssl_mode.value||"verify-full"===l.ssl_mode.value)&&(0,o.jsxs)(r.A,{className:"mb-3",children:[(0,o.jsxs)(s.A.Group,{as:n.A,controlId:"ssl_root_cert",children:[(0,o.jsx)(s.A.Control,{placeholder:_("ssl_root_cert.placeholder"),"aria-label":"ssl_root_cert","aria-describedby":"basic-addon1",isInvalid:l.ssl_root_cert.isInvalid,onChange:e=>{a({ssl_root_cert:{value:e.target.value,isInvalid:!1,errorMsg:""}})},required:!0}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:`${l.ssl_root_cert.errorMsg}`})]}),(0,o.jsxs)(s.A.Group,{as:n.A,controlId:"ssl_cert",children:[(0,o.jsx)(s.A.Control,{placeholder:_("ssl_cert.placeholder"),"aria-label":"ssl_cert","aria-describedby":"basic-addon1",isInvalid:l.ssl_cert.isInvalid,onChange:e=>{a({ssl_cert:{value:e.target.value,isInvalid:!1,errorMsg:""}})},required:!0}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:`${l.ssl_cert.errorMsg}`})]}),(0,o.jsxs)(s.A.Group,{as:n.A,controlId:"ssl_key",children:[(0,o.jsx)(s.A.Control,{placeholder:_("ssl_key.placeholder"),"aria-label":"ssl_key","aria-describedby":"basic-addon1",isInvalid:l.ssl_key.isInvalid,onChange:e=>{a({ssl_key:{value:e.target.value,isInvalid:!1,errorMsg:""}})},required:!0}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:`${l.ssl_key.errorMsg}`})]})]}),(0,o.jsxs)(s.A.Group,{controlId:"db_host",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("db_host.label")}),(0,o.jsx)(s.A.Control,{required:!0,placeholder:_("db_host.placeholder"),value:l.db_host.value,isInvalid:l.db_host.isInvalid,onChange:e=>{a({db_host:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.db_host.errorMsg})]}),(0,o.jsxs)(s.A.Group,{controlId:"name",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("db_name.label")}),(0,o.jsx)(s.A.Control,{required:!0,placeholder:_("db_name.placeholder"),value:l.db_name.value,isInvalid:l.db_name.isInvalid,onChange:e=>{a({db_name:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.db_name.errorMsg})]})]}):(0,o.jsxs)(s.A.Group,{controlId:"file",className:"mb-3",children:[(0,o.jsx)(s.A.Label,{children:_("db_file.label")}),(0,o.jsx)(s.A.Control,{required:!0,placeholder:_("db_file.placeholder"),value:l.db_file.value,isInvalid:l.db_file.isInvalid,onChange:e=>{a({db_file:{value:e.target.value,isInvalid:!1,errorMsg:""}})}}),(0,o.jsx)(s.A.Control.Feedback,{type:"invalid",children:l.db_file.errorMsg})]}),(0,o.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,o.jsx)(t.default,{step:2}),(0,o.jsx)(i.A,{type:"submit",children:_("next")})]})]}):null}},51177:(e,l,a)=>{a.r(l),a.d(l,{default:()=>c});var s=a(9849),r=a(14592),n=a(18666),i=a(98496),d=a(28446),t=a(73225),o=a(49450);const c=({visible:e,errorMsg:l,nextCallback:a})=>{var c;const{t:v}=(0,i.B)("translation",{keyPrefix:"install"});return e?(0,o.jsxs)("div",{children:[(0,o.jsx)("h5",{children:v("config_yaml.title")}),(null===l||void 0===l||null===(c=l.msg)||void 0===c?void 0:c.length)>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"fmt",children:(0,o.jsx)("p",{children:(0,o.jsx)(d.x,{i18nKey:"install.config_yaml.desc",components:{1:(0,o.jsx)("code",{})}})})}),(0,o.jsx)(s.A,{className:"mb-3",children:(0,o.jsx)(r.A.Control,{type:"text",as:"textarea",rows:8,className:"small",value:null===l||void 0===l?void 0:l.default_config})}),(0,o.jsx)("div",{className:"mb-3",children:v("config_yaml.info")})]}):(0,o.jsx)("div",{className:"mb-3",children:v("config_yaml.label")}),(0,o.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,o.jsx)(t.default,{step:3}),(0,o.jsx)(n.A,{onClick:a,children:v("next")})]})]}):null}},76907:(e,l,a)=>{a.r(l),a.d(l,{Fifth:()=>d.default,FirstStep:()=>s.default,FourthStep:()=>i.default,SecondStep:()=>r.default,ThirdStep:()=>n.default});var s=a(50104),r=a(63326),n=a(51177),i=a(69998),d=a(8293)},39962:(e,l,a)=>{a.r(l),a.d(l,{default:()=>j});var s=a(12162),r=a(5423),n=a(98128),i=a(8810),d=a(84873),t=a(68442),o=a(98496),c=a(28446),v=a(89868),u=a(45558),_=a(93090),m=a(91374),b=a(72055),g=a(3176),h=a(59304),x=a(76907),p=a(49450);const j=()=>{const{t:e}=(0,o.B)("translation",{keyPrefix:"install"}),[l,a]=(0,s.useState)(1),[j,f]=(0,s.useState)(!0),[y,I]=(0,s.useState)({msg:""}),[A,w]=(0,s.useState)({db_table_exist:!1,db_connection_success:!1}),[M,C]=(0,s.useState)({lang:{value:"en_US",isInvalid:!1,errorMsg:""},db_type:{value:"mysql",isInvalid:!1,errorMsg:""},db_username:{value:"root",isInvalid:!1,errorMsg:""},db_password:{value:"root",isInvalid:!1,errorMsg:""},db_host:{value:"db:3306",isInvalid:!1,errorMsg:""},db_name:{value:"answer",isInvalid:!1,errorMsg:""},db_file:{value:"/data/answer.db",isInvalid:!1,errorMsg:""},site_name:{value:"",isInvalid:!1,errorMsg:""},site_url:{value:b.tx,isInvalid:!1,errorMsg:""},contact_email:{value:"",isInvalid:!1,errorMsg:""},login_required:{value:!1,isInvalid:!1,errorMsg:""},external_content_display:{value:"always_display",isInvalid:!1,errorMsg:""},name:{value:"",isInvalid:!1,errorMsg:""},password:{value:"",isInvalid:!1,errorMsg:""},confirm_password:{value:"",isInvalid:!1,errorMsg:""},email:{value:"",isInvalid:!1,errorMsg:""},ssl_enabled:{value:!1,isInvalid:!1,errorMsg:""},ssl_mode:{value:"",isInvalid:!1,errorMsg:""},ssl_key:{value:"",isInvalid:!1,errorMsg:""},ssl_root_cert:{value:"",isInvalid:!1,errorMsg:""},ssl_cert:{value:"",isInvalid:!1,errorMsg:""}}),{update:k,user:N}=(0,h.bb)(),q=e=>{I({msg:""});const l=(e=>{var l;if("db_type"===(null===(l=Object.keys(e))||void 0===l?void 0:l[0])){let l=M;return"mysql"===e.db_type.value?l={...l,db_username:{...l.db_username,value:"root"},db_password:{...l.db_password,value:"root"},db_host:{...l.db_host,value:"db:3306"}}:"postgres"===e.db_type.value&&(l={...l,db_username:{...l.db_username,value:"postgres"},db_password:{...l.db_password,value:"postgres"},db_host:{...l.db_host,value:"db:5432"},ssl_enabled:{...l.ssl_enabled,value:!1},ssl_mode:{...l.ssl_mode,value:""}}),l}return M})(e);C({...l,...e})},S=e=>{(0,_.Mv)(),I(e)},L=async()=>{I({msg:""}),a((e=>e+1))},P=()=>{const e={lang:M.lang.value,db_type:M.db_type.value,db_username:M.db_username.value,db_password:M.db_password.value,db_host:M.db_host.value,db_name:M.db_name.value,db_file:M.db_file.value,ssl_enabled:M.ssl_enabled.value,ssl_mode:M.ssl_mode.value,ssl_key:M.ssl_key.value,ssl_root_cert:M.ssl_root_cert.value,ssl_cert:M.ssl_cert.value};(0,u.O1)(e).then((()=>{L()})).catch((e=>{S(e)}))},F=()=>{1===l&&(_.wc.set(m.rZ,M.lang.value),k({...N,language:M.lang.value}),L()),2===l&&(()=>{const e={lang:M.lang.value,db_type:M.db_type.value,db_username:M.db_username.value,db_password:M.db_password.value,db_host:M.db_host.value,db_name:M.db_name.value,db_file:M.db_file.value,ssl_enabled:M.ssl_enabled.value,ssl_mode:M.ssl_mode.value,ssl_key:M.ssl_key.value,ssl_root_cert:M.ssl_root_cert.value,ssl_cert:M.ssl_cert.value};(0,u.Td)(e).then((()=>{P()})).catch((e=>{S(e)}))})(),3===l&&(y.msg?P():L()),4===l&&(()=>{const e={lang:M.lang.value,site_name:M.site_name.value,site_url:M.site_url.value,contact_email:M.contact_email.value,login_required:M.login_required.value,external_content_display:M.external_content_display.value,name:M.name.value,password:M.password.value,email:M.email.value};(0,u.D7)(e).then((()=>{L()})).catch((e=>{if(e.isError){const l=(0,_.NC)(e,M);C({...l});const a=document.getElementById(e.list[0].error_field);(0,_.qt)(a)}else S(e)}))})(),l>4&&L()};return(0,s.useEffect)((()=>{(0,u.$M)().then((e=>{w({db_table_exist:e.db_table_exist,db_connection_success:e.db_connection_success}),e&&e.config_file_exist&&((0,g.setupInstallLanguage)(_.wc.get(m.rZ)),e.db_connection_success?a(6):a(7))})).finally((()=>{f(!1)}))}),[]),j?(0,p.jsx)("div",{}):(0,p.jsxs)(v.vd,{children:[(0,p.jsx)(v.mg,{children:(0,p.jsx)("title",{children:e("install",{keyPrefix:"page_title"})})}),(0,p.jsx)("div",{className:"bg-f5 py-5 flex-grow-1",children:(0,p.jsx)(r.A,{className:"py-3",children:(0,p.jsx)(n.A,{className:"justify-content-center",children:(0,p.jsxs)(i.A,{lg:6,children:[(0,p.jsx)("h2",{className:"mb-4 text-center",children:e("title")}),(0,p.jsx)(d.A,{children:(0,p.jsxs)(d.A.Body,{children:[(null===y||void 0===y?void 0:y.msg)&&(0,p.jsx)(t.A,{variant:"danger",children:null===y||void 0===y?void 0:y.msg}),(0,p.jsx)(x.FirstStep,{visible:1===l,data:M.lang,changeCallback:q,nextCallback:F}),(0,p.jsx)(x.SecondStep,{visible:2===l,data:M,changeCallback:q,nextCallback:F}),(0,p.jsx)(x.ThirdStep,{visible:3===l,nextCallback:F,errorMsg:y}),(0,p.jsx)(x.FourthStep,{visible:4===l,data:M,changeCallback:q,nextCallback:F}),(0,p.jsx)(x.Fifth,{visible:5===l,siteUrl:M.site_url.value}),6===l&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{children:e("warn_title")}),(0,p.jsxs)("p",{children:[(0,p.jsx)(c.x,{i18nKey:"install.warn_desc",components:{1:(0,p.jsx)("code",{})}})," ",(0,p.jsxs)(c.x,{i18nKey:"install.install_now",children:["You may try",(0,p.jsx)("a",{href:"###",onClick:e=>(e=>{e.preventDefault(),A.db_table_exist?a(8):a(4)})(e),children:"installing now"}),"."]})]})]}),7===l&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{children:e("db_failed")}),(0,p.jsx)("p",{children:(0,p.jsx)(c.x,{i18nKey:"install.db_failed_desc",components:{1:(0,p.jsx)("code",{})}})})]}),8===l&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{children:e("installed")}),(0,p.jsx)("p",{children:e("installed_desc")})]})]})})]})})})})]})}},68442:(e,l,a)=>{a.d(l,{A:()=>j});var s=a(59660),r=a.n(s),n=a(12162),i=a(18525),d=a(1921),t=a(42700),o=a(46024),c=a(49450);const v=(0,o.A)("h4");v.displayName="DivStyledAsH4";const u=n.forwardRef((({className:e,bsPrefix:l,as:a=v,...s},n)=>(l=(0,t.oU)(l,"alert-heading"),(0,c.jsx)(a,{ref:n,className:r()(e,l),...s}))));u.displayName="AlertHeading";const _=u;var m=a(41055);const b=n.forwardRef((({className:e,bsPrefix:l,as:a=m.A,...s},n)=>(l=(0,t.oU)(l,"alert-link"),(0,c.jsx)(a,{ref:n,className:r()(e,l),...s}))));b.displayName="AlertLink";const g=b;var h=a(70200),x=a(4576);const p=n.forwardRef(((e,l)=>{const{bsPrefix:a,show:s=!0,closeLabel:n="Close alert",closeVariant:o,className:v,children:u,variant:_="primary",onClose:m,dismissible:b,transition:g=h.A,...p}=(0,i.Zw)(e,{show:"onClose"}),j=(0,t.oU)(a,"alert"),f=(0,d.A)((e=>{m&&m(!1,e)})),y=!0===g?h.A:g,I=(0,c.jsxs)("div",{role:"alert",...y?void 0:p,ref:l,className:r()(v,j,_&&`${j}-${_}`,b&&`${j}-dismissible`),children:[b&&(0,c.jsx)(x.A,{onClick:f,"aria-label":n,variant:o}),u]});return y?(0,c.jsx)(y,{unmountOnExit:!0,...p,ref:void 0,in:s,children:I}):s?I:null}));p.displayName="Alert";const j=Object.assign(p,{Link:g,Heading:_})},5423:(e,l,a)=>{a.d(l,{A:()=>o});var s=a(59660),r=a.n(s),n=a(12162),i=a(42700),d=a(49450);const t=n.forwardRef((({bsPrefix:e,fluid:l=!1,as:a="div",className:s,...n},t)=>{const o=(0,i.oU)(e,"container"),c="string"===typeof l?`-${l}`:"-fluid";return(0,d.jsx)(a,{ref:t,...n,className:r()(s,l?`${o}${c}`:o)})}));t.displayName="Container";const o=t},98128:(e,l,a)=>{a.d(l,{A:()=>o});var s=a(59660),r=a.n(s),n=a(12162),i=a(42700),d=a(49450);const t=n.forwardRef((({bsPrefix:e,className:l,as:a="div",...s},n)=>{const t=(0,i.oU)(e,"row"),o=(0,i.gy)(),c=(0,i.Jm)(),v=`${t}-cols`,u=[];return o.forEach((e=>{const l=s[e];let a;delete s[e],null!=l&&"object"===typeof l?({cols:a}=l):a=l;const r=e!==c?`-${e}`:"";null!=a&&u.push(`${v}${r}-${a}`)})),(0,d.jsx)(a,{ref:n,...s,className:r()(l,t,...u)})}));t.displayName="Row";const o=t}}]);
//# sourceMappingURL=9962.7f8d7eca.chunk.js.map